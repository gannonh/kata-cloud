---
phase: 10-coordinator-shell-and-sidebar-semantics
plan: 03
type: execute
wave: 3
depends_on: ["02"]
files_modified:
  - src/main.tsx
  - src/features/coordinator-shell/index.ts
  - src/styles.css
  - bin/playwright-electron-runner.mjs
  - docs/e2e-electron-matrix.md
autonomous: true

must_haves:
  truths:
    - "Coordinator workspace renders as a three-column shell with fixed left sidebar, chat-first center pane, and right spec/workflow pane."
    - "Users can inspect active and historical run status as chronological chat content with explicit agent/status context."
    - "Electron UAT coverage enforces coordinator shell semantics so regressions are caught before Phase 11."
  artifacts:
    - path: "src/main.tsx"
      provides: "Coordinator shell composition wired to existing app state and orchestrator actions"
    - path: "src/features/coordinator-shell/index.ts"
      provides: "Single import surface for coordinator-shell components and projection utilities"
    - path: "bin/playwright-electron-runner.mjs"
      provides: "Phase-10 UAT scenario coverage for shell/sidebar/chat semantics"
  key_links:
    - from: "src/main.tsx"
      to: "src/features/coordinator-shell/view-model.ts"
      via: "App state and run history project into sidebar/chat/workflow props"
      pattern: "projectCoordinatorShellViewModel"
    - from: "src/main.tsx"
      to: "src/features/coordinator-shell/message-input-bar.tsx"
      via: "Composer submit path reuses existing onRunOrchestrator behavior"
      pattern: "spacePrompt + onRunOrchestrator"
    - from: "bin/playwright-electron-runner.mjs"
      to: "docs/e2e-electron-matrix.md"
      via: "Scenario ID/tag mapping remains explicit for smoke/uat/full policy"
      pattern: "uat scenario matrix"
---

<objective>
Integrate coordinator-shell primitives into the renderer and lock behavior with UAT coverage.

Purpose: Deliver UX-01/UX-03/UX-04/UX-05 in the real desktop shell flow and codify regression checks.
Output: `src/main.tsx` coordinator-shell wiring, updated shell styling, and Electron UAT scenario/matrix updates.
</objective>

<execution_context>
<!-- Executor agent has built-in instructions for plan execution and summary creation -->
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/pending/10-coordinator-shell-and-sidebar-semantics/10-CONTEXT.md
@.planning/phases/pending/10-coordinator-shell-and-sidebar-semantics/10-RESEARCH.md
@.planning/phases/pending/10-coordinator-shell-and-sidebar-semantics/10-01-PLAN.md
@.planning/phases/pending/10-coordinator-shell-and-sidebar-semantics/10-02-PLAN.md
@src/main.tsx
@src/styles.css
@bin/playwright-electron-runner.mjs
@docs/e2e-electron-matrix.md
</context>

<spec_refs>
- docs/design/specs/02-coordinator-session.md (three-column shell and chat-first center pane)
- docs/design/specs/04-build-session.md (left sidebar semantics and task/status context)
- docs/design/specs/06-wave-execution.md (agent deployment/task status visibility)
</spec_refs>

<tasks>

<task type="auto">
  <name>Task 1: Recompose App shell to coordinator-first three-column semantics</name>
  <files>
    src/main.tsx
    src/features/coordinator-shell/index.ts
    src/styles.css
  </files>
  <action>
Replace current explorer/orchestrator panel composition with coordinator-shell integration for active session work: fixed left sidebar, chat-first center pane, and right spec/workflow pane with collapse affordance. Preserve existing Changes/Browser flows and active-view routing so Phase 10 does not regress git/browser functionality.
  </action>
  <verify>
    `pnpm run desktop:typecheck`
  </verify>
  <done>
    Active coordinator experience matches three-column shell semantics while non-coordinator views remain reachable and functional.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire chat/history/workflow data and composer actions to existing orchestrator runtime paths</name>
  <files>
    src/main.tsx
    src/styles.css
  </files>
  <action>
Map latest/prior run records into chronological chat rendering with role labels, timestamps, status badges, and context-chip output; connect composed prompt submission to existing orchestrator run creation (`onRunOrchestrator`) without altering IPC contracts. Render workflow guidance states (Creating Spec/Implement/Accept changes) based on run/spec readiness and no-spec fallbacks.
  </action>
  <verify>
    `pnpm test -- src/shared/orchestrator-run-view-model.test.ts`
  </verify>
  <done>
    Chat-first center pane and guided workflow panel reflect real run state transitions and satisfy UX-03 + UX-05 behavior.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add UAT scenario coverage and matrix updates for coordinator shell semantics</name>
  <files>
    bin/playwright-electron-runner.mjs
    docs/e2e-electron-matrix.md
  </files>
  <action>
Extend Electron Playwright UAT scenarios to assert Phase 10 shell semantics: three-column coordinator layout, sidebar agent/status context presence, chat-first run rendering, and guided workflow visibility when spec is not finalized. Update the E2E coverage matrix with the new scenario ID/tag mapping and purpose.
  </action>
  <verify>
    `pnpm run e2e:electron:uat`
  </verify>
  <done>
    Phase 10 coordinator-shell behavior is codified in automated UAT coverage and documented in the suite membership matrix.
  </done>
</task>

</tasks>

<verification>
1. `pnpm run e2e:electron:uat`
2. `pnpm run desktop:typecheck`
</verification>

<success_criteria>
- UX-01, UX-03, UX-04, and UX-05 are implemented in the desktop renderer flow with no IPC contract regressions.
- Coordinator shell layout and interaction semantics are integrated in `src/main.tsx` using dedicated Phase 10 primitives.
- UAT automation and matrix documentation explicitly capture Phase 10 coverage.
</success_criteria>

<output>
After completion, create `.planning/phases/pending/10-coordinator-shell-and-sidebar-semantics/10-03-SUMMARY.md`
</output>
