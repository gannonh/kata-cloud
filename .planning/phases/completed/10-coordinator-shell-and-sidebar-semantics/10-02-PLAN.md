---
phase: 10-coordinator-shell-and-sidebar-semantics
plan: 02
type: execute
wave: 2
depends_on: ["01"]
files_modified:
  - src/features/coordinator-shell/left-sidebar.tsx
  - src/features/coordinator-shell/chat-thread.tsx
  - src/features/coordinator-shell/workflow-panel.tsx
  - src/features/coordinator-shell/message-input-bar.tsx
  - src/features/coordinator-shell/components.test.tsx
  - src/styles.css
autonomous: true

must_haves:
  truths:
    - "Users can see an agent/status-aware left sidebar with explicit Agents and Context sections."
    - "Users can read coordinator conversation entries with role attribution, timestamps, and context-chip semantics."
    - "Users can see guided workflow progression (Creating Spec, Implement, Accept changes) when spec content is not finalized."
  artifacts:
    - path: "src/features/coordinator-shell/left-sidebar.tsx"
      provides: "Accessible left sidebar with status-aware sections and context actions"
    - path: "src/features/coordinator-shell/chat-thread.tsx"
      provides: "Chat-first conversation renderer with status and context chip affordances"
    - path: "src/features/coordinator-shell/workflow-panel.tsx"
      provides: "Guided workflow stepper for right panel progression states"
  key_links:
    - from: "src/features/coordinator-shell/left-sidebar.tsx"
      to: "src/features/coordinator-shell/view-model.ts"
      via: "Sidebar sections consume projected agent/task status records"
      pattern: "sidebarAgents"
    - from: "src/features/coordinator-shell/chat-thread.tsx"
      to: "src/features/coordinator-shell/message-input-bar.tsx"
      via: "Conversation history and input affordances align to chat-first interaction semantics"
      pattern: "message thread + composer"
    - from: "src/features/coordinator-shell/workflow-panel.tsx"
      to: "src/features/spec-panel/spec-note-panel.tsx"
      via: "Workflow status resolves against spec draft/spec readiness state"
      pattern: "creating-spec/implement/accept"
---

<objective>
Build coordinator-shell UI primitives for sidebar, chat, and workflow guidance.

Purpose: Implement spec-aligned presentational components before app-level integration.
Output: Reusable coordinator-shell components with accessibility semantics and targeted UI tests.
</objective>

<execution_context>
<!-- Executor agent has built-in instructions for plan execution and summary creation -->
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/pending/10-coordinator-shell-and-sidebar-semantics/10-CONTEXT.md
@.planning/phases/pending/10-coordinator-shell-and-sidebar-semantics/10-RESEARCH.md
@src/styles.css
@src/main.tsx
@src/features/spec-panel/spec-note-panel.tsx
</context>

<spec_refs>
- docs/design/specs/02-coordinator-session.md (panel composition, chat, and sidebar primitives)
- docs/design/specs/04-build-session.md (session/agent/task sidebar patterns)
- docs/design/specs/06-wave-execution.md (status indicator semantics for agent/task rows)
</spec_refs>

<tasks>

<task type="auto">
  <name>Task 1: Implement left-sidebar primitives with accessible section semantics</name>
  <files>
    src/features/coordinator-shell/left-sidebar.tsx
    src/styles.css
  </files>
  <action>
Create a left sidebar component that renders Agents and Context sections with disclosure-style expand/collapse controls, status indicators, and placeholder actions (`+ Create new agent`, `+ Add context`). Use APG-friendly button semantics for disclosure and keep data inputs driven by projected view-model contracts.
  </action>
  <verify>
    `pnpm run desktop:typecheck`
  </verify>
  <done>
    Sidebar primitives render spec-aligned structure with accessible section toggles and deterministic status affordances.
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement chat-thread and message-input primitives for chat-first center pane</name>
  <files>
    src/features/coordinator-shell/chat-thread.tsx
    src/features/coordinator-shell/message-input-bar.tsx
    src/styles.css
  </files>
  <action>
Build center-pane primitives for chronological message rendering, role labels, timestamps, status badges, pasted-context indicators, and bottom composer semantics ("Ask anything or type @ for context"). Keep send action and model label APIs explicit so app integration can reuse existing orchestrator handlers.
  </action>
  <verify>
    `pnpm run desktop:typecheck`
  </verify>
  <done>
    Chat primitives support UX-03 semantics and expose typed props for prompt submission, status display, and message expansion behavior.
  </done>
</task>

<task type="auto">
  <name>Task 3: Implement workflow-panel primitive and component-level behavior coverage</name>
  <files>
    src/features/coordinator-shell/workflow-panel.tsx
    src/features/coordinator-shell/components.test.tsx
    src/styles.css
  </files>
  <action>
Create a workflow stepper primitive for Creating Spec, Implement, and Accept changes states with active/pending/complete indicators and explanatory copy. Add focused component tests to cover disclosure behavior, role/timestamp rendering, and workflow state projection hooks.
  </action>
  <verify>
    `pnpm test -- src/features/coordinator-shell/components.test.tsx`
  </verify>
  <done>
    Workflow guidance and coordinator-shell primitives are test-backed and ready for app-level wiring.
  </done>
</task>

</tasks>

<verification>
1. `pnpm test -- src/features/coordinator-shell/components.test.tsx`
2. `pnpm run desktop:typecheck`
</verification>

<success_criteria>
- Sidebar/chat/workflow primitives match Phase 10 spec semantics and accessibility expectations.
- Component contracts are typed for deterministic integration in `src/main.tsx`.
- UI behavior coverage exists for critical sidebar/chat/workflow rendering states.
</success_criteria>

<output>
After completion, create `.planning/phases/pending/10-coordinator-shell-and-sidebar-semantics/10-02-SUMMARY.md`
</output>
