---
id: 22770f24-a79b-4d14-9add-14ffd1447b2f
title: Add in-app browser preview for local development
parent: spec
created: "2026-02-16T13:58:41.818Z"
task:
  status: waiting
  peerOrder: 900
  startedAt: "2026-02-17T03:47:32.869Z"
  assignedAgentIds: [agent-efb006f9-203a-47eb-8546-3e226b83cb69]
---

# Add in-app browser preview for local development

Embed browser panel to preview localhost and relevant docs without leaving app.

## Scope
Implement in-app browser tab for local preview URLs with basic navigation controls. Excludes cross-device emulation and advanced devtools.

## Inputs
`docs/kata-cloud-ovweview.md` section "In-app browser"
`[Spec](intent://local/note/spec)`

## Definition of Done
- User can open localhost URL inside app browser panel.
- Browser tab supports refresh/back/forward navigation.
- Browser panel coexists with core workspace views without breaking layout.

## Verification
- `pnpm run test -- browser`
- Manual: open `http://localhost:<port>` and validate navigation actions

## Conflict Resolution (2026-02-17)

Preflight conflict confirmed on shared files `src/shared/state.ts` and `src/shared/state.test.ts` due parallel context-adapter edits.

Coordinator decision:
1. No combined browser+context commit.
2. Browser task is paused (`waiting`) unless it can complete strictly in browser-only files.
3. Resume/finish browser shared-state integration after context task lands and branch is rebased from updated `main`.

## Implementation Evidence (2026-02-17)

Branch: `feature/in-app-browser-preview`
Commit: `f759c16ed771aee16c9bea3512edd1b77be0da16`
Push verification: `git ls-remote --heads origin feature/in-app-browser-preview` -> `f759c16ed771aee16c9bea3512edd1b77be0da16 refs/heads/feature/in-app-browser-preview`

Files changed:
- `src/main.tsx`
- `src/styles.css`
- `src/shared/state.ts`
- `src/shared/state.test.ts`
- `src/browser/local-dev-browser.ts`
- `src/browser/local-dev-browser.test.ts`

What changed:
- Added `Browser` view to navigation/state.
- Added in-app browser panel rendering localhost URLs inside an iframe.
- Added controls for `Back`, `Forward`, `Refresh`, and `Go`.
- Added URL normalization/localhost guard + browser history helper logic.
- Added browser helper tests and state-view validity test.

Verification run:
- `pnpm run test -- browser` ✅ pass
- `pnpm run desktop:typecheck` ✅ pass

Manual localhost preview/navigation evidence:
- Automated agent environment is headless for Electron UI interaction, so direct manual clickthrough evidence is pending verifier desktop run.
- Browser panel runtime path is wired in `src/main.tsx` with live iframe source updates plus back/forward/refresh/go actions and localhost URL validation.

## Scope Blocker Update (2026-02-17)

Coordinator constraint received: `src/shared/state.ts` and `src/shared/state.test.ts` are context-task-owned for this wave and must not be included in browser-only commit scope.

Evidence:
- Existing browser commit `f759c16ed771aee16c9bea3512edd1b77be0da16` includes:
  - `src/browser/local-dev-browser.test.ts`
  - `src/browser/local-dev-browser.ts`
  - `src/main.tsx`
  - `src/shared/state.test.ts`
  - `src/shared/state.ts`
  - `src/styles.css`
- Browser implementation currently depends on `NavigationView` supporting `"browser"` in `src/shared/state.ts` and corresponding state normalization test in `src/shared/state.test.ts`.

Blocking conclusion:
- Under current coordinator restriction, browser task cannot be completed as a clean isolated commit without touching those shared-state files.
- Task is paused awaiting context-task merge/landing and coordinator rebase/cherry-pick instruction.