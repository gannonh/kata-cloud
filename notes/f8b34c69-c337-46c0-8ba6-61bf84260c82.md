---
id: f8b34c69-c337-46c0-8ba6-61bf84260c82
title: Add GitHub CI workflow for pull requests and merges
parent: spec
created: "2026-02-16T18:29:23.769Z"
task:
  status: complete
  peerOrder: 300
  startedAt: "2026-02-16T19:31:39.731Z"
  assignedAgentIds: [agent-c9c46200-225a-4eef-98ef-232064c2178f]
  completedAt: "2026-02-16T19:41:40.316Z"
---

# Add GitHub CI workflow for pull requests and merges

Create CI automation that runs quality gates on pull requests and merges.

## Scope
In scope: GitHub Actions workflow(s) for `pull_request` and `push` events, including install + quality gate execution.
Out of scope: deployment/release pipelines.

## Inputs
[Spec](intent://local/note/spec)

## Definition of Done
- CI workflow runs on pull requests and pushes to the primary merge branch.
- Workflow executes lint, typecheck, tests, and coverage gate commands.
- Workflow fails when any quality gate fails.

## Verification
- Validate workflow YAML syntax and triggers.
- Confirm command list in workflow matches local quality-gate commands.

## Summary (Turn 1)

Preparing Wave B CI workflow implementation. Confirmed no existing GitHub Actions workflow files and required scripts are present in `package.json` (`lint`, `desktop:typecheck`, `test`). Scope remains limited to CI workflow setup for `pull_request` and `push` to `main`.

## Acceptance Criteria

- [ ] Workflow triggers on `pull_request` and `push` to `main`.
- [ ] Workflow runs deterministic install and the required quality gates: `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.
- [ ] Workflow fails on any gate failure via default step failure behavior.
- [ ] Dependabot config remains unchanged.

## References

- Workflow file: `.github/workflows/ci-quality-gates.yml`
- Existing scripts validated from `package.json`: `lint`, `desktop:typecheck`, `test`

## Changes

- Added `.github/workflows/ci-quality-gates.yml`.
- Configured triggers for `pull_request` and `push` on `main`.
- Added CI steps: checkout, pnpm setup, Node setup with pnpm cache, deterministic install (`pnpm install --frozen-lockfile`), lint, typecheck, and coverage test command (`pnpm run test --coverage`).
- Left `.github/dependabot.yml` unchanged (explicitly out of scope).

## Verification

Commands run:
- `pnpm run lint` -> pass (1 existing warning in `src/main.tsx` from `react-refresh/only-export-components`).
- `pnpm run desktop:typecheck` -> fail due to existing TypeScript errors unrelated to this workflow change (e.g., `Cannot find namespace JSX` and `GitCli` test typing mismatches).
- `pnpm run test --coverage` -> executes with coverage mode enabled; fails global thresholds (lines/statements/functions below configured 80% minimum).

Rationale/evidence:
- Workflow command path matches the approved gate path exactly, including `pnpm run test --coverage` (not `pnpm run test -- --coverage`).
- GitHub Actions default step behavior enforces failure on any non-zero gate command.