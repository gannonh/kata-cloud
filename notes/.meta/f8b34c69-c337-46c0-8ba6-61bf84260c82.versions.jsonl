{"type":"snapshot","v":1,"date":"2026-02-16T19:37:58.179Z","author":{"id":"user","name":"User","type":"user"},"content":"# Add GitHub CI workflow for pull requests and merges\n\nCreate CI automation that runs quality gates on pull requests and merges.\n\n## Scope\nIn scope: GitHub Actions workflow(s) for `pull_request` and `push` events, including install + quality gate execution.\nOut of scope: deployment/release pipelines.\n\n## Inputs\n[Spec](intent://local/note/spec)\n\n## Definition of Done\n- CI workflow runs on pull requests and pushes to the primary merge branch.\n- Workflow executes lint, typecheck, tests, and coverage gate commands.\n- Workflow fails when any quality gate fails.\n\n## Verification\n- Validate workflow YAML syntax and triggers.\n- Confirm command list in workflow matches local quality-gate commands.\n\n## Summary (Turn 1)\n\nPreparing Wave B CI workflow implementation. Confirmed no existing GitHub Actions workflow files and required scripts are present in `package.json` (`lint`, `desktop:typecheck`, `test`). Scope remains limited to CI workflow setup for `pull_request` and `push` to `main`.\n\n## Acceptance Criteria\n\n- [ ] Workflow triggers on `pull_request` and `push` to `main`.\n- [ ] Workflow runs deterministic install and the required quality gates: `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n- [ ] Workflow fails on any gate failure via default step failure behavior.\n- [ ] Dependabot config remains unchanged.\n\n## References\n\n- Workflow file: `.github/workflows/ci-quality-gates.yml`\n- Existing scripts validated from `package.json`: `lint`, `desktop:typecheck`, `test`\n\n## Changes\n\n- Added `.github/workflows/ci-quality-gates.yml`.\n- Configured triggers for `pull_request` and `push` on `main`.\n- Added CI steps: checkout, pnpm setup, Node setup with pnpm cache, deterministic install (`pnpm install --frozen-lockfile`), lint, typecheck, and coverage test command (`pnpm run test --coverage`).\n- Left `.github/dependabot.yml` unchanged (explicitly out of scope).\n\n## Verification\n\nCommands run:\n- `pnpm run lint` -> pass (1 existing warning in `src/main.tsx` from `react-refresh/only-export-components`).\n- `pnpm run desktop:typecheck` -> fail due to existing TypeScript errors unrelated to this workflow change (e.g., `Cannot find namespace JSX` and `GitCli` test typing mismatches).\n- `pnpm run test --coverage` -> executes with coverage mode enabled; fails global thresholds (lines/statements/functions below configured 80% minimum).\n\nRationale/evidence:\n- Workflow command path matches the approved gate path exactly, including `pnpm run test --coverage` (not `pnpm run test -- --coverage`).\n- GitHub Actions default step behavior enforces failure on any non-zero gate command.","title":"Add GitHub CI workflow for pull requests and merges"}
