{"type":"snapshot","v":1,"date":"2026-02-16T14:03:55.074Z","author":{"id":"user","name":"User","type":"user"},"content":"## Goal\nDeliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and prepare a PR draft without leaving the app.\n\n## Tasks\n- [ ] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n\n- [ ] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n\n- [ ] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n\n- [ ] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n\n- [ ] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n\n\n- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n\n- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n\n- [ ] [Add PR draft generation in Changes workflow](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n\n- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n\n- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n\n## Acceptance Criteria\n1. A user can install and run the app, create a space, and reopen it later with full state restored.\n2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n5. The user can review diffs, selectively stage files, and generate a PR draft from staged changes.\n6. The app provides an in-app browser preview for localhost development targets.\n7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n\n## Non-goals\n- Production authentication, billing, licensing, or multi-tenant cloud backend.\n- Full marketplace for custom specialists.\n- One-click remote PR creation via provider APIs.\n- Large-scale distributed indexing or enterprise ingestion pipelines.\n\n## Assumptions\n- Initial release target is macOS desktop first, with Linux/Windows deferred (confirm?).\n- Tech stack is TypeScript with a desktop shell + web UI architecture (confirm exact framework?).\n- First milestone is local-first workflow with no account sign-in requirement (confirm?).\n- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies (confirm?).\n\n## Verification Plan\n1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, changes, browser, and context adapter.\n2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> draft PR.\n3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n\n## Rollback Plan\n1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, changes-tab, browser, context-adapter).\n2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.","title":"Spec"}
{"type":"diff","v":2,"date":"2026-02-16T14:12:18.622Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -2 +2 @@\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and prepare a PR draft without leaving the app.\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n@@ -20 +20 @@\n-- [ ] [Add PR draft generation in Changes workflow](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n@@ -26 +26 @@\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n@@ -31 +33 @@\n-5. The user can review diffs, selectively stage files, and generate a PR draft from staged changes.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n@@ -34 +36 @@\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n@@ -38 +41 @@\n-- One-click remote PR creation via provider APIs.\n+- Full CI/CD orchestration or deployment management from within the app.\n@@ -42 +45 @@\n-- Initial release target is macOS desktop first, with Linux/Windows deferred (confirm?).\n-- Tech stack is TypeScript with a desktop shell + web UI architecture (confirm exact framework?).\n-- First milestone is local-first workflow with no account sign-in requirement (confirm?).\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies (confirm?).\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, changes, browser, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> draft PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, changes-tab, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript for delivery speed and ecosystem maturity, with app architecture keeping a clean boundary for future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"diff","v":3,"date":"2026-02-16T14:24:24.640Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -46 +46 @@\n-- V1 desktop shell will use Electron + TypeScript for delivery speed and ecosystem maturity, with app architecture keeping a clean boundary for future Tauri migration.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration."}
{"type":"diff","v":4,"date":"2026-02-16T14:33:27.511Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -5 +5 @@\n-- [ ] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+- [/] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n@@ -7 +7 @@\n-- [ ] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+- [/] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n@@ -9 +9 @@\n-- [ ] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+- [/] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n@@ -11 +11 @@\n-- [ ] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n@@ -13 +13 @@\n-- [ ] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)"}
{"type":"diff","v":5,"date":"2026-02-16T14:42:42.354Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -5 +5 @@\n-- [/] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n@@ -49 +49 @@\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor."}
{"type":"diff","v":6,"date":"2026-02-16T14:51:01.349Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -7 +7 @@\n-- [/] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n@@ -9 +9 @@\n-- [/] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)"}
{"type":"diff","v":7,"date":"2026-02-16T15:13:51.545Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -4 +4 @@\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n@@ -7 +5 @@\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Blocking gap: task-block conversion is not yet integrated end-to-end in spec autosave/save flow.\n+- Environment blocker: offline dependency resolution prevented full standardized verification (`pnpm install` and Vitest-based commands).\n+\n+\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [/] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"diff","v":8,"date":"2026-02-16T15:33:39.678Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -24 +24 @@\n-- Decision: **NO-GO** for Wave 2.\n-- Blocking gap: task-block conversion is not yet integrated end-to-end in spec autosave/save flow.\n-- Environment blocker: offline dependency resolution prevented full standardized verification (`pnpm install` and Vitest-based commands).\n+- Decision: **Pending re-verification** for Wave 2.\n+- Remediation implementation tasks are complete: task-block save/autosave conversion + duplicate-title parser cardinality fix.\n+- Dependency installation now succeeds in this workspace; verification rerun is required to confirm GO/NO-GO."}
{"type":"diff","v":9,"date":"2026-02-16T15:39:16.807Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -24 +24 @@\n-- Decision: **Pending re-verification** for Wave 2.\n-- Remediation implementation tasks are complete: task-block save/autosave conversion + duplicate-title parser cardinality fix.\n-- Dependency installation now succeeds in this workspace; verification rerun is required to confirm GO/NO-GO.\n-\n-\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [/] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+- Decision: **NO-GO** for Wave 2.\n+- Verification rerun completed in a network-enabled environment.\n+- Blocking failures:\n+  - `pnpm run dev` fails with `TS2783` at `src/git/space-git-service.ts:115` (`spaceId` duplicated in object literal).\n+  - `pnpm run test -- <scope>` fails due Vitest loading `*.node.test.ts` files (`src/git/space-git-service.node.test.ts`, `src/git/types.node.test.ts`) as empty suites.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [ ] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [ ] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [ ] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"diff","v":10,"date":"2026-02-16T16:04:07.392Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -29 +29 @@\n+- Wave 1.1 fix execution is in progress (two implementation tasks delegated in parallel)."}
{"type":"snapshot","v":11,"date":"2026-02-16T16:13:24.888Z","author":{"id":"user","name":"User","type":"user"},"content":"## Goal\nDeliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n\n\n## Tasks (Wave 1 Remediation)\n1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n\n## Acceptance Criteria (Wave 1 Remediation)\n1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n\n## Verification Plan (Wave 1 Remediation)\n1. `pnpm run test -- notes`\n2. `pnpm run test -- task-parser`\n3. `pnpm install`\n4. `pnpm run test -- space`\n5. `pnpm run test -- git`\n6. `pnpm run dev` plus manual restart persistence check.\n\n## Wave 1 Gate Status (2026-02-16)\n- Decision: **NO-GO** for Wave 2.\n- Verification rerun completed in a network-enabled environment.\n- Blocking failures:\n  - `pnpm run dev` fails with `TS2783` at `src/git/space-git-service.ts:115` (`spaceId` duplicated in object literal).\n  - `pnpm run test -- <scope>` fails due Vitest loading `*.node.test.ts` files (`src/git/space-git-service.node.test.ts`, `src/git/types.node.test.ts`) as empty suites.\n- Wave 1.1 implementation tasks are complete; final verification rerun is now in progress.\n\n\n\n## Tasks (Wave 1.1 Fixes)\n\n- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n\n- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n\n- [/] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n## Tasks\n- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n\n- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n\n- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n\n- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n\n- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n\n\n- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n\n- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n\n- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n\n- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n\n- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n\n\n- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n## Acceptance Criteria\n1. A user can install and run the app, create a space, and reopen it later with full state restored.\n2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n6. The app provides an in-app browser preview for localhost development targets.\n7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n\n## Non-goals\n- Production authentication, billing, licensing, or multi-tenant cloud backend.\n- Full marketplace for custom specialists.\n- Full CI/CD orchestration or deployment management from within the app.\n- Large-scale distributed indexing or enterprise ingestion pipelines.\n\n## Assumptions\n- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n\n## Verification Plan\n1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n\n## Rollback Plan\n1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.","title":"Spec"}
{"type":"diff","v":12,"date":"2026-02-16T16:24:04.563Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -25 +25 @@\n-- Verification rerun completed in a network-enabled environment.\n-- Blocking failures:\n-  - `pnpm run dev` fails with `TS2783` at `src/git/space-git-service.ts:115` (`spaceId` duplicated in object literal).\n-  - `pnpm run test -- <scope>` fails due Vitest loading `*.node.test.ts` files (`src/git/space-git-service.node.test.ts`, `src/git/types.node.test.ts`) as empty suites.\n-- Wave 1.1 implementation tasks are complete; final verification rerun is now in progress.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [/] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Remaining blocker: `pnpm run dev` fails before app boot with `Electron failed to install correctly`.\n+- Install evidence indicates ignored build scripts for `electron` and `esbuild`, and restart persistence smoke remains unverified because the app did not boot.\n+- Wave 1.2 runtime remediation planning is pending approval.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [/] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [ ] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"diff","v":13,"date":"2026-02-16T16:45:07.438Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -29 +29 @@\n-- Wave 1.2 runtime remediation planning is pending approval.\n+- Wave 1.2 runtime remediation implementation is currently in progress (`fe99cd34-6c78-45e5-b3b2-a60cebae3faf`).\n+- Wave 1.3 git hygiene cleanup is planned pending approval (`a0439035-0bda-47ac-a0dd-10c85ec82c04`, `99ae8f09-0c3b-49d6-b57f-d4007df74c33`).\n@@ -46 +47 @@\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n@@ -49 +48 @@\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+## Tasks (Wave 1.3 Git Hygiene)\n@@ -51 +50 @@\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+- [/] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n@@ -53 +52 @@\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+- [ ] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n@@ -55 +56 @@\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n@@ -57 +58 @@\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n@@ -58 +60 @@\n-- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n@@ -60 +62 @@\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n@@ -62 +64 @@\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n@@ -64 +65 @@\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n@@ -66 +67 @@\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n@@ -68 +69 @@\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n@@ -69 +71 @@\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n@@ -80 +73 @@\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n@@ -86 +75 @@\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n@@ -93 +76 @@\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"diff","v":14,"date":"2026-02-16T17:37:29.623Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -30 +30 @@\n-- Wave 1.3 git hygiene cleanup is planned pending approval (`a0439035-0bda-47ac-a0dd-10c85ec82c04`, `99ae8f09-0c3b-49d6-b57f-d4007df74c33`).\n+- Wave 1.3 git hygiene cleanup is in progress (`a0439035-0bda-47ac-a0dd-10c85ec82c04` active; single-owner reassigned to recovery agent for final two-file untrack; `99ae8f09-0c3b-49d6-b57f-d4007df74c33` queued).\n+- Wave 1.3 scope narrowed to the two remaining tracked+modified cache files under `.pnpm-store/v10/index/{6d,dc}/...`; Task 1 remains open until those are untracked."}
{"type":"diff","v":15,"date":"2026-02-16T18:11:56.867Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -27 +27 @@\n-- Remaining blocker: `pnpm run dev` fails before app boot with `Electron failed to install correctly`.\n-- Install evidence indicates ignored build scripts for `electron` and `esbuild`, and restart persistence smoke remains unverified because the app did not boot.\n-- Wave 1.2 runtime remediation implementation is currently in progress (`fe99cd34-6c78-45e5-b3b2-a60cebae3faf`).\n-- Wave 1.3 git hygiene cleanup is in progress (`a0439035-0bda-47ac-a0dd-10c85ec82c04` active; single-owner reassigned to recovery agent for final two-file untrack; `99ae8f09-0c3b-49d6-b57f-d4007df74c33` queued).\n-- Wave 1.3 scope narrowed to the two remaining tracked+modified cache files under `.pnpm-store/v10/index/{6d,dc}/...`; Task 1 remains open until those are untracked.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [/] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [ ] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [/] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [ ] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: dev startup sequencing is brittle when `5173` is occupied while the script still waits on fixed `tcp:5173` (`package.json`).\n+- Wave 1.4 runtime-launch stabilization plan is prepared and pending approval (`d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`, `5287cd3d-7fba-460b-9011-d8a3b3a941d7`).\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [ ] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [ ] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"diff","v":16,"date":"2026-02-16T18:22:09.322Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -34 +34 @@\n-- Wave 1.4 runtime-launch stabilization plan is prepared and pending approval (`d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`, `5287cd3d-7fba-460b-9011-d8a3b3a941d7`).\n+- Wave 1.4 runtime-launch stabilization execution is in progress (`d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` active with single-owner implementor enforcement; `5287cd3d-7fba-460b-9011-d8a3b3a941d7` queued).\n@@ -63 +63 @@\n-- [ ] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+- [/] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)"}
{"type":"diff","v":17,"date":"2026-02-16T18:36:32.163Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -1 +1 @@\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n@@ -4 +4 @@\n+## Tasks (Wave 1.5 Quality Gates)\n+- [ ] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n@@ -5 +7 @@\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+- [ ] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n@@ -10 +9 @@\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+- [ ] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n@@ -15 +11 @@\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n+- [ ] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n@@ -23 +13 @@\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: dev startup sequencing is brittle when `5173` is occupied while the script still waits on fixed `tcp:5173` (`package.json`).\n-- Wave 1.4 runtime-launch stabilization execution is in progress (`d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` active with single-owner implementor enforcement; `5287cd3d-7fba-460b-9011-d8a3b3a941d7` queued).\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- [ ] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n@@ -39 +15 @@\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [/] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [ ] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline will be `80%` for statements/functions/lines and `70%` for branches (confirm?).\n+2. CI should run on `pull_request` and `push` to `main` unless your merge branch differs (confirm?).\n+3. Dependabot cadence should be weekly for both npm and GitHub Actions (confirm?).\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates plan is defined at top of spec and pending approval.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"diff","v":18,"date":"2026-02-16T18:43:35.349Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -5 +5 @@\n-- [ ] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+- [/] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n@@ -7 +7 @@\n-- [ ] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+- [/] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n@@ -11 +11 @@\n-- [ ] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+- [/] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n@@ -28 +28 @@\n-1. Coverage policy baseline will be `80%` for statements/functions/lines and `70%` for branches (confirm?).\n-2. CI should run on `pull_request` and `push` to `main` unless your merge branch differs (confirm?).\n-3. Dependabot cadence should be weekly for both npm and GitHub Actions (confirm?).\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n@@ -81 +81 @@\n-- Wave 1.5 quality-gates plan is defined at top of spec and pending approval.\n+- Wave 1.5 quality-gates plan is approved; Wave A execution is in progress."}
{"type":"diff","v":19,"date":"2026-02-16T18:55:31.638Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -5 +5 @@\n-- [/] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n@@ -82 +82 @@\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution."}
{"type":"diff","v":20,"date":"2026-02-16T19:01:55.873Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -11 +11 @@\n-- [/] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n@@ -81 +81 @@\n-- Wave 1.5 quality-gates plan is approved; Wave A execution is in progress.\n+- Wave 1.5 quality-gates plan is approved; Wave A is partially complete (lint + Dependabot done, coverage in progress)."}
{"type":"snapshot","v":21,"date":"2026-02-16T19:36:49.365Z","author":{"id":"user","name":"User","type":"user"},"content":"## Goal (Wave 1.5 Quality Gates)\nEstablish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n\n## Tasks (Wave 1.5 Quality Gates)\n- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n\n- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n\n- [/] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n\n- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n\n- [ ] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n\n## Acceptance Criteria (Wave 1.5 Quality Gates)\n1. Lint checks are standardized and runnable locally and in CI.\n2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n4. Dependabot is configured for npm and GitHub Actions update automation.\n5. Final verification provides an explicit GO/NO-GO with blocker severity.\n\n## Non-goals (Wave 1.5 Quality Gates)\n1. Refactoring product features unrelated to quality-gate enablement.\n2. Introducing deployment/release automation beyond CI validation.\n3. Replacing package manager or test framework.\n\n## Assumptions (Wave 1.5 Quality Gates)\n1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n2. CI runs on `pull_request` and `push` to `main`.\n3. Dependabot cadence is weekly for both npm and GitHub Actions.\n\n## Verification Plan (Wave 1.5 Quality Gates)\n1. Run all local quality-gate commands after implementation.\n2. Validate CI workflow trigger paths for PR and merge events.\n3. Confirm Dependabot config parses and targets both ecosystems.\n\n## Rollback Plan (Wave 1.5 Quality Gates)\n1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n\n\n## Goal\nDeliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n\n\n## Tasks (Wave 1 Remediation)\n1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n\n## Acceptance Criteria (Wave 1 Remediation)\n1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n\n## Verification Plan (Wave 1 Remediation)\n1. `pnpm run test -- notes`\n2. `pnpm run test -- task-parser`\n3. `pnpm install`\n4. `pnpm run test -- space`\n5. `pnpm run test -- git`\n6. `pnpm run dev` plus manual restart persistence check.\n\n## Wave 1 Gate Status (2026-02-16)\n- Decision: **NO-GO** for Wave 2.\n- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n- `Electron failed to install correctly` is resolved as the active failure signature.\n- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n- Wave 1.5 quality-gates plan is approved; Wave A is complete (lint, coverage, Dependabot) and Wave B CI workflow implementation is in progress.\n- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n\n\n\n## Tasks (Wave 1.1 Fixes)\n\n- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n\n- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n\n- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n\n## Tasks (Wave 1.2 Runtime Remediation)\n\n- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n\n- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n\n## Tasks (Wave 1.3 Git Hygiene)\n\n- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n\n- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n\n## Tasks (Wave 1.4 Runtime Launch Stabilization)\n\n- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n\n- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n\n## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n2. Runtime launch path is deterministic and documented with reproducible evidence.\n3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n\n## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n## Tasks\n- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n\n- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n\n- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n\n- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n\n- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n\n\n- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n\n- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n\n- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n\n- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n\n- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n\n\n- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n## Acceptance Criteria\n1. A user can install and run the app, create a space, and reopen it later with full state restored.\n2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n6. The app provides an in-app browser preview for localhost development targets.\n7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n\n## Non-goals\n- Production authentication, billing, licensing, or multi-tenant cloud backend.\n- Full marketplace for custom specialists.\n- Full CI/CD orchestration or deployment management from within the app.\n- Large-scale distributed indexing or enterprise ingestion pipelines.\n\n## Assumptions\n- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n\n## Verification Plan\n1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n\n## Rollback Plan\n1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.","title":"Spec"}
{"type":"diff","v":22,"date":"2026-02-16T19:46:46.028Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -9 +9 @@\n-- [/] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n@@ -13 +13 @@\n-- [ ] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n@@ -81 +81 @@\n-- Wave 1.5 quality-gates plan is approved; Wave A is complete (lint, coverage, Dependabot) and Wave B CI workflow implementation is in progress.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects)."}
{"type":"diff","v":23,"date":"2026-02-16T19:58:28.267Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -1 +1 @@\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n@@ -4 +4 @@\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+## Tasks (Wave 1.6 Blocker Burn-down)\n@@ -7 +6 @@\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+- [/] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n@@ -9 +8 @@\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+- [/] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n@@ -11 +10 @@\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+- [ ] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n@@ -13 +12 @@\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+- [ ] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n@@ -15 +14 @@\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+- [ ] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n@@ -22 +16 @@\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified (confirm?).\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests (confirm?).\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"diff","v":24,"date":"2026-02-16T20:09:40.923Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -6 +6 @@\n-- [/] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n@@ -8 +8 @@\n-- [/] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n@@ -10 +10 @@\n-- [ ] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+- [/] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n@@ -29 +29 @@\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified (confirm?).\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests (confirm?).\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests."}
{"type":"diff","v":25,"date":"2026-02-16T20:33:19.642Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -10 +10 @@\n-- [/] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n@@ -12 +12 @@\n-- [ ] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+- [/] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)"}
{"type":"diff","v":26,"date":"2026-02-16T21:08:42.973Z","author":{"id":"user","name":"User","type":"user"},"diff":""}
{"type":"diff","v":27,"date":"2026-02-16T21:42:24.677Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -12 +12 @@\n-- [/] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n@@ -14 +14 @@\n-- [ ] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+- [/] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)"}
{"type":"diff","v":28,"date":"2026-02-16T21:50:47.035Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -12 +12 @@\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+- [/] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)"}
{"type":"diff","v":29,"date":"2026-02-16T22:02:37.900Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -12 +12 @@\n-- [/] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n@@ -14 +14 @@\n-- [/] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n@@ -46 +46 @@\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n@@ -49 +47 @@\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+## Wave 1.6 Final Status (2026-02-16)\n@@ -52 +49 @@\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"diff","v":30,"date":"2026-02-16T23:28:02.553Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -1 +1 @@\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n@@ -4 +4 @@\n-## Tasks (Wave 1.6 Blocker Burn-down)\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [ ] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n@@ -6 +7 @@\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+- [ ] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n@@ -8 +9 @@\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+- [ ] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n@@ -10 +11 @@\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"snapshot","v":31,"date":"2026-02-16T23:39:00.809Z","author":{"id":"user","name":"User","type":"user"},"content":"## Goal (Wave 2.1 Orchestrator Planning Loop)\nDeliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n\n## Tasks (Wave 2.1 Orchestrator Planning Loop)\n- [/] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n\n- [ ] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n\n- [ ] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n\n## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n\n## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n1. Implementing real provider authentication/runtime.\n2. Building Changes-tab diff/PR workflows.\n3. Building in-app browser preview.\n4. Integrating context adapter providers beyond current local flow.\n\n## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n\n## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n2. Run `pnpm run desktop:typecheck` after each wave.\n3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n\n## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n\n---\n\n\n## Goal (Wave 1.6 Blocker Burn-down)\nMake the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n\n## Tasks (Wave 1.6 Blocker Burn-down)\n\n- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n\n- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n\n- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n\n- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n\n- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n\n## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n\n## Non-goals (Wave 1.6 Blocker Burn-down)\n1. Changing quality-gate thresholds.\n2. Reworking CI/Dependabot architecture beyond required alignment updates.\n3. Shipping unrelated product features.\n\n## Assumptions (Wave 1.6 Blocker Burn-down)\n1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n\n## Verification Plan (Wave 1.6 Blocker Burn-down)\n1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n\n## Rollback Plan (Wave 1.6 Blocker Burn-down)\n1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n\n---\n\n\n\n\n## Wave 1.6 Final Status (2026-02-16)\n\n- Decision: **GO**.\n- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n## Goal (Wave 1.5 Quality Gates)\nEstablish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n\n## Tasks (Wave 1.5 Quality Gates)\n- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n\n- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n\n- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n\n- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n\n- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n\n## Acceptance Criteria (Wave 1.5 Quality Gates)\n1. Lint checks are standardized and runnable locally and in CI.\n2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n4. Dependabot is configured for npm and GitHub Actions update automation.\n5. Final verification provides an explicit GO/NO-GO with blocker severity.\n\n## Non-goals (Wave 1.5 Quality Gates)\n1. Refactoring product features unrelated to quality-gate enablement.\n2. Introducing deployment/release automation beyond CI validation.\n3. Replacing package manager or test framework.\n\n## Assumptions (Wave 1.5 Quality Gates)\n1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n2. CI runs on `pull_request` and `push` to `main`.\n3. Dependabot cadence is weekly for both npm and GitHub Actions.\n\n## Verification Plan (Wave 1.5 Quality Gates)\n1. Run all local quality-gate commands after implementation.\n2. Validate CI workflow trigger paths for PR and merge events.\n3. Confirm Dependabot config parses and targets both ecosystems.\n\n## Rollback Plan (Wave 1.5 Quality Gates)\n1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n\n\n## Goal\nDeliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n\n\n## Tasks (Wave 1 Remediation)\n1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n\n## Acceptance Criteria (Wave 1 Remediation)\n1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n\n## Verification Plan (Wave 1 Remediation)\n1. `pnpm run test -- notes`\n2. `pnpm run test -- task-parser`\n3. `pnpm install`\n4. `pnpm run test -- space`\n5. `pnpm run test -- git`\n6. `pnpm run dev` plus manual restart persistence check.\n\n## Wave 1 Gate Status (2026-02-16)\n- Decision: **NO-GO** for Wave 2.\n- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n- `Electron failed to install correctly` is resolved as the active failure signature.\n- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n\n\n\n## Tasks (Wave 1.1 Fixes)\n\n- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n\n- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n\n- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n\n## Tasks (Wave 1.2 Runtime Remediation)\n\n- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n\n- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n\n## Tasks (Wave 1.3 Git Hygiene)\n\n- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n\n- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n\n## Tasks (Wave 1.4 Runtime Launch Stabilization)\n\n- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n\n- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n\n## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n2. Runtime launch path is deterministic and documented with reproducible evidence.\n3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n\n## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n## Tasks\n- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n\n- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n\n- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n\n- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n\n- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n\n\n- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n\n- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n\n- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n\n- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n\n- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n\n\n- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n## Acceptance Criteria\n1. A user can install and run the app, create a space, and reopen it later with full state restored.\n2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n6. The app provides an in-app browser preview for localhost development targets.\n7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n\n## Non-goals\n- Production authentication, billing, licensing, or multi-tenant cloud backend.\n- Full marketplace for custom specialists.\n- Full CI/CD orchestration or deployment management from within the app.\n- Large-scale distributed indexing or enterprise ingestion pipelines.\n\n## Assumptions\n- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n\n## Verification Plan\n1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n\n## Rollback Plan\n1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.","title":"Spec"}
{"type":"diff","v":32,"date":"2026-02-16T23:44:52.030Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -5 +5 @@\n-- [/] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n@@ -7 +7 @@\n-- [ ] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+- [/] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)"}
{"type":"diff","v":33,"date":"2026-02-16T23:50:54.433Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -7 +7 @@\n-- [/] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n@@ -9 +9 @@\n-- [ ] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+- [/] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)"}
{"type":"diff","v":34,"date":"2026-02-17T00:00:07.292Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -9 +9 @@\n-- [/] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n@@ -41 +41 @@\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n@@ -44 +42 @@\n-## Tasks (Wave 1.6 Blocker Burn-down)\n+## Wave 2.1 Final Status (2026-02-16)\n@@ -46 +44 @@\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n@@ -90 +45 @@\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [ ] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data."}
{"type":"diff","v":35,"date":"2026-02-17T00:16:07.276Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -57 +57 @@\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n@@ -60 +58 @@\n-## Tasks (Wave 1.6 Blocker Burn-down)\n+## UAT Plan (Wave 2.1)\n@@ -62 +60 @@\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n@@ -64 +62 @@\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract."}
{"type":"diff","v":36,"date":"2026-02-17T00:23:35.310Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -1 +1 @@\n-## Goal (Wave 2.1 Orchestrator Planning Loop)\n-Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+## Goal (Wave 2.1 UAT Remediation)\n+Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n@@ -4 +4 @@\n-## Tasks (Wave 2.1 Orchestrator Planning Loop)\n-- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+## Tasks (Wave 2.1 UAT Remediation)\n+- [ ] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n@@ -7 +7 @@\n-- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+- [ ] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n@@ -9 +9 @@\n-- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+- [ ] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n@@ -11 +11 @@\n-## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n-1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n-2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n-3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n-4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n-\n-## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Building in-app browser preview.\n-4. Integrating context adapter providers beyond current local flow.\n-\n-## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n-2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n-3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n-\n-## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n-2. Run `pnpm run desktop:typecheck` after each wave.\n-3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n-\n-## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n-2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n-3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n-\n----\n-\n-\n-\n-## Wave 2.1 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Wave 2.1 tasks are complete:\n-  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n-  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n-  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n-- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n-- Wave 2.1 acceptance criteria are satisfied:\n-  1. Prompt-triggered run lifecycle: PASS.\n-  2. Spec draft synthesis/apply path: PASS.\n-  3. Implement/Verify/Debug delegation + timeline: PASS.\n-  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n-- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n-- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n-\n-## UAT Plan (Wave 2.1)\n-\n-Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n-\n-### Preconditions\n-1. App launches in dev mode.\n-2. You are in a workspace with the `Orchestrator` view available.\n-3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n-\n-### Test Cases\n-1. Happy-path run lifecycle\n-- Action: submit a normal orchestrator prompt.\n-- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n-\n-2. Spec draft generation + apply\n-- Action: from a successful run, apply the generated draft to spec.\n-- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n-\n-3. Delegation timeline visibility\n-- Action: inspect delegated tasks for the run.\n-- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n-\n-4. Failure-path behavior\n-- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n-- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n-\n-5. Session persistence sanity\n-- Action: reopen the app/workspace after at least one successful and one failed run.\n-- Expect: orchestrator run history (including timeline/status) is still present.\n-\n-### Result Recording\n-For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n-\n-### Exit Criteria\n-- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n-- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n-\n-## Tasks (Wave 1.6 Blocker Burn-down)\n-\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n-\n-## UAT Results (Wave 2.1)\n-\n-### Case 1: Happy-path run lifecycle\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16):\n-  - Run reached terminal success (`Run ... is completed`).\n-  - Lifecycle shows expected progression: `queued -> running -> completed`.\n-  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n-  - Draft generation state present: `Draft: ready for run ...`.\n-\n-### Case 2: Spec draft generation + apply\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16 4:07 PM):\n-  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n-  - Apply action succeeded (`Applied draft from run ...`).\n-  - Spec Markdown/Preview panes show updated draft-derived content.\n-  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n-\n-### Case 3: Delegation timeline visibility\n-- Result: **PASS**\n-- Evidence (same UAT screenshots):\n-  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n-  - Each row shows explicit transition chain with terminal `completed` state.\n-  - Run-level lifecycle and per-task timeline information are both rendered together.\n-\n-### Case 4: Failure-path behavior\n-- Result: **FAIL**\n-- Evidence (user screenshot, 2026-02-16 4:10 PM):\n-  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n-  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n-  - Delegated tasks all completed; no failure message surfaced.\n-- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n-- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+## Acceptance Criteria (Wave 2.1 UAT Remediation)\n+1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n+2. Orchestrator run history (not latest-only) is visible and persists across restart.\n+3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n+4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+\n+## Non-goals (Wave 2.1 UAT Remediation)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Adding in-app browser preview.\n+4. Context adapter/provider integration expansion.\n+\n+## Assumptions (Wave 2.1 UAT Remediation)\n+1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n+2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n+3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n+\n+## Verification Plan (Wave 2.1 UAT Remediation)\n+1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n+2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n+3. Record final remediation GO/NO-GO in `spec` with residual risks.\n+\n+## Rollback Plan (Wave 2.1 UAT Remediation)\n+1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n+2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n+3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+\n+## Wave 2.1 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+\n+## UAT Plan (Wave 2.1)\n+\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n+\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+\n+### Case 5: Session persistence sanity\n+- Result: **PARTIAL / FAIL**\n+- PASS: latest orchestrator run state persists across app restart.\n+- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n+\n+### Additional UAT Observation\n+- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n+- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n+\n+### UAT Status (Wave 2.1)\n+- Current UAT decision: **NO-GO** pending remediation for:\n+  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n+  2. Case 5 run-history/timeline persistence gap (latest-only visibility)."}
{"type":"diff","v":37,"date":"2026-02-17T01:15:32.861Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -5 +5 @@\n-- [ ] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n@@ -7 +7 @@\n-- [ ] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n@@ -9 +9 @@\n-- [ ] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)"}
{"type":"diff","v":38,"date":"2026-02-17T01:55:02.702Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -1 +1 @@\n-## Goal (Wave 2.1 UAT Remediation)\n-Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n+## Goal (Git Stability Incident)\n+Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n@@ -4 +4 @@\n-## Tasks (Wave 2.1 UAT Remediation)\n-- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+## Tasks (Git Stability Incident)\n+- [/] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n@@ -7 +7 @@\n-- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+- [/] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n@@ -9 +9 @@\n-- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+- [/] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n@@ -11 +11 @@\n-## Acceptance Criteria (Wave 2.1 UAT Remediation)\n-1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n-2. Orchestrator run history (not latest-only) is visible and persists across restart.\n-3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n-4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+- [ ] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n@@ -17 +13 @@\n-## Non-goals (Wave 2.1 UAT Remediation)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Adding in-app browser preview.\n-4. Context adapter/provider integration expansion.\n-\n-## Assumptions (Wave 2.1 UAT Remediation)\n-1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n-2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n-3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n-\n-## Verification Plan (Wave 2.1 UAT Remediation)\n-1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n-2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n-3. Record final remediation GO/NO-GO in `spec` with residual risks.\n-\n-## Rollback Plan (Wave 2.1 UAT Remediation)\n-1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n-2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n-3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n-\n----\n-\n-\n-## Goal (Wave 2.1 Orchestrator Planning Loop)\n-Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n-\n-## Tasks (Wave 2.1 Orchestrator Planning Loop)\n-- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n-\n-- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n-\n-- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n-\n-## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n-1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n-2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n-3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n-4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n-\n-## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Building in-app browser preview.\n-4. Integrating context adapter providers beyond current local flow.\n-\n-## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n-2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n-3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n-\n-## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n-2. Run `pnpm run desktop:typecheck` after each wave.\n-3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n-\n-## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n-2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n-3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n-\n----\n-\n-\n-\n-## Wave 2.1 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Wave 2.1 tasks are complete:\n-  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n-  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n-  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n-- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n-- Wave 2.1 acceptance criteria are satisfied:\n-  1. Prompt-triggered run lifecycle: PASS.\n-  2. Spec draft synthesis/apply path: PASS.\n-  3. Implement/Verify/Debug delegation + timeline: PASS.\n-  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n-- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n-- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n-\n-## UAT Plan (Wave 2.1)\n-\n-Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n-\n-### Preconditions\n-1. App launches in dev mode.\n-2. You are in a workspace with the `Orchestrator` view available.\n-3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n-\n-### Test Cases\n-1. Happy-path run lifecycle\n-- Action: submit a normal orchestrator prompt.\n-- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n-\n-2. Spec draft generation + apply\n-- Action: from a successful run, apply the generated draft to spec.\n-- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n-\n-3. Delegation timeline visibility\n-- Action: inspect delegated tasks for the run.\n-- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n-\n-4. Failure-path behavior\n-- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n-- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n-\n-5. Session persistence sanity\n-- Action: reopen the app/workspace after at least one successful and one failed run.\n-- Expect: orchestrator run history (including timeline/status) is still present.\n-\n-### Result Recording\n-For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n-\n-### Exit Criteria\n-- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n-- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n-\n-## Tasks (Wave 1.6 Blocker Burn-down)\n-\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n-\n-## UAT Results (Wave 2.1)\n-\n-### Case 1: Happy-path run lifecycle\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16):\n-  - Run reached terminal success (`Run ... is completed`).\n-  - Lifecycle shows expected progression: `queued -> running -> completed`.\n-  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n-  - Draft generation state present: `Draft: ready for run ...`.\n-\n-### Case 2: Spec draft generation + apply\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16 4:07 PM):\n-  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n-  - Apply action succeeded (`Applied draft from run ...`).\n-  - Spec Markdown/Preview panes show updated draft-derived content.\n-  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n-\n-### Case 3: Delegation timeline visibility\n-- Result: **PASS**\n-- Evidence (same UAT screenshots):\n-  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n-  - Each row shows explicit transition chain with terminal `completed` state.\n-  - Run-level lifecycle and per-task timeline information are both rendered together.\n-\n-### Case 4: Failure-path behavior\n-- Result: **FAIL**\n-- Evidence (user screenshot, 2026-02-16 4:10 PM):\n-  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n-  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n-  - Delegated tasks all completed; no failure message surfaced.\n-- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n-- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n-\n-### Case 5: Session persistence sanity\n-- Result: **PARTIAL / FAIL**\n-- PASS: latest orchestrator run state persists across app restart.\n-- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n-\n-### Additional UAT Observation\n-- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n-- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n-\n-### UAT Status (Wave 2.1)\n-- Current UAT decision: **NO-GO** pending remediation for:\n-  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n-  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n+## Acceptance Criteria (Git Stability Incident)\n+1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n+2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n+3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n+4. Independent verifier issues explicit GO before feature work resumes.\n+\n+## Non-goals (Git Stability Incident)\n+1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n+2. Rewriting the entire repository history.\n+3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n+\n+## Assumptions (Git Stability Incident)\n+1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n+2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n+3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n+\n+## Verification Plan (Git Stability Incident)\n+1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n+2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n+3. Resume feature tasks only after explicit GO is captured in `spec`.\n+\n+## Rollback Plan (Git Stability Incident)\n+1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n+2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n+3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 UAT Remediation)\n+Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n+\n+## Tasks (Wave 2.1 UAT Remediation)\n+- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+\n+- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+\n+- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+\n+## Acceptance Criteria (Wave 2.1 UAT Remediation)\n+1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n+2. Orchestrator run history (not latest-only) is visible and persists across restart.\n+3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n+4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+\n+## Non-goals (Wave 2.1 UAT Remediation)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Adding in-app browser preview.\n+4. Context adapter/provider integration expansion.\n+\n+## Assumptions (Wave 2.1 UAT Remediation)\n+1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n+2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n+3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n+\n+## Verification Plan (Wave 2.1 UAT Remediation)\n+1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n+2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n+3. Record final remediation GO/NO-GO in `spec` with residual risks.\n+\n+## Rollback Plan (Wave 2.1 UAT Remediation)\n+1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n+2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n+3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+\n+## Wave 2.1 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+\n+## UAT Plan (Wave 2.1)\n+\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n+\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+\n+### Case 5: Session persistence sanity\n+- Result: **PARTIAL / FAIL**\n+- PASS: latest orchestrator run state persists across app restart.\n+- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n+\n+### Additional UAT Observation\n+- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n+- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n+\n+### UAT Status (Wave 2.1)\n+- Current UAT decision: **NO-GO** pending remediation for:\n+  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n+  2. Case 5 run-history/timeline persistence gap (latest-only visibility)."}
{"type":"diff","v":39,"date":"2026-02-17T02:46:05.409Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -5 +5 @@\n-- [/] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n@@ -7 +7 @@\n-- [/] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n+- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n@@ -9 +9 @@\n-- [/] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n+- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n@@ -11 +11 @@\n-- [ ] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n+- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n@@ -42 +42 @@\n-## Goal (Wave 2.1 UAT Remediation)\n-Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n@@ -45 +43 @@\n-## Tasks (Wave 2.1 UAT Remediation)\n-- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+## Incident Status (2026-02-17)\n@@ -48 +45 @@\n-- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n-\n-- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n-\n-## Acceptance Criteria (Wave 2.1 UAT Remediation)\n-1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n-2. Orchestrator run history (not latest-only) is visible and persists across restart.\n-3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n-4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n-\n-## Non-goals (Wave 2.1 UAT Remediation)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Adding in-app browser preview.\n-4. Context adapter/provider integration expansion.\n-\n-## Assumptions (Wave 2.1 UAT Remediation)\n-1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n-2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n-3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n-\n-## Verification Plan (Wave 2.1 UAT Remediation)\n-1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n-2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n-3. Record final remediation GO/NO-GO in `spec` with residual risks.\n-\n-## Rollback Plan (Wave 2.1 UAT Remediation)\n-1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n-2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n-3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n-\n----\n-\n-\n-## Goal (Wave 2.1 Orchestrator Planning Loop)\n-Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n-\n-## Tasks (Wave 2.1 Orchestrator Planning Loop)\n-- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n-\n-- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n-\n-- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n-\n-## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n-1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n-2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n-3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n-4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n-\n-## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Building in-app browser preview.\n-4. Integrating context adapter providers beyond current local flow.\n-\n-## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n-2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n-3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n-\n-## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n-2. Run `pnpm run desktop:typecheck` after each wave.\n-3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n-\n-## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n-2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n-3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n-\n----\n-\n-\n-\n-## Wave 2.1 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Wave 2.1 tasks are complete:\n-  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n-  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n-  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n-- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n-- Wave 2.1 acceptance criteria are satisfied:\n-  1. Prompt-triggered run lifecycle: PASS.\n-  2. Spec draft synthesis/apply path: PASS.\n-  3. Implement/Verify/Debug delegation + timeline: PASS.\n-  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n-- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n-- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n-\n-## UAT Plan (Wave 2.1)\n-\n-Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n-\n-### Preconditions\n-1. App launches in dev mode.\n-2. You are in a workspace with the `Orchestrator` view available.\n-3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n-\n-### Test Cases\n-1. Happy-path run lifecycle\n-- Action: submit a normal orchestrator prompt.\n-- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n-\n-2. Spec draft generation + apply\n-- Action: from a successful run, apply the generated draft to spec.\n-- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n-\n-3. Delegation timeline visibility\n-- Action: inspect delegated tasks for the run.\n-- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n-\n-4. Failure-path behavior\n-- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n-- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n-\n-5. Session persistence sanity\n-- Action: reopen the app/workspace after at least one successful and one failed run.\n-- Expect: orchestrator run history (including timeline/status) is still present.\n-\n-### Result Recording\n-For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n-\n-### Exit Criteria\n-- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n-- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n-\n-## Tasks (Wave 1.6 Blocker Burn-down)\n-\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n-\n-## UAT Results (Wave 2.1)\n-\n-### Case 1: Happy-path run lifecycle\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16):\n-  - Run reached terminal success (`Run ... is completed`).\n-  - Lifecycle shows expected progression: `queued -> running -> completed`.\n-  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n-  - Draft generation state present: `Draft: ready for run ...`.\n-\n-### Case 2: Spec draft generation + apply\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16 4:07 PM):\n-  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n-  - Apply action succeeded (`Applied draft from run ...`).\n-  - Spec Markdown/Preview panes show updated draft-derived content.\n-  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n-\n-### Case 3: Delegation timeline visibility\n-- Result: **PASS**\n-- Evidence (same UAT screenshots):\n-  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n-  - Each row shows explicit transition chain with terminal `completed` state.\n-  - Run-level lifecycle and per-task timeline information are both rendered together.\n-\n-### Case 4: Failure-path behavior\n-- Result: **FAIL**\n-- Evidence (user screenshot, 2026-02-16 4:10 PM):\n-  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n-  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n-  - Delegated tasks all completed; no failure message surfaced.\n-- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n-- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n-\n-### Case 5: Session persistence sanity\n-- Result: **PARTIAL / FAIL**\n-- PASS: latest orchestrator run state persists across app restart.\n-- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n-\n-### Additional UAT Observation\n-- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n-- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n-\n-### UAT Status (Wave 2.1)\n-- Current UAT decision: **NO-GO** pending remediation for:\n-  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n-  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n+1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n+2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n+3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n+4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n+5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n+6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n+7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n+8. Feature work may resume.\n+\n+## Goal (Wave 2.1 UAT Remediation)\n+Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n+\n+## Tasks (Wave 2.1 UAT Remediation)\n+- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+\n+- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+\n+- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+\n+## Acceptance Criteria (Wave 2.1 UAT Remediation)\n+1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n+2. Orchestrator run history (not latest-only) is visible and persists across restart.\n+3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n+4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+\n+## Non-goals (Wave 2.1 UAT Remediation)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Adding in-app browser preview.\n+4. Context adapter/provider integration expansion.\n+\n+## Assumptions (Wave 2.1 UAT Remediation)\n+1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n+2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n+3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n+\n+## Verification Plan (Wave 2.1 UAT Remediation)\n+1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n+2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n+3. Record final remediation GO/NO-GO in `spec` with residual risks.\n+\n+## Rollback Plan (Wave 2.1 UAT Remediation)\n+1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n+2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n+3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+\n+## Wave 2.1 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+\n+## UAT Plan (Wave 2.1)\n+\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n+\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+\n+### Case 5: Session persistence sanity\n+- Result: **PARTIAL / FAIL**\n+- PASS: latest orchestrator run state persists across app restart.\n+- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n+\n+### Additional UAT Observation\n+- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n+- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n+\n+### UAT Status (Wave 2.1)\n+- Current UAT decision: **NO-GO** pending remediation for:\n+  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n+  2. Case 5 run-history/timeline persistence gap (latest-only visibility)."}
{"type":"diff","v":40,"date":"2026-02-17T03:02:41.080Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -1 +1 @@\n-## Goal (Git Stability Incident)\n-Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n+## Goal\n+Restore a healthy Git baseline, recover the pre-reset feature work, and resume implementation from a clean, pushable branch.\n@@ -4 +4 @@\n-## Tasks (Git Stability Incident)\n-- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+## Tasks\n+- [ ] [Recover pre-reset work into current workspace](intent://local/task/7a006ca5-e5df-4dfd-8134-70db25f8203c)\n@@ -7 +7 @@\n-- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n+- [ ] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n@@ -9 +9 @@\n-- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n+- [ ] [Outsource independent PR work and resume primary feature](intent://local/task/d7a5cef2-5289-444a-a5b7-21822d012663)\n@@ -11 +11 @@\n-- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n-\n-## Acceptance Criteria (Git Stability Incident)\n-1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n-2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n-3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n-4. Independent verifier issues explicit GO before feature work resumes.\n-\n-## Non-goals (Git Stability Incident)\n-1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n-2. Rewriting the entire repository history.\n-3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n-\n-## Assumptions (Git Stability Incident)\n-1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n-2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n-3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n-\n-## Verification Plan (Git Stability Incident)\n-1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n-2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n-3. Resume feature tasks only after explicit GO is captured in `spec`.\n-\n-## Rollback Plan (Git Stability Incident)\n-1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n-2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n-3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n-\n----\n-\n-\n-\n-## Incident Status (2026-02-17)\n-\n-1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n-2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n-3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n-4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n-5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n-6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n-7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n-8. Feature work may resume.\n-\n-## Goal (Wave 2.1 UAT Remediation)\n-Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n-\n-## Tasks (Wave 2.1 UAT Remediation)\n-- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n-\n-- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n-\n-- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n-\n-## Acceptance Criteria (Wave 2.1 UAT Remediation)\n-1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n-2. Orchestrator run history (not latest-only) is visible and persists across restart.\n-3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n-4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n-\n-## Non-goals (Wave 2.1 UAT Remediation)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Adding in-app browser preview.\n-4. Context adapter/provider integration expansion.\n-\n-## Assumptions (Wave 2.1 UAT Remediation)\n-1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n-2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n-3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n-\n-## Verification Plan (Wave 2.1 UAT Remediation)\n-1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n-2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n-3. Record final remediation GO/NO-GO in `spec` with residual risks.\n-\n-## Rollback Plan (Wave 2.1 UAT Remediation)\n-1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n-2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n-3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n-\n----\n-\n-\n-## Goal (Wave 2.1 Orchestrator Planning Loop)\n-Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n-\n-## Tasks (Wave 2.1 Orchestrator Planning Loop)\n-- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n-\n-- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n-\n-- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n-\n-## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n-1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n-2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n-3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n-4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n-\n-## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Building in-app browser preview.\n-4. Integrating context adapter providers beyond current local flow.\n-\n-## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n-2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n-3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n-\n-## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n-2. Run `pnpm run desktop:typecheck` after each wave.\n-3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n-\n-## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n-2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n-3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n-\n----\n-\n-\n-\n-## Wave 2.1 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Wave 2.1 tasks are complete:\n-  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n-  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n-  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n-- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n-- Wave 2.1 acceptance criteria are satisfied:\n-  1. Prompt-triggered run lifecycle: PASS.\n-  2. Spec draft synthesis/apply path: PASS.\n-  3. Implement/Verify/Debug delegation + timeline: PASS.\n-  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n-- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n-- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n-\n-## UAT Plan (Wave 2.1)\n-\n-Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n-\n-### Preconditions\n-1. App launches in dev mode.\n-2. You are in a workspace with the `Orchestrator` view available.\n-3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n-\n-### Test Cases\n-1. Happy-path run lifecycle\n-- Action: submit a normal orchestrator prompt.\n-- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n-\n-2. Spec draft generation + apply\n-- Action: from a successful run, apply the generated draft to spec.\n-- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n-\n-3. Delegation timeline visibility\n-- Action: inspect delegated tasks for the run.\n-- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n-\n-4. Failure-path behavior\n-- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n-- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n-\n-5. Session persistence sanity\n-- Action: reopen the app/workspace after at least one successful and one failed run.\n-- Expect: orchestrator run history (including timeline/status) is still present.\n-\n-### Result Recording\n-For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n-\n-### Exit Criteria\n-- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n-- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n-\n-## Tasks (Wave 1.6 Blocker Burn-down)\n-\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n@@ -386 +12 @@\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n-\n-## UAT Results (Wave 2.1)\n-\n-### Case 1: Happy-path run lifecycle\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16):\n-  - Run reached terminal success (`Run ... is completed`).\n-  - Lifecycle shows expected progression: `queued -> running -> completed`.\n-  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n-  - Draft generation state present: `Draft: ready for run ...`.\n-\n-### Case 2: Spec draft generation + apply\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16 4:07 PM):\n-  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n-  - Apply action succeeded (`Applied draft from run ...`).\n-  - Spec Markdown/Preview panes show updated draft-derived content.\n-  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n-\n-### Case 3: Delegation timeline visibility\n-- Result: **PASS**\n-- Evidence (same UAT screenshots):\n-  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n-  - Each row shows explicit transition chain with terminal `completed` state.\n-  - Run-level lifecycle and per-task timeline information are both rendered together.\n-\n-### Case 4: Failure-path behavior\n-- Result: **FAIL**\n-- Evidence (user screenshot, 2026-02-16 4:10 PM):\n-  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n-  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n-  - Delegated tasks all completed; no failure message surfaced.\n-- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n-- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n-\n-### Case 5: Session persistence sanity\n-- Result: **PARTIAL / FAIL**\n-- PASS: latest orchestrator run state persists across app restart.\n-- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n-\n-### Additional UAT Observation\n-- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n-- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n-\n-### UAT Status (Wave 2.1)\n-- Current UAT decision: **NO-GO** pending remediation for:\n-  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n-  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n+1. Pre-reset work is restored into the active workspace branch without data loss.\n+2. Git health checks pass with no garbage warnings or invalid refs.\n+3. Required stale session artifacts are cleaned locally/remotely without deleting active branches.\n+4. At least one feature task is actively resumed with clear delegation.\n+5. Outsourceable PR candidates and handoffs are documented.\n+\n+## Non-goals\n+1. Rewriting published `main` history.\n+2. Deleting non-session branches without explicit approval.\n+3. Bundling all remaining feature work into one large PR.\n+\n+## Assumptions\n+1. We should restore the full pre-reset branch tip (`fe3e028e5b5e7d7d273e011d5ae7e5483640b94c`) (confirm?).\n+2. Remote cleanup may delete only session branches (`codex/*`, `git-stability-incident`, `unblock-wave-1-verification`) (confirm?).\n+3. Highest-priority resume target remains run-history persistence (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) (confirm?).\n+\n+## Verification Plan\n+1. Run recovery and Git-health commands from Task 1 and Task 2.\n+2. Validate push capability from the recovered branch.\n+3. Verify spec includes outsourcing handoffs and delegated resume task.\n+\n+## Rollback Plan\n+1. If the recovery branch is wrong, delete only the recovery branch and refetch from backup path.\n+2. If cleanup removes a needed branch, recreate from backup SHA and restore the remote ref.\n+3. If push fails, use documented fresh-clone fallback without changing recovered branch content.\n+\n+\n+\n+## Goal (Git Stability Incident)\n+Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n+\n+## Tasks (Git Stability Incident)\n+- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+\n+- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n+\n+- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n+\n+- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n+\n+## Acceptance Criteria (Git Stability Incident)\n+1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n+2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n+3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n+4. Independent verifier issues explicit GO before feature work resumes.\n+\n+## Non-goals (Git Stability Incident)\n+1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n+2. Rewriting the entire repository history.\n+3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n+\n+## Assumptions (Git Stability Incident)\n+1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n+2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n+3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n+\n+## Verification Plan (Git Stability Incident)\n+1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n+2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n+3. Resume feature tasks only after explicit GO is captured in `spec`.\n+\n+## Rollback Plan (Git Stability Incident)\n+1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n+2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n+3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n+\n+---\n+\n+\n+\n+## Incident Status (2026-02-17)\n+\n+1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n+2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n+3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n+4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n+5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n+6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n+7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n+8. Feature work may resume.\n+\n+## Goal (Wave 2.1 UAT Remediation)\n+Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n+\n+## Tasks (Wave 2.1 UAT Remediation)\n+- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+\n+- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+\n+- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+\n+## Acceptance Criteria (Wave 2.1 UAT Remediation)\n+1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n+2. Orchestrator run history (not latest-only) is visible and persists across restart.\n+3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n+4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+\n+## Non-goals (Wave 2.1 UAT Remediation)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Adding in-app browser preview.\n+4. Context adapter/provider integration expansion.\n+\n+## Assumptions (Wave 2.1 UAT Remediation)\n+1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n+2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n+3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n+\n+## Verification Plan (Wave 2.1 UAT Remediation)\n+1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n+2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n+3. Record final remediation GO/NO-GO in `spec` with residual risks.\n+\n+## Rollback Plan (Wave 2.1 UAT Remediation)\n+1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n+2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n+3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+\n+## Wave 2.1 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+\n+## UAT Plan (Wave 2.1)\n+\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n+\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+\n+### Case 5: Session persistence sanity\n+- Result: **PARTIAL / FAIL**\n+- PASS: latest orchestrator run state persists across app restart.\n+- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n+\n+### Additional UAT Observation\n+- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n+- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n+\n+### UAT Status (Wave 2.1)\n+- Current UAT decision: **NO-GO** pending remediation for:\n+  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n+  2. Case 5 run-history/timeline persistence gap (latest-only visibility)."}
{"type":"snapshot","v":41,"date":"2026-02-17T03:28:01.847Z","author":{"id":"user","name":"User","type":"user"},"content":"## Goal\nRestore a healthy Git baseline, recover the pre-reset feature work, and resume implementation from a clean, pushable branch.\n\n## Tasks\n- [x] [Recover pre-reset work into current workspace](intent://local/task/7a006ca5-e5df-4dfd-8134-70db25f8203c)\n\n- [/] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n\n- [/] [Outsource independent PR work and resume primary feature](intent://local/task/d7a5cef2-5289-444a-a5b7-21822d012663)\n\n## Acceptance Criteria\n1. Pre-reset work is restored into the active workspace branch without data loss.\n2. Git health checks pass with no garbage warnings or invalid refs.\n3. Required stale session artifacts are cleaned locally/remotely without deleting active branches.\n4. At least one feature task is actively resumed with clear delegation.\n5. Outsourceable PR candidates and handoffs are documented.\n\n## Non-goals\n1. Rewriting published `main` history.\n2. Deleting non-session branches without explicit approval.\n3. Bundling all remaining feature work into one large PR.\n\n## Assumptions\n1. We should restore the full pre-reset branch tip (`fe3e028e5b5e7d7d273e011d5ae7e5483640b94c`) (confirm?).\n2. Remote cleanup may delete only session branches (`codex/*`, `git-stability-incident`, `unblock-wave-1-verification`) (confirm?).\n3. Highest-priority resume target remains run-history persistence (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) (confirm?).\n\n## Verification Plan\n1. Run recovery and Git-health commands from Task 1 and Task 2.\n2. Validate push capability from the recovered branch.\n3. Verify spec includes outsourcing handoffs and delegated resume task.\n\n## Rollback Plan\n1. If the recovery branch is wrong, delete only the recovery branch and refetch from backup path.\n2. If cleanup removes a needed branch, recreate from backup SHA and restore the remote ref.\n3. If push fails, use documented fresh-clone fallback without changing recovered branch content.\n\n\n\n\n## Recovery Checkpoint (2026-02-17)\n\n1. Git branch tracking is now healthy on the active branch: `feature/run-history-persistence...origin/feature/run-history-persistence`.\n2. Recovery content exists on remote at `origin/feature/run-history-persistence` -> `be71982fc9e214b689eb529d3e9b2cb1f4d9b99c`.\n3. Local Git health checks remain clean (`garbage: 0`, no invalid-ref errors).\n4. Stale `origin/codex/*` branches used during incident handling were removed.\n5. Residual risk: direct large-pack pushes still intermittently fail with remote unpack/inflate errors; fallback publish path is the current mitigation.\n\n## Outsource Candidates And Handoffs (2026-02-17)\n1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\nHandoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\nHandoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\nHandoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n## Goal (Git Stability Incident)\nRestore reliable Git operations for all sessions in this repository before any more feature work continues.\n\n## Tasks (Git Stability Incident)\n- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n\n- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n\n- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n\n- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n\n## Acceptance Criteria (Git Stability Incident)\n1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n4. Independent verifier issues explicit GO before feature work resumes.\n\n## Non-goals (Git Stability Incident)\n1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n2. Rewriting the entire repository history.\n3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n\n## Assumptions (Git Stability Incident)\n1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n\n## Verification Plan (Git Stability Incident)\n1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n3. Resume feature tasks only after explicit GO is captured in `spec`.\n\n## Rollback Plan (Git Stability Incident)\n1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n\n---\n\n\n\n## Incident Status (2026-02-17)\n\n1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n8. Feature work may resume.\n\n## Goal (Wave 2.1 UAT Remediation)\nAddress UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n\n## Tasks (Wave 2.1 UAT Remediation)\n- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n\n- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n\n- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n\n## Acceptance Criteria (Wave 2.1 UAT Remediation)\n1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n2. Orchestrator run history (not latest-only) is visible and persists across restart.\n3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n\n## Non-goals (Wave 2.1 UAT Remediation)\n1. Implementing real provider authentication/runtime.\n2. Building Changes-tab diff/PR workflows.\n3. Adding in-app browser preview.\n4. Context adapter/provider integration expansion.\n\n## Assumptions (Wave 2.1 UAT Remediation)\n1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n\n## Verification Plan (Wave 2.1 UAT Remediation)\n1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n3. Record final remediation GO/NO-GO in `spec` with residual risks.\n\n## Rollback Plan (Wave 2.1 UAT Remediation)\n1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n\n---\n\n\n## Goal (Wave 2.1 Orchestrator Planning Loop)\nDeliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n\n## Tasks (Wave 2.1 Orchestrator Planning Loop)\n- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n\n- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n\n- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n\n## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n\n## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n1. Implementing real provider authentication/runtime.\n2. Building Changes-tab diff/PR workflows.\n3. Building in-app browser preview.\n4. Integrating context adapter providers beyond current local flow.\n\n## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n\n## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n2. Run `pnpm run desktop:typecheck` after each wave.\n3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n\n## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n\n---\n\n\n\n## Wave 2.1 Final Status (2026-02-16)\n\n- Decision: **GO**.\n- Wave 2.1 tasks are complete:\n  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n- Wave 2.1 acceptance criteria are satisfied:\n  1. Prompt-triggered run lifecycle: PASS.\n  2. Spec draft synthesis/apply path: PASS.\n  3. Implement/Verify/Debug delegation + timeline: PASS.\n  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n\n## UAT Plan (Wave 2.1)\n\nScope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n\n### Preconditions\n1. App launches in dev mode.\n2. You are in a workspace with the `Orchestrator` view available.\n3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n\n### Test Cases\n1. Happy-path run lifecycle\n- Action: submit a normal orchestrator prompt.\n- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n\n2. Spec draft generation + apply\n- Action: from a successful run, apply the generated draft to spec.\n- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n\n3. Delegation timeline visibility\n- Action: inspect delegated tasks for the run.\n- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n\n4. Failure-path behavior\n- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n\n5. Session persistence sanity\n- Action: reopen the app/workspace after at least one successful and one failed run.\n- Expect: orchestrator run history (including timeline/status) is still present.\n\n### Result Recording\nFor each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n\n### Exit Criteria\n- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n## Goal (Wave 1.6 Blocker Burn-down)\nMake the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n\n## Tasks (Wave 1.6 Blocker Burn-down)\n\n- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n\n- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n\n- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n\n- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n\n- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n\n## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n\n## Non-goals (Wave 1.6 Blocker Burn-down)\n1. Changing quality-gate thresholds.\n2. Reworking CI/Dependabot architecture beyond required alignment updates.\n3. Shipping unrelated product features.\n\n## Assumptions (Wave 1.6 Blocker Burn-down)\n1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n\n## Verification Plan (Wave 1.6 Blocker Burn-down)\n1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n\n## Rollback Plan (Wave 1.6 Blocker Burn-down)\n1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n\n---\n\n\n\n\n## Wave 1.6 Final Status (2026-02-16)\n\n- Decision: **GO**.\n- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n## Goal (Wave 1.5 Quality Gates)\nEstablish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n\n## Tasks (Wave 1.5 Quality Gates)\n- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n\n- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n\n- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n\n- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n\n- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n\n## Acceptance Criteria (Wave 1.5 Quality Gates)\n1. Lint checks are standardized and runnable locally and in CI.\n2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n4. Dependabot is configured for npm and GitHub Actions update automation.\n5. Final verification provides an explicit GO/NO-GO with blocker severity.\n\n## Non-goals (Wave 1.5 Quality Gates)\n1. Refactoring product features unrelated to quality-gate enablement.\n2. Introducing deployment/release automation beyond CI validation.\n3. Replacing package manager or test framework.\n\n## Assumptions (Wave 1.5 Quality Gates)\n1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n2. CI runs on `pull_request` and `push` to `main`.\n3. Dependabot cadence is weekly for both npm and GitHub Actions.\n\n## Verification Plan (Wave 1.5 Quality Gates)\n1. Run all local quality-gate commands after implementation.\n2. Validate CI workflow trigger paths for PR and merge events.\n3. Confirm Dependabot config parses and targets both ecosystems.\n\n## Rollback Plan (Wave 1.5 Quality Gates)\n1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n\n\n## Goal\nDeliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n\n\n## Tasks (Wave 1 Remediation)\n1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n\n## Acceptance Criteria (Wave 1 Remediation)\n1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n\n## Verification Plan (Wave 1 Remediation)\n1. `pnpm run test -- notes`\n2. `pnpm run test -- task-parser`\n3. `pnpm install`\n4. `pnpm run test -- space`\n5. `pnpm run test -- git`\n6. `pnpm run dev` plus manual restart persistence check.\n\n## Wave 1 Gate Status (2026-02-16)\n- Decision: **NO-GO** for Wave 2.\n- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n- `Electron failed to install correctly` is resolved as the active failure signature.\n- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n\n\n\n## Tasks (Wave 1.1 Fixes)\n\n- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n\n- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n\n- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n\n## Tasks (Wave 1.2 Runtime Remediation)\n\n- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n\n- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n\n## Tasks (Wave 1.3 Git Hygiene)\n\n- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n\n- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n\n## Tasks (Wave 1.4 Runtime Launch Stabilization)\n\n- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n\n- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n\n## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n2. Runtime launch path is deterministic and documented with reproducible evidence.\n3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n\n## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n## Tasks\n- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n\n- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n\n- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n\n- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n\n- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n\n\n- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n\n- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n\n- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n\n- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n\n- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n\n\n- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n## Acceptance Criteria\n1. A user can install and run the app, create a space, and reopen it later with full state restored.\n2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n6. The app provides an in-app browser preview for localhost development targets.\n7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n\n## Non-goals\n- Production authentication, billing, licensing, or multi-tenant cloud backend.\n- Full marketplace for custom specialists.\n- Full CI/CD orchestration or deployment management from within the app.\n- Large-scale distributed indexing or enterprise ingestion pipelines.\n\n## Assumptions\n- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n\n## Verification Plan\n1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n\n## Rollback Plan\n1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n\n## UAT Results (Wave 2.1)\n\n### Case 1: Happy-path run lifecycle\n- Result: **PASS**\n- Evidence (user screenshot, 2026-02-16):\n  - Run reached terminal success (`Run ... is completed`).\n  - Lifecycle shows expected progression: `queued -> running -> completed`.\n  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n  - Draft generation state present: `Draft: ready for run ...`.\n\n### Case 2: Spec draft generation + apply\n- Result: **PASS**\n- Evidence (user screenshot, 2026-02-16 4:07 PM):\n  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n  - Apply action succeeded (`Applied draft from run ...`).\n  - Spec Markdown/Preview panes show updated draft-derived content.\n  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n\n### Case 3: Delegation timeline visibility\n- Result: **PASS**\n- Evidence (same UAT screenshots):\n  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n  - Each row shows explicit transition chain with terminal `completed` state.\n  - Run-level lifecycle and per-task timeline information are both rendered together.\n\n### Case 4: Failure-path behavior\n- Result: **FAIL**\n- Evidence (user screenshot, 2026-02-16 4:10 PM):\n  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n  - Delegated tasks all completed; no failure message surfaced.\n- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n\n### Case 5: Session persistence sanity\n- Result: **PARTIAL / FAIL**\n- PASS: latest orchestrator run state persists across app restart.\n- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n\n### Additional UAT Observation\n- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n\n### UAT Status (Wave 2.1)\n- Current UAT decision: **NO-GO** pending remediation for:\n  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n  2. Case 5 run-history/timeline persistence gap (latest-only visibility).","title":"Spec"}
{"type":"diff","v":42,"date":"2026-02-17T03:43:00.293Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -11 +11 @@\n+\n+- [/] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n@@ -49 +51 @@\n-## Outsource Candidates And Handoffs (2026-02-17)\n-1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n-Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n-2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n-Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n-3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n-Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n-4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n-## Goal (Git Stability Incident)\n-Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n@@ -60 +52 @@\n-## Tasks (Git Stability Incident)\n-- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+## Branch Protection Update (2026-02-17)\n@@ -63 +54 @@\n-- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n+Direct pushes to `main` are blocked by repository rules (`GH013`); integration to `main` must go through pull requests. Effective workflow: continue work on feature branches, open PRs targeting `main`, merge via GitHub, then sync local `main` from `origin/main`. This replaces any direct-push-to-main assumption.\n@@ -65 +56 @@\n-- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n+## Integration Gate (2026-02-17)\n@@ -67 +58 @@\n-- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n-\n-## Acceptance Criteria (Git Stability Incident)\n-1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n-2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n-3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n-4. Independent verifier issues explicit GO before feature work resumes.\n-\n-## Non-goals (Git Stability Incident)\n-1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n-2. Rewriting the entire repository history.\n-3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n-\n-## Assumptions (Git Stability Incident)\n-1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n-2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n-3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n-\n-## Verification Plan (Git Stability Incident)\n-1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n-2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n-3. Resume feature tasks only after explicit GO is captured in `spec`.\n-\n-## Rollback Plan (Git Stability Incident)\n-1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n-2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n-3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n-\n----\n-\n-\n-\n-## Incident Status (2026-02-17)\n-\n-1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n-2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n-3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n-4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n-5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n-6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n-7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n-8. Feature work may resume.\n-\n-## Goal (Wave 2.1 UAT Remediation)\n-Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n-\n-## Tasks (Wave 2.1 UAT Remediation)\n-- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n-\n-- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n-\n-- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n-\n-## Acceptance Criteria (Wave 2.1 UAT Remediation)\n-1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n-2. Orchestrator run history (not latest-only) is visible and persists across restart.\n-3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n-4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n-\n-## Non-goals (Wave 2.1 UAT Remediation)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Adding in-app browser preview.\n-4. Context adapter/provider integration expansion.\n-\n-## Assumptions (Wave 2.1 UAT Remediation)\n-1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n-2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n-3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n-\n-## Verification Plan (Wave 2.1 UAT Remediation)\n-1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n-2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n-3. Record final remediation GO/NO-GO in `spec` with residual risks.\n-\n-## Rollback Plan (Wave 2.1 UAT Remediation)\n-1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n-2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n-3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n-\n----\n-\n-\n-## Goal (Wave 2.1 Orchestrator Planning Loop)\n-Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n-\n-## Tasks (Wave 2.1 Orchestrator Planning Loop)\n-- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n-\n-- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n-\n-- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n-\n-## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n-1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n-2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n-3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n-4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n-\n-## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Building in-app browser preview.\n-4. Integrating context adapter providers beyond current local flow.\n-\n-## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n-2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n-3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n-\n-## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n-2. Run `pnpm run desktop:typecheck` after each wave.\n-3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n-\n-## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n-2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n-3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n-\n----\n-\n-\n-\n-## Wave 2.1 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Wave 2.1 tasks are complete:\n-  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n-  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n-  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n-- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n-- Wave 2.1 acceptance criteria are satisfied:\n-  1. Prompt-triggered run lifecycle: PASS.\n-  2. Spec draft synthesis/apply path: PASS.\n-  3. Implement/Verify/Debug delegation + timeline: PASS.\n-  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n-- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n-- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n-\n-## UAT Plan (Wave 2.1)\n-\n-Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n-\n-### Preconditions\n-1. App launches in dev mode.\n-2. You are in a workspace with the `Orchestrator` view available.\n-3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n-\n-### Test Cases\n-1. Happy-path run lifecycle\n-- Action: submit a normal orchestrator prompt.\n-- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n-\n-2. Spec draft generation + apply\n-- Action: from a successful run, apply the generated draft to spec.\n-- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n-\n-3. Delegation timeline visibility\n-- Action: inspect delegated tasks for the run.\n-- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n-\n-4. Failure-path behavior\n-- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n-- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n-\n-5. Session persistence sanity\n-- Action: reopen the app/workspace after at least one successful and one failed run.\n-- Expect: orchestrator run history (including timeline/status) is still present.\n-\n-### Result Recording\n-For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n-\n-### Exit Criteria\n-- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n-- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n-\n-## Tasks (Wave 1.6 Blocker Burn-down)\n-\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n-\n-## UAT Results (Wave 2.1)\n-\n-### Case 1: Happy-path run lifecycle\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16):\n-  - Run reached terminal success (`Run ... is completed`).\n-  - Lifecycle shows expected progression: `queued -> running -> completed`.\n-  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n-  - Draft generation state present: `Draft: ready for run ...`.\n-\n-### Case 2: Spec draft generation + apply\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16 4:07 PM):\n-  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n-  - Apply action succeeded (`Applied draft from run ...`).\n-  - Spec Markdown/Preview panes show updated draft-derived content.\n-  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n-\n-### Case 3: Delegation timeline visibility\n-- Result: **PASS**\n-- Evidence (same UAT screenshots):\n-  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n-  - Each row shows explicit transition chain with terminal `completed` state.\n-  - Run-level lifecycle and per-task timeline information are both rendered together.\n-\n-### Case 4: Failure-path behavior\n-- Result: **FAIL**\n-- Evidence (user screenshot, 2026-02-16 4:10 PM):\n-  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n-  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n-  - Delegated tasks all completed; no failure message surfaced.\n-- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n-- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n-\n-### Case 5: Session persistence sanity\n-- Result: **PARTIAL / FAIL**\n-- PASS: latest orchestrator run state persists across app restart.\n-- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n-\n-### Additional UAT Observation\n-- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n-- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n-\n-### UAT Status (Wave 2.1)\n-- Current UAT decision: **NO-GO** pending remediation for:\n-  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n-  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n+1. PR #2 is open: https://github.com/gannonh/kata-cloud/pull/2 (`feature/run-history-persistence` -> `main`).\n+2. This PR merge is the required gate before outsourcing additional implementation work.\n+3. After merge, sync local `main` from `origin/main` and create all new work branches from that updated `main`.\n+4. Do not stack new feature branches on top of recovery branches.\n+## Outsource Candidates And Handoffs (2026-02-17)\n+1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n+Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n+2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n+Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n+3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n+Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n+4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n+## Goal (Git Stability Incident)\n+Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n+\n+## Tasks (Git Stability Incident)\n+- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+\n+- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n+\n+- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n+\n+- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n+\n+## Acceptance Criteria (Git Stability Incident)\n+1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n+2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n+3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n+4. Independent verifier issues explicit GO before feature work resumes.\n+\n+## Non-goals (Git Stability Incident)\n+1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n+2. Rewriting the entire repository history.\n+3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n+\n+## Assumptions (Git Stability Incident)\n+1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n+2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n+3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n+\n+## Verification Plan (Git Stability Incident)\n+1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n+2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n+3. Resume feature tasks only after explicit GO is captured in `spec`.\n+\n+## Rollback Plan (Git Stability Incident)\n+1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n+2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n+3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n+\n+---\n+\n+\n+\n+## Incident Status (2026-02-17)\n+\n+1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n+2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n+3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n+4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n+5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n+6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n+7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n+8. Feature work may resume.\n+\n+## Goal (Wave 2.1 UAT Remediation)\n+Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n+\n+## Tasks (Wave 2.1 UAT Remediation)\n+- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+\n+- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+\n+- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+\n+## Acceptance Criteria (Wave 2.1 UAT Remediation)\n+1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n+2. Orchestrator run history (not latest-only) is visible and persists across restart.\n+3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n+4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+\n+## Non-goals (Wave 2.1 UAT Remediation)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Adding in-app browser preview.\n+4. Context adapter/provider integration expansion.\n+\n+## Assumptions (Wave 2.1 UAT Remediation)\n+1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n+2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n+3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n+\n+## Verification Plan (Wave 2.1 UAT Remediation)\n+1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n+2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n+3. Record final remediation GO/NO-GO in `spec` with residual risks.\n+\n+## Rollback Plan (Wave 2.1 UAT Remediation)\n+1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n+2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n+3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+\n+## Wave 2.1 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+\n+## UAT Plan (Wave 2.1)\n+\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n+\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+\n+### Case 5: Session persistence sanity\n+- Result: **PARTIAL / FAIL**\n+- PASS: latest orchestrator run state persists across app restart.\n+- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n+\n+### Additional UAT Observation\n+- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n+- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n+\n+### UAT Status (Wave 2.1)\n+- Current UAT decision: **NO-GO** pending remediation for:\n+  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n+  2. Case 5 run-history/timeline persistence gap (latest-only visibility)."}
{"type":"diff","v":43,"date":"2026-02-17T04:14:14.410Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -7 +7 @@\n-- [/] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n+- [x] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n@@ -12 +12 @@\n-- [/] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n+- [x] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n@@ -62 +62 @@\n-## Outsource Candidates And Handoffs (2026-02-17)\n-1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n-Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n-2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n-Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n-3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n-Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n-4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n-## Goal (Git Stability Incident)\n-Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n@@ -73 +63 @@\n-## Tasks (Git Stability Incident)\n-- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+## Integration Gate Result (2026-02-17)\n@@ -76 +65 @@\n-- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n-\n-- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n-\n-- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n-\n-## Acceptance Criteria (Git Stability Incident)\n-1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n-2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n-3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n-4. Independent verifier issues explicit GO before feature work resumes.\n-\n-## Non-goals (Git Stability Incident)\n-1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n-2. Rewriting the entire repository history.\n-3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n-\n-## Assumptions (Git Stability Incident)\n-1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n-2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n-3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n-\n-## Verification Plan (Git Stability Incident)\n-1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n-2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n-3. Resume feature tasks only after explicit GO is captured in `spec`.\n-\n-## Rollback Plan (Git Stability Incident)\n-1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n-2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n-3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n-\n----\n-\n-\n-\n-## Incident Status (2026-02-17)\n-\n-1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n-2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n-3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n-4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n-5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n-6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n-7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n-8. Feature work may resume.\n-\n-## Goal (Wave 2.1 UAT Remediation)\n-Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n-\n-## Tasks (Wave 2.1 UAT Remediation)\n-- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n-\n-- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n-\n-- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n-\n-## Acceptance Criteria (Wave 2.1 UAT Remediation)\n-1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n-2. Orchestrator run history (not latest-only) is visible and persists across restart.\n-3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n-4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n-\n-## Non-goals (Wave 2.1 UAT Remediation)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Adding in-app browser preview.\n-4. Context adapter/provider integration expansion.\n-\n-## Assumptions (Wave 2.1 UAT Remediation)\n-1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n-2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n-3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n-\n-## Verification Plan (Wave 2.1 UAT Remediation)\n-1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n-2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n-3. Record final remediation GO/NO-GO in `spec` with residual risks.\n-\n-## Rollback Plan (Wave 2.1 UAT Remediation)\n-1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n-2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n-3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n-\n----\n-\n-\n-## Goal (Wave 2.1 Orchestrator Planning Loop)\n-Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n-\n-## Tasks (Wave 2.1 Orchestrator Planning Loop)\n-- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n-\n-- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n-\n-- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n-\n-## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n-1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n-2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n-3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n-4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n-\n-## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Building in-app browser preview.\n-4. Integrating context adapter providers beyond current local flow.\n-\n-## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n-2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n-3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n-\n-## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n-2. Run `pnpm run desktop:typecheck` after each wave.\n-3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n-\n-## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n-2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n-3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n-\n----\n-\n-\n-\n-## Wave 2.1 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Wave 2.1 tasks are complete:\n-  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n-  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n-  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n-- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n-- Wave 2.1 acceptance criteria are satisfied:\n-  1. Prompt-triggered run lifecycle: PASS.\n-  2. Spec draft synthesis/apply path: PASS.\n-  3. Implement/Verify/Debug delegation + timeline: PASS.\n-  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n-- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n-- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n-\n-## UAT Plan (Wave 2.1)\n-\n-Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n-\n-### Preconditions\n-1. App launches in dev mode.\n-2. You are in a workspace with the `Orchestrator` view available.\n-3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n-\n-### Test Cases\n-1. Happy-path run lifecycle\n-- Action: submit a normal orchestrator prompt.\n-- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n-\n-2. Spec draft generation + apply\n-- Action: from a successful run, apply the generated draft to spec.\n-- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n-\n-3. Delegation timeline visibility\n-- Action: inspect delegated tasks for the run.\n-- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n-\n-4. Failure-path behavior\n-- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n-- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n-\n-5. Session persistence sanity\n-- Action: reopen the app/workspace after at least one successful and one failed run.\n-- Expect: orchestrator run history (including timeline/status) is still present.\n-\n-### Result Recording\n-For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n-\n-### Exit Criteria\n-- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n-- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n-\n-## Tasks (Wave 1.6 Blocker Burn-down)\n-\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [ ] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [ ] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n-\n-## UAT Results (Wave 2.1)\n-\n-### Case 1: Happy-path run lifecycle\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16):\n-  - Run reached terminal success (`Run ... is completed`).\n-  - Lifecycle shows expected progression: `queued -> running -> completed`.\n-  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n-  - Draft generation state present: `Draft: ready for run ...`.\n-\n-### Case 2: Spec draft generation + apply\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16 4:07 PM):\n-  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n-  - Apply action succeeded (`Applied draft from run ...`).\n-  - Spec Markdown/Preview panes show updated draft-derived content.\n-  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n-\n-### Case 3: Delegation timeline visibility\n-- Result: **PASS**\n-- Evidence (same UAT screenshots):\n-  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n-  - Each row shows explicit transition chain with terminal `completed` state.\n-  - Run-level lifecycle and per-task timeline information are both rendered together.\n-\n-### Case 4: Failure-path behavior\n-- Result: **FAIL**\n-- Evidence (user screenshot, 2026-02-16 4:10 PM):\n-  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n-  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n-  - Delegated tasks all completed; no failure message surfaced.\n-- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n-- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n-\n-### Case 5: Session persistence sanity\n-- Result: **PARTIAL / FAIL**\n-- PASS: latest orchestrator run state persists across app restart.\n-- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n-\n-### Additional UAT Observation\n-- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n-- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n-\n-### UAT Status (Wave 2.1)\n-- Current UAT decision: **NO-GO** pending remediation for:\n-  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n-  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n+1. PR #2 (`feature/run-history-persistence` -> `main`) merged at `2026-02-17T03:45:07Z`.\n+2. Merge commit on `main`: `1cadf1894f3a37d520c106af590ef102f8ce8f77`.\n+3. Gate is cleared: Wave 1 outsourcing can proceed.\n+4. All new work must branch from updated `main` and return via short-lived PRs.\n+\n+## Wave 1 Execution Note (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) encountered overlap with in-progress browser edits in shared workspace.\n+2. Coordinator approved isolated execution in a clean temporary worktree from updated `main` on `feature/run-history-persistence-fix`.\n+3. Task agent was re-notified and resumed with strict non-overlap constraints.\n+\n+## Wave 1 Conflict Handling (2026-02-17)\n+\n+1. Parallel file overlap occurred between browser preview and context adapter tasks on `src/shared/state.ts` and `src/shared/state.test.ts`.\n+2. Scope-separation rule applied: context task owns first-pass shared-state edits; browser task is paused for those files.\n+3. Browser task resumes on updated `main` after context task lands to avoid mixed-scope commits and preserve independent PR hygiene.\n+\n+## Wave 1 Status (2026-02-17)\n+\n+1. Browser preview task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) is implemented and currently `review_required`; automated checks passed, manual localhost clickthrough remains for verifier.\n+2. Context adapter task (`302fcffa-863d-4d90-b017-08369fad3f73`) hit branch mismatch and was corrected to continue in isolated `feature/context-adapter-foundation` flow from updated `main`.\n+3. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) remains in progress in isolated branch/worktree flow.\n+4. Wave 1 verifier delegation will start only after tasks 2 and 3 complete.\n+\n+## Wave 1 Correction (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was reopened because prior completion lacked implementation artifacts (no commit hash/test evidence/files-changed summary in task note).\n+2. Task status reset to `in_progress` and re-instruction sent for clean-branch execution with mandatory evidence before verification.\n+\n+## Wave 1 Recovery Action (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was re-delegated to replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` after repeated non-progress responses.\n+2. Browser task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) reset to `waiting` pending clean scope-separation with context shared-state edits.\n+3. Context task (`302fcffa-863d-4d90-b017-08369fad3f73`) instructed to finalize only on isolated `feature/context-adapter-foundation` with explicit artifacts.\n+\n+## Wave 1 Ownership Clarification (2026-02-17)\n+\n+Run-history replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` is designated active owner and instructed to continue without waiting on prior stalled agent assignment.\n+\n+## Wave 1 Cutover Control (2026-02-17)\n+\n+1. Repeated stale/duplicate run-history agent events triggered forced execution cutover.\n+2. Original run-history agent was instructed to stand down; replacement agent remains sole owner.\n+3. Context task switched to execute-only mode with required artifact-based completion.\n+4. Browser task remains `waiting` until context/run-history complete and verifier can evaluate cross-task integration safely.\n+\n+## Wave 1 Execution Control Update (2026-02-17)\n+\n+1. Duplicate run-history execution was re-confirmed; original agent `agent-eadf6ee1-4de3-4edc-af4b-6f70458f1a9d` was instructed again to stand down.\n+2. Replacement run-history agent `agent-e92c73d0-56ef-440e-a009-661b7c399382` remains sole owner with mandatory artifact completion requirements.\n+3. Context agent `agent-8e0a4569-29d6-44b4-ac55-5ad7f2f7baa4` was re-instructed to execute-only on isolated `feature/context-adapter-foundation` scope.\n+4. Browser task remains `waiting` until context + run-history complete and verifier wave starts.\n+\n+## Codex Outsource Queue (2026-02-17)\n+\n+1. Active: `c5f554ea-2059-40d2-9fb2-bf522a590cae` (run-history persistence)  replacement implementor executing.\n+2. Active: `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter)  implementor executing in isolated branch.\n+3. Waiting: `22770f24-a79b-4d14-9add-14ffd1447b2f` (browser preview)  resumes after context/run-history are complete and verifier starts.\n+4. Ready to outsource now: `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)  independent PR candidate from updated `main`.\n+5. Sequence after changes tab: `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR workflow).\n+\n+## Wave 1 Status Refresh (2026-02-17)\n+\n+1. `c5f554ea-2059-40d2-9fb2-bf522a590cae` now has implementation artifacts (commit `4d388ce411b3dc2b6df4591e47e67e944e7715a6`, branch `feature/run-history-persistence-fix`, required tests/typecheck pass) and is moved to `review_required`.\n+2. `302fcffa-863d-4d90-b017-08369fad3f73` is `review_required`; coordinator requested explicit commit/push evidence before verifier handoff.\n+3. `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting` until cross-task shared-state sequencing is verified.\n+4. Stale original run-history agent remains standdown-only; replacement owner output is authoritative.\n+\n+## Wave 1 Verification Start (2026-02-17)\n+\n+1. Verifier wave started for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` via verifier agent `agent-40059ba1-1b38-4d89-967a-90d02f63db38`.\n+2. Context task `302fcffa-863d-4d90-b017-08369fad3f73` is awaiting final commit/push artifact append before verifier dispatch.\n+3. Browser task remains waiting until run-history/context verification results are in.\n+## Outsource Candidates And Handoffs (2026-02-17)\n+1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n+Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n+2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n+Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n+3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n+Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n+4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n+## Goal (Git Stability Incident)\n+Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n+\n+## Tasks (Git Stability Incident)\n+- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+\n+- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n+\n+- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n+\n+- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n+\n+## Acceptance Criteria (Git Stability Incident)\n+1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n+2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n+3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n+4. Independent verifier issues explicit GO before feature work resumes.\n+\n+## Non-goals (Git Stability Incident)\n+1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n+2. Rewriting the entire repository history.\n+3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n+\n+## Assumptions (Git Stability Incident)\n+1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n+2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n+3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n+\n+## Verification Plan (Git Stability Incident)\n+1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n+2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n+3. Resume feature tasks only after explicit GO is captured in `spec`.\n+\n+## Rollback Plan (Git Stability Incident)\n+1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n+2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n+3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n+\n+---\n+\n+\n+\n+## Incident Status (2026-02-17)\n+\n+1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n+2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n+3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n+4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n+5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n+6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n+7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n+8. Feature work may resume.\n+\n+## Goal (Wave 2.1 UAT Remediation)\n+Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n+\n+## Tasks (Wave 2.1 UAT Remediation)\n+- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+\n+- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+\n+- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+\n+## Acceptance Criteria (Wave 2.1 UAT Remediation)\n+1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n+2. Orchestrator run history (not latest-only) is visible and persists across restart.\n+3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n+4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+\n+## Non-goals (Wave 2.1 UAT Remediation)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Adding in-app browser preview.\n+4. Context adapter/provider integration expansion.\n+\n+## Assumptions (Wave 2.1 UAT Remediation)\n+1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n+2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n+3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n+\n+## Verification Plan (Wave 2.1 UAT Remediation)\n+1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n+2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n+3. Record final remediation GO/NO-GO in `spec` with residual risks.\n+\n+## Rollback Plan (Wave 2.1 UAT Remediation)\n+1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n+2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n+3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+\n+## Wave 2.1 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+\n+## UAT Plan (Wave 2.1)\n+\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n+\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [/] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [/] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+\n+### Case 5: Session persistence sanity\n+- Result: **PARTIAL / FAIL**\n+- PASS: latest orchestrator run state persists across app restart.\n+- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n+\n+### Additional UAT Observation\n+- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n+- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n+\n+### UAT Status (Wave 2.1)\n+- Current UAT decision: **NO-GO** pending remediation for:\n+  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n+  2. Case 5 run-history/timeline persistence gap (latest-only visibility)."}
{"type":"diff","v":44,"date":"2026-02-17T13:52:41.607Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -2 +2 @@\n-Restore a healthy Git baseline, recover the pre-reset feature work, and resume implementation from a clean, pushable branch.\n+Close Wave 1 by verifying completed implementation tasks, unblocking the browser follow-up, and preparing a clean handoff package for your external outsourcing step.\n@@ -5 +5 @@\n-- [x] [Recover pre-reset work into current workspace](intent://local/task/7a006ca5-e5df-4dfd-8134-70db25f8203c)\n+- [ ] [Verify and close run-history task](intent://local/task/374e17d5-6ac8-42ff-b943-66026957a892)\n@@ -7 +7 @@\n-- [x] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n+- [ ] [Verify and close context-adapter task](intent://local/task/76dd55a0-e87d-4fc5-82bc-7878efc81bd5)\n@@ -9 +9 @@\n-- [/] [Outsource independent PR work and resume primary feature](intent://local/task/d7a5cef2-5289-444a-a5b7-21822d012663)\n+- [ ] [Resolve browser-task sequencing and next action](intent://local/task/14bc6806-c210-44a3-8acc-ebca2014ea78)\n@@ -11 +11 @@\n+- [ ] [Prepare external-outsource handoff package](intent://local/task/1ce25d50-a2ee-49ca-9f11-aae1f2869ad5)\n@@ -12 +13 @@\n-- [x] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n@@ -14 +14 @@\n-1. Pre-reset work is restored into the active workspace branch without data loss.\n-2. Git health checks pass with no garbage warnings or invalid refs.\n-3. Required stale session artifacts are cleaned locally/remotely without deleting active branches.\n-4. At least one feature task is actively resumed with clear delegation.\n-5. Outsourceable PR candidates and handoffs are documented.\n-\n-## Non-goals\n-1. Rewriting published `main` history.\n-2. Deleting non-session branches without explicit approval.\n-3. Bundling all remaining feature work into one large PR.\n-\n-## Assumptions\n-1. We should restore the full pre-reset branch tip (`fe3e028e5b5e7d7d273e011d5ae7e5483640b94c`) (confirm?).\n-2. Remote cleanup may delete only session branches (`codex/*`, `git-stability-incident`, `unblock-wave-1-verification`) (confirm?).\n-3. Highest-priority resume target remains run-history persistence (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) (confirm?).\n-\n-## Verification Plan\n-1. Run recovery and Git-health commands from Task 1 and Task 2.\n-2. Validate push capability from the recovered branch.\n-3. Verify spec includes outsourcing handoffs and delegated resume task.\n-\n-## Rollback Plan\n-1. If the recovery branch is wrong, delete only the recovery branch and refetch from backup path.\n-2. If cleanup removes a needed branch, recreate from backup SHA and restore the remote ref.\n-3. If push fails, use documented fresh-clone fallback without changing recovered branch content.\n-\n-\n-\n-\n-## Recovery Checkpoint (2026-02-17)\n-\n-1. Git branch tracking is now healthy on the active branch: `feature/run-history-persistence...origin/feature/run-history-persistence`.\n-2. Recovery content exists on remote at `origin/feature/run-history-persistence` -> `be71982fc9e214b689eb529d3e9b2cb1f4d9b99c`.\n-3. Local Git health checks remain clean (`garbage: 0`, no invalid-ref errors).\n-4. Stale `origin/codex/*` branches used during incident handling were removed.\n-5. Residual risk: direct large-pack pushes still intermittently fail with remote unpack/inflate errors; fallback publish path is the current mitigation.\n-\n-\n-## Branch Protection Update (2026-02-17)\n-\n-Direct pushes to `main` are blocked by repository rules (`GH013`); integration to `main` must go through pull requests. Effective workflow: continue work on feature branches, open PRs targeting `main`, merge via GitHub, then sync local `main` from `origin/main`. This replaces any direct-push-to-main assumption.\n-\n-## Integration Gate (2026-02-17)\n-\n-1. PR #2 is open: https://github.com/gannonh/kata-cloud/pull/2 (`feature/run-history-persistence` -> `main`).\n-2. This PR merge is the required gate before outsourcing additional implementation work.\n-3. After merge, sync local `main` from `origin/main` and create all new work branches from that updated `main`.\n-4. Do not stack new feature branches on top of recovery branches.\n-\n-## Integration Gate Result (2026-02-17)\n-\n-1. PR #2 (`feature/run-history-persistence` -> `main`) merged at `2026-02-17T03:45:07Z`.\n-2. Merge commit on `main`: `1cadf1894f3a37d520c106af590ef102f8ce8f77`.\n-3. Gate is cleared: Wave 1 outsourcing can proceed.\n-4. All new work must branch from updated `main` and return via short-lived PRs.\n-\n-## Wave 1 Execution Note (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) encountered overlap with in-progress browser edits in shared workspace.\n-2. Coordinator approved isolated execution in a clean temporary worktree from updated `main` on `feature/run-history-persistence-fix`.\n-3. Task agent was re-notified and resumed with strict non-overlap constraints.\n-\n-## Wave 1 Conflict Handling (2026-02-17)\n-\n-1. Parallel file overlap occurred between browser preview and context adapter tasks on `src/shared/state.ts` and `src/shared/state.test.ts`.\n-2. Scope-separation rule applied: context task owns first-pass shared-state edits; browser task is paused for those files.\n-3. Browser task resumes on updated `main` after context task lands to avoid mixed-scope commits and preserve independent PR hygiene.\n-\n-## Wave 1 Status (2026-02-17)\n-\n-1. Browser preview task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) is implemented and currently `review_required`; automated checks passed, manual localhost clickthrough remains for verifier.\n-2. Context adapter task (`302fcffa-863d-4d90-b017-08369fad3f73`) hit branch mismatch and was corrected to continue in isolated `feature/context-adapter-foundation` flow from updated `main`.\n-3. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) remains in progress in isolated branch/worktree flow.\n-4. Wave 1 verifier delegation will start only after tasks 2 and 3 complete.\n-\n-## Wave 1 Correction (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was reopened because prior completion lacked implementation artifacts (no commit hash/test evidence/files-changed summary in task note).\n-2. Task status reset to `in_progress` and re-instruction sent for clean-branch execution with mandatory evidence before verification.\n-\n-## Wave 1 Recovery Action (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was re-delegated to replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` after repeated non-progress responses.\n-2. Browser task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) reset to `waiting` pending clean scope-separation with context shared-state edits.\n-3. Context task (`302fcffa-863d-4d90-b017-08369fad3f73`) instructed to finalize only on isolated `feature/context-adapter-foundation` with explicit artifacts.\n-\n-## Wave 1 Ownership Clarification (2026-02-17)\n-\n-Run-history replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` is designated active owner and instructed to continue without waiting on prior stalled agent assignment.\n-\n-## Wave 1 Cutover Control (2026-02-17)\n-\n-1. Repeated stale/duplicate run-history agent events triggered forced execution cutover.\n-2. Original run-history agent was instructed to stand down; replacement agent remains sole owner.\n-3. Context task switched to execute-only mode with required artifact-based completion.\n-4. Browser task remains `waiting` until context/run-history complete and verifier can evaluate cross-task integration safely.\n-\n-## Wave 1 Execution Control Update (2026-02-17)\n-\n-1. Duplicate run-history execution was re-confirmed; original agent `agent-eadf6ee1-4de3-4edc-af4b-6f70458f1a9d` was instructed again to stand down.\n-2. Replacement run-history agent `agent-e92c73d0-56ef-440e-a009-661b7c399382` remains sole owner with mandatory artifact completion requirements.\n-3. Context agent `agent-8e0a4569-29d6-44b4-ac55-5ad7f2f7baa4` was re-instructed to execute-only on isolated `feature/context-adapter-foundation` scope.\n-4. Browser task remains `waiting` until context + run-history complete and verifier wave starts.\n-\n-## Codex Outsource Queue (2026-02-17)\n-\n-1. Active: `c5f554ea-2059-40d2-9fb2-bf522a590cae` (run-history persistence)  replacement implementor executing.\n-2. Active: `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter)  implementor executing in isolated branch.\n-3. Waiting: `22770f24-a79b-4d14-9add-14ffd1447b2f` (browser preview)  resumes after context/run-history are complete and verifier starts.\n-4. Ready to outsource now: `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)  independent PR candidate from updated `main`.\n-5. Sequence after changes tab: `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR workflow).\n-\n-## Wave 1 Status Refresh (2026-02-17)\n-\n-1. `c5f554ea-2059-40d2-9fb2-bf522a590cae` now has implementation artifacts (commit `4d388ce411b3dc2b6df4591e47e67e944e7715a6`, branch `feature/run-history-persistence-fix`, required tests/typecheck pass) and is moved to `review_required`.\n-2. `302fcffa-863d-4d90-b017-08369fad3f73` is `review_required`; coordinator requested explicit commit/push evidence before verifier handoff.\n-3. `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting` until cross-task shared-state sequencing is verified.\n-4. Stale original run-history agent remains standdown-only; replacement owner output is authoritative.\n-\n-## Wave 1 Verification Start (2026-02-17)\n-\n-1. Verifier wave started for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` via verifier agent `agent-40059ba1-1b38-4d89-967a-90d02f63db38`.\n-2. Context task `302fcffa-863d-4d90-b017-08369fad3f73` is awaiting final commit/push artifact append before verifier dispatch.\n-3. Browser task remains waiting until run-history/context verification results are in.\n-## Outsource Candidates And Handoffs (2026-02-17)\n-1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n-Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n-2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n-Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n-3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n-Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n-4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n-## Goal (Git Stability Incident)\n-Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n-\n-## Tasks (Git Stability Incident)\n-- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n-\n-- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n-\n-- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n-\n-- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n-\n-## Acceptance Criteria (Git Stability Incident)\n-1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n-2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n-3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n-4. Independent verifier issues explicit GO before feature work resumes.\n-\n-## Non-goals (Git Stability Incident)\n-1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n-2. Rewriting the entire repository history.\n-3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n-\n-## Assumptions (Git Stability Incident)\n-1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n-2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n-3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n-\n-## Verification Plan (Git Stability Incident)\n-1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n-2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n-3. Resume feature tasks only after explicit GO is captured in `spec`.\n-\n-## Rollback Plan (Git Stability Incident)\n-1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n-2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n-3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n-\n----\n-\n-\n-\n-## Incident Status (2026-02-17)\n-\n-1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n-2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n-3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n-4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n-5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n-6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n-7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n-8. Feature work may resume.\n-\n-## Goal (Wave 2.1 UAT Remediation)\n-Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n-\n-## Tasks (Wave 2.1 UAT Remediation)\n-- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n-\n-- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n-\n-- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n-\n-## Acceptance Criteria (Wave 2.1 UAT Remediation)\n-1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n-2. Orchestrator run history (not latest-only) is visible and persists across restart.\n-3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n-4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n-\n-## Non-goals (Wave 2.1 UAT Remediation)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Adding in-app browser preview.\n-4. Context adapter/provider integration expansion.\n-\n-## Assumptions (Wave 2.1 UAT Remediation)\n-1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n-2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n-3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n-\n-## Verification Plan (Wave 2.1 UAT Remediation)\n-1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n-2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n-3. Record final remediation GO/NO-GO in `spec` with residual risks.\n-\n-## Rollback Plan (Wave 2.1 UAT Remediation)\n-1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n-2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n-3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n-\n----\n-\n-\n-## Goal (Wave 2.1 Orchestrator Planning Loop)\n-Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n-\n-## Tasks (Wave 2.1 Orchestrator Planning Loop)\n-- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n-\n-- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n-\n-- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n-\n-## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n-1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n-2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n-3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n-4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n-\n-## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Building in-app browser preview.\n-4. Integrating context adapter providers beyond current local flow.\n-\n-## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n-2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n-3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n-\n-## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n-2. Run `pnpm run desktop:typecheck` after each wave.\n-3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n-\n-## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n-2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n-3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n-\n----\n-\n-\n-\n-## Wave 2.1 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Wave 2.1 tasks are complete:\n-  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n-  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n-  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n-- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n-- Wave 2.1 acceptance criteria are satisfied:\n-  1. Prompt-triggered run lifecycle: PASS.\n-  2. Spec draft synthesis/apply path: PASS.\n-  3. Implement/Verify/Debug delegation + timeline: PASS.\n-  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n-- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n-- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n-\n-## UAT Plan (Wave 2.1)\n-\n-Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n-\n-### Preconditions\n-1. App launches in dev mode.\n-2. You are in a workspace with the `Orchestrator` view available.\n-3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n-\n-### Test Cases\n-1. Happy-path run lifecycle\n-- Action: submit a normal orchestrator prompt.\n-- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n-\n-2. Spec draft generation + apply\n-- Action: from a successful run, apply the generated draft to spec.\n-- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n-\n-3. Delegation timeline visibility\n-- Action: inspect delegated tasks for the run.\n-- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n-\n-4. Failure-path behavior\n-- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n-- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n-\n-5. Session persistence sanity\n-- Action: reopen the app/workspace after at least one successful and one failed run.\n-- Expect: orchestrator run history (including timeline/status) is still present.\n-\n-### Result Recording\n-For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n-\n-### Exit Criteria\n-- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n-- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n-\n-## Tasks (Wave 1.6 Blocker Burn-down)\n-\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [/] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [/] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n-\n-## UAT Results (Wave 2.1)\n-\n-### Case 1: Happy-path run lifecycle\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16):\n-  - Run reached terminal success (`Run ... is completed`).\n-  - Lifecycle shows expected progression: `queued -> running -> completed`.\n-  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n-  - Draft generation state present: `Draft: ready for run ...`.\n-\n-### Case 2: Spec draft generation + apply\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16 4:07 PM):\n-  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n-  - Apply action succeeded (`Applied draft from run ...`).\n-  - Spec Markdown/Preview panes show updated draft-derived content.\n-  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n-\n-### Case 3: Delegation timeline visibility\n-- Result: **PASS**\n-- Evidence (same UAT screenshots):\n-  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n-  - Each row shows explicit transition chain with terminal `completed` state.\n-  - Run-level lifecycle and per-task timeline information are both rendered together.\n-\n-### Case 4: Failure-path behavior\n-- Result: **FAIL**\n-- Evidence (user screenshot, 2026-02-16 4:10 PM):\n-  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n-  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n-  - Delegated tasks all completed; no failure message surfaced.\n-- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n-- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n-\n-### Case 5: Session persistence sanity\n-- Result: **PARTIAL / FAIL**\n-- PASS: latest orchestrator run state persists across app restart.\n-- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n-\n-### Additional UAT Observation\n-- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n-- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n-\n-### UAT Status (Wave 2.1)\n-- Current UAT decision: **NO-GO** pending remediation for:\n-  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n-  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n+1. Run-history and context tasks both receive verifier outcomes with explicit GO/NO-GO.\n+2. Browser task state is unambiguous (resumed with prerequisites met or explicitly blocked).\n+3. External handoff instructions are ready for you to use immediately.\n+4. Spec reflects the current source of truth for task states and next actions.\n+\n+## Non-goals\n+1. Implementing new feature code in this coordination pass.\n+2. Changing historical notes outside status/result corrections.\n+3. Performing external outsourcing actions directly.\n+\n+## Assumptions\n+1. External outsourcing execution is handled by you, not by in-system agents.\n+2. Existing implementation evidence in run-history/context notes is substantially complete and needs verification closure.\n+3. Browser task sequencing depends on confirmed closure of context/run-history verification (confirm?).\n+\n+## Verification Plan\n+1. Delegate verifier for run-history task and record result.\n+2. Ensure context task artifact completeness, then delegate verifier and record result.\n+3. Reconcile browser-task status based on verifier outputs.\n+4. Deliver explicit external handoff instructions for changes-tab then PR-workflow tasks.\n+\n+## Rollback Plan\n+1. If verifier returns NO-GO, revert task status from `review_required/complete` to `in_progress`.\n+2. Add remediation items to the relevant task note and spec.\n+3. Re-run verification only after remediation evidence is posted.\n+\n+## Goal\n+Restore a healthy Git baseline, recover the pre-reset feature work, and resume implementation from a clean, pushable branch.\n+\n+## Tasks\n+- [x] [Recover pre-reset work into current workspace](intent://local/task/7a006ca5-e5df-4dfd-8134-70db25f8203c)\n+\n+- [x] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n+\n+- [/] [Outsource independent PR work and resume primary feature](intent://local/task/d7a5cef2-5289-444a-a5b7-21822d012663)\n+\n+\n+- [x] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n+## Acceptance Criteria\n+1. Pre-reset work is restored into the active workspace branch without data loss.\n+2. Git health checks pass with no garbage warnings or invalid refs.\n+3. Required stale session artifacts are cleaned locally/remotely without deleting active branches.\n+4. At least one feature task is actively resumed with clear delegation.\n+5. Outsourceable PR candidates and handoffs are documented.\n+\n+## Non-goals\n+1. Rewriting published `main` history.\n+2. Deleting non-session branches without explicit approval.\n+3. Bundling all remaining feature work into one large PR.\n+\n+## Assumptions\n+1. We should restore the full pre-reset branch tip (`fe3e028e5b5e7d7d273e011d5ae7e5483640b94c`) (confirm?).\n+2. Remote cleanup may delete only session branches (`codex/*`, `git-stability-incident`, `unblock-wave-1-verification`) (confirm?).\n+3. Highest-priority resume target remains run-history persistence (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) (confirm?).\n+\n+## Verification Plan\n+1. Run recovery and Git-health commands from Task 1 and Task 2.\n+2. Validate push capability from the recovered branch.\n+3. Verify spec includes outsourcing handoffs and delegated resume task.\n+\n+## Rollback Plan\n+1. If the recovery branch is wrong, delete only the recovery branch and refetch from backup path.\n+2. If cleanup removes a needed branch, recreate from backup SHA and restore the remote ref.\n+3. If push fails, use documented fresh-clone fallback without changing recovered branch content.\n+\n+\n+\n+\n+## Recovery Checkpoint (2026-02-17)\n+\n+1. Git branch tracking is now healthy on the active branch: `feature/run-history-persistence...origin/feature/run-history-persistence`.\n+2. Recovery content exists on remote at `origin/feature/run-history-persistence` -> `be71982fc9e214b689eb529d3e9b2cb1f4d9b99c`.\n+3. Local Git health checks remain clean (`garbage: 0`, no invalid-ref errors).\n+4. Stale `origin/codex/*` branches used during incident handling were removed.\n+5. Residual risk: direct large-pack pushes still intermittently fail with remote unpack/inflate errors; fallback publish path is the current mitigation.\n+\n+\n+## Branch Protection Update (2026-02-17)\n+\n+Direct pushes to `main` are blocked by repository rules (`GH013`); integration to `main` must go through pull requests. Effective workflow: continue work on feature branches, open PRs targeting `main`, merge via GitHub, then sync local `main` from `origin/main`. This replaces any direct-push-to-main assumption.\n+\n+## Integration Gate (2026-02-17)\n+\n+1. PR #2 is open: https://github.com/gannonh/kata-cloud/pull/2 (`feature/run-history-persistence` -> `main`).\n+2. This PR merge is the required gate before outsourcing additional implementation work.\n+3. After merge, sync local `main` from `origin/main` and create all new work branches from that updated `main`.\n+4. Do not stack new feature branches on top of recovery branches.\n+\n+## Integration Gate Result (2026-02-17)\n+\n+1. PR #2 (`feature/run-history-persistence` -> `main`) merged at `2026-02-17T03:45:07Z`.\n+2. Merge commit on `main`: `1cadf1894f3a37d520c106af590ef102f8ce8f77`.\n+3. Gate is cleared: Wave 1 outsourcing can proceed.\n+4. All new work must branch from updated `main` and return via short-lived PRs.\n+\n+## Wave 1 Execution Note (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) encountered overlap with in-progress browser edits in shared workspace.\n+2. Coordinator approved isolated execution in a clean temporary worktree from updated `main` on `feature/run-history-persistence-fix`.\n+3. Task agent was re-notified and resumed with strict non-overlap constraints.\n+\n+## Wave 1 Conflict Handling (2026-02-17)\n+\n+1. Parallel file overlap occurred between browser preview and context adapter tasks on `src/shared/state.ts` and `src/shared/state.test.ts`.\n+2. Scope-separation rule applied: context task owns first-pass shared-state edits; browser task is paused for those files.\n+3. Browser task resumes on updated `main` after context task lands to avoid mixed-scope commits and preserve independent PR hygiene.\n+\n+## Wave 1 Status (2026-02-17)\n+\n+1. Browser preview task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) is implemented and currently `review_required`; automated checks passed, manual localhost clickthrough remains for verifier.\n+2. Context adapter task (`302fcffa-863d-4d90-b017-08369fad3f73`) hit branch mismatch and was corrected to continue in isolated `feature/context-adapter-foundation` flow from updated `main`.\n+3. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) remains in progress in isolated branch/worktree flow.\n+4. Wave 1 verifier delegation will start only after tasks 2 and 3 complete.\n+\n+## Wave 1 Correction (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was reopened because prior completion lacked implementation artifacts (no commit hash/test evidence/files-changed summary in task note).\n+2. Task status reset to `in_progress` and re-instruction sent for clean-branch execution with mandatory evidence before verification.\n+\n+## Wave 1 Recovery Action (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was re-delegated to replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` after repeated non-progress responses.\n+2. Browser task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) reset to `waiting` pending clean scope-separation with context shared-state edits.\n+3. Context task (`302fcffa-863d-4d90-b017-08369fad3f73`) instructed to finalize only on isolated `feature/context-adapter-foundation` with explicit artifacts.\n+\n+## Wave 1 Ownership Clarification (2026-02-17)\n+\n+Run-history replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` is designated active owner and instructed to continue without waiting on prior stalled agent assignment.\n+\n+## Wave 1 Cutover Control (2026-02-17)\n+\n+1. Repeated stale/duplicate run-history agent events triggered forced execution cutover.\n+2. Original run-history agent was instructed to stand down; replacement agent remains sole owner.\n+3. Context task switched to execute-only mode with required artifact-based completion.\n+4. Browser task remains `waiting` until context/run-history complete and verifier can evaluate cross-task integration safely.\n+\n+## Wave 1 Execution Control Update (2026-02-17)\n+\n+1. Duplicate run-history execution was re-confirmed; original agent `agent-eadf6ee1-4de3-4edc-af4b-6f70458f1a9d` was instructed again to stand down.\n+2. Replacement run-history agent `agent-e92c73d0-56ef-440e-a009-661b7c399382` remains sole owner with mandatory artifact completion requirements.\n+3. Context agent `agent-8e0a4569-29d6-44b4-ac55-5ad7f2f7baa4` was re-instructed to execute-only on isolated `feature/context-adapter-foundation` scope.\n+4. Browser task remains `waiting` until context + run-history complete and verifier wave starts.\n+\n+## Codex Outsource Queue (2026-02-17)\n+\n+1. Active: `c5f554ea-2059-40d2-9fb2-bf522a590cae` (run-history persistence)  replacement implementor executing.\n+2. Active: `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter)  implementor executing in isolated branch.\n+3. Waiting: `22770f24-a79b-4d14-9add-14ffd1447b2f` (browser preview)  resumes after context/run-history are complete and verifier starts.\n+4. Ready to outsource now: `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)  independent PR candidate from updated `main`.\n+5. Sequence after changes tab: `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR workflow).\n+\n+## Wave 1 Status Refresh (2026-02-17)\n+\n+1. `c5f554ea-2059-40d2-9fb2-bf522a590cae` now has implementation artifacts (commit `4d388ce411b3dc2b6df4591e47e67e944e7715a6`, branch `feature/run-history-persistence-fix`, required tests/typecheck pass) and is moved to `review_required`.\n+2. `302fcffa-863d-4d90-b017-08369fad3f73` is `review_required`; coordinator requested explicit commit/push evidence before verifier handoff.\n+3. `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting` until cross-task shared-state sequencing is verified.\n+4. Stale original run-history agent remains standdown-only; replacement owner output is authoritative.\n+\n+## Wave 1 Verification Start (2026-02-17)\n+\n+1. Verifier wave started for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` via verifier agent `agent-40059ba1-1b38-4d89-967a-90d02f63db38`.\n+2. Context task `302fcffa-863d-4d90-b017-08369fad3f73` is awaiting final commit/push artifact append before verifier dispatch.\n+3. Browser task remains waiting until run-history/context verification results are in.\n+## Outsource Candidates And Handoffs (2026-02-17)\n+1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n+Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n+2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n+Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n+3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n+Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n+4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n+## Goal (Git Stability Incident)\n+Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n+\n+## Tasks (Git Stability Incident)\n+- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+\n+- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n+\n+- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n+\n+- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n+\n+## Acceptance Criteria (Git Stability Incident)\n+1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n+2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n+3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n+4. Independent verifier issues explicit GO before feature work resumes.\n+\n+## Non-goals (Git Stability Incident)\n+1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n+2. Rewriting the entire repository history.\n+3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n+\n+## Assumptions (Git Stability Incident)\n+1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n+2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n+3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n+\n+## Verification Plan (Git Stability Incident)\n+1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n+2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n+3. Resume feature tasks only after explicit GO is captured in `spec`.\n+\n+## Rollback Plan (Git Stability Incident)\n+1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n+2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n+3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n+\n+---\n+\n+\n+\n+## Incident Status (2026-02-17)\n+\n+1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n+2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n+3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n+4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n+5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n+6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n+7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n+8. Feature work may resume.\n+\n+## Goal (Wave 2.1 UAT Remediation)\n+Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n+\n+## Tasks (Wave 2.1 UAT Remediation)\n+- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+\n+- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+\n+- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+\n+## Acceptance Criteria (Wave 2.1 UAT Remediation)\n+1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n+2. Orchestrator run history (not latest-only) is visible and persists across restart.\n+3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n+4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+\n+## Non-goals (Wave 2.1 UAT Remediation)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Adding in-app browser preview.\n+4. Context adapter/provider integration expansion.\n+\n+## Assumptions (Wave 2.1 UAT Remediation)\n+1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n+2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n+3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n+\n+## Verification Plan (Wave 2.1 UAT Remediation)\n+1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n+2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n+3. Record final remediation GO/NO-GO in `spec` with residual risks.\n+\n+## Rollback Plan (Wave 2.1 UAT Remediation)\n+1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n+2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n+3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+\n+## Wave 2.1 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+\n+## UAT Plan (Wave 2.1)\n+\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n+\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [/] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [/] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+\n+### Case 5: Session persistence sanity\n+- Result: **PARTIAL / FAIL**\n+- PASS: latest orchestrator run state persists across app restart.\n+- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n+\n+### Additional UAT Observation\n+- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n+- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n+\n+### UAT Status (Wave 2.1)\n+- Current UAT decision: **NO-GO** pending remediation for:\n+  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n+  2. Case 5 run-history/timeline persistence gap (latest-only visibility)."}
{"type":"diff","v":45,"date":"2026-02-17T13:57:57.533Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -649 +649 @@\n+\n+## Context Adapter Closure Check (2026-02-17)\n+\n+Task `302fcffa-863d-4d90-b017-08369fad3f73` is **NO-GO** for verifier wave. Closure audit found missing commit/push evidence and no remote head for `feature/context-adapter-foundation`; current branch state shows uncommitted context files. Recommended status remains `in_progress` until commit/push/remote-ref and test-output artifacts are attached in the task note."}
{"type":"diff","v":46,"date":"2026-02-17T14:21:39.358Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -9 +9 @@\n-- [ ] [Resolve browser-task sequencing and next action](intent://local/task/14bc6806-c210-44a3-8acc-ebca2014ea78)\n+- [x] [Resolve browser-task sequencing and next action](intent://local/task/14bc6806-c210-44a3-8acc-ebca2014ea78)\n@@ -40 +40 @@\n-## Goal\n-Restore a healthy Git baseline, recover the pre-reset feature work, and resume implementation from a clean, pushable branch.\n@@ -43 +41 @@\n-## Tasks\n-- [x] [Recover pre-reset work into current workspace](intent://local/task/7a006ca5-e5df-4dfd-8134-70db25f8203c)\n+## Stall Recovery Status (2026-02-17)\n@@ -46 +43 @@\n-- [x] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n-\n-- [/] [Outsource independent PR work and resume primary feature](intent://local/task/d7a5cef2-5289-444a-a5b7-21822d012663)\n-\n-\n-- [x] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n-## Acceptance Criteria\n-1. Pre-reset work is restored into the active workspace branch without data loss.\n-2. Git health checks pass with no garbage warnings or invalid refs.\n-3. Required stale session artifacts are cleaned locally/remotely without deleting active branches.\n-4. At least one feature task is actively resumed with clear delegation.\n-5. Outsourceable PR candidates and handoffs are documented.\n-\n-## Non-goals\n-1. Rewriting published `main` history.\n-2. Deleting non-session branches without explicit approval.\n-3. Bundling all remaining feature work into one large PR.\n-\n-## Assumptions\n-1. We should restore the full pre-reset branch tip (`fe3e028e5b5e7d7d273e011d5ae7e5483640b94c`) (confirm?).\n-2. Remote cleanup may delete only session branches (`codex/*`, `git-stability-incident`, `unblock-wave-1-verification`) (confirm?).\n-3. Highest-priority resume target remains run-history persistence (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) (confirm?).\n-\n-## Verification Plan\n-1. Run recovery and Git-health commands from Task 1 and Task 2.\n-2. Validate push capability from the recovered branch.\n-3. Verify spec includes outsourcing handoffs and delegated resume task.\n-\n-## Rollback Plan\n-1. If the recovery branch is wrong, delete only the recovery branch and refetch from backup path.\n-2. If cleanup removes a needed branch, recreate from backup SHA and restore the remote ref.\n-3. If push fails, use documented fresh-clone fallback without changing recovered branch content.\n-\n-\n-\n-\n-## Recovery Checkpoint (2026-02-17)\n-\n-1. Git branch tracking is now healthy on the active branch: `feature/run-history-persistence...origin/feature/run-history-persistence`.\n-2. Recovery content exists on remote at `origin/feature/run-history-persistence` -> `be71982fc9e214b689eb529d3e9b2cb1f4d9b99c`.\n-3. Local Git health checks remain clean (`garbage: 0`, no invalid-ref errors).\n-4. Stale `origin/codex/*` branches used during incident handling were removed.\n-5. Residual risk: direct large-pack pushes still intermittently fail with remote unpack/inflate errors; fallback publish path is the current mitigation.\n-\n-\n-## Branch Protection Update (2026-02-17)\n-\n-Direct pushes to `main` are blocked by repository rules (`GH013`); integration to `main` must go through pull requests. Effective workflow: continue work on feature branches, open PRs targeting `main`, merge via GitHub, then sync local `main` from `origin/main`. This replaces any direct-push-to-main assumption.\n-\n-## Integration Gate (2026-02-17)\n-\n-1. PR #2 is open: https://github.com/gannonh/kata-cloud/pull/2 (`feature/run-history-persistence` -> `main`).\n-2. This PR merge is the required gate before outsourcing additional implementation work.\n-3. After merge, sync local `main` from `origin/main` and create all new work branches from that updated `main`.\n-4. Do not stack new feature branches on top of recovery branches.\n-\n-## Integration Gate Result (2026-02-17)\n-\n-1. PR #2 (`feature/run-history-persistence` -> `main`) merged at `2026-02-17T03:45:07Z`.\n-2. Merge commit on `main`: `1cadf1894f3a37d520c106af590ef102f8ce8f77`.\n-3. Gate is cleared: Wave 1 outsourcing can proceed.\n-4. All new work must branch from updated `main` and return via short-lived PRs.\n-\n-## Wave 1 Execution Note (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) encountered overlap with in-progress browser edits in shared workspace.\n-2. Coordinator approved isolated execution in a clean temporary worktree from updated `main` on `feature/run-history-persistence-fix`.\n-3. Task agent was re-notified and resumed with strict non-overlap constraints.\n-\n-## Wave 1 Conflict Handling (2026-02-17)\n-\n-1. Parallel file overlap occurred between browser preview and context adapter tasks on `src/shared/state.ts` and `src/shared/state.test.ts`.\n-2. Scope-separation rule applied: context task owns first-pass shared-state edits; browser task is paused for those files.\n-3. Browser task resumes on updated `main` after context task lands to avoid mixed-scope commits and preserve independent PR hygiene.\n-\n-## Wave 1 Status (2026-02-17)\n-\n-1. Browser preview task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) is implemented and currently `review_required`; automated checks passed, manual localhost clickthrough remains for verifier.\n-2. Context adapter task (`302fcffa-863d-4d90-b017-08369fad3f73`) hit branch mismatch and was corrected to continue in isolated `feature/context-adapter-foundation` flow from updated `main`.\n-3. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) remains in progress in isolated branch/worktree flow.\n-4. Wave 1 verifier delegation will start only after tasks 2 and 3 complete.\n-\n-## Wave 1 Correction (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was reopened because prior completion lacked implementation artifacts (no commit hash/test evidence/files-changed summary in task note).\n-2. Task status reset to `in_progress` and re-instruction sent for clean-branch execution with mandatory evidence before verification.\n-\n-## Wave 1 Recovery Action (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was re-delegated to replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` after repeated non-progress responses.\n-2. Browser task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) reset to `waiting` pending clean scope-separation with context shared-state edits.\n-3. Context task (`302fcffa-863d-4d90-b017-08369fad3f73`) instructed to finalize only on isolated `feature/context-adapter-foundation` with explicit artifacts.\n-\n-## Wave 1 Ownership Clarification (2026-02-17)\n-\n-Run-history replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` is designated active owner and instructed to continue without waiting on prior stalled agent assignment.\n-\n-## Wave 1 Cutover Control (2026-02-17)\n-\n-1. Repeated stale/duplicate run-history agent events triggered forced execution cutover.\n-2. Original run-history agent was instructed to stand down; replacement agent remains sole owner.\n-3. Context task switched to execute-only mode with required artifact-based completion.\n-4. Browser task remains `waiting` until context/run-history complete and verifier can evaluate cross-task integration safely.\n-\n-## Wave 1 Execution Control Update (2026-02-17)\n-\n-1. Duplicate run-history execution was re-confirmed; original agent `agent-eadf6ee1-4de3-4edc-af4b-6f70458f1a9d` was instructed again to stand down.\n-2. Replacement run-history agent `agent-e92c73d0-56ef-440e-a009-661b7c399382` remains sole owner with mandatory artifact completion requirements.\n-3. Context agent `agent-8e0a4569-29d6-44b4-ac55-5ad7f2f7baa4` was re-instructed to execute-only on isolated `feature/context-adapter-foundation` scope.\n-4. Browser task remains `waiting` until context + run-history complete and verifier wave starts.\n-\n-## Codex Outsource Queue (2026-02-17)\n-\n-1. Active: `c5f554ea-2059-40d2-9fb2-bf522a590cae` (run-history persistence)  replacement implementor executing.\n-2. Active: `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter)  implementor executing in isolated branch.\n-3. Waiting: `22770f24-a79b-4d14-9add-14ffd1447b2f` (browser preview)  resumes after context/run-history are complete and verifier starts.\n-4. Ready to outsource now: `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)  independent PR candidate from updated `main`.\n-5. Sequence after changes tab: `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR workflow).\n-\n-## Wave 1 Status Refresh (2026-02-17)\n-\n-1. `c5f554ea-2059-40d2-9fb2-bf522a590cae` now has implementation artifacts (commit `4d388ce411b3dc2b6df4591e47e67e944e7715a6`, branch `feature/run-history-persistence-fix`, required tests/typecheck pass) and is moved to `review_required`.\n-2. `302fcffa-863d-4d90-b017-08369fad3f73` is `review_required`; coordinator requested explicit commit/push evidence before verifier handoff.\n-3. `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting` until cross-task shared-state sequencing is verified.\n-4. Stale original run-history agent remains standdown-only; replacement owner output is authoritative.\n-\n-## Wave 1 Verification Start (2026-02-17)\n-\n-1. Verifier wave started for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` via verifier agent `agent-40059ba1-1b38-4d89-967a-90d02f63db38`.\n-2. Context task `302fcffa-863d-4d90-b017-08369fad3f73` is awaiting final commit/push artifact append before verifier dispatch.\n-3. Browser task remains waiting until run-history/context verification results are in.\n-## Outsource Candidates And Handoffs (2026-02-17)\n-1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n-Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n-2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n-Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n-3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n-Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n-4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n-## Goal (Git Stability Incident)\n-Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n-\n-## Tasks (Git Stability Incident)\n-- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n-\n-- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n-\n-- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n-\n-- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n-\n-## Acceptance Criteria (Git Stability Incident)\n-1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n-2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n-3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n-4. Independent verifier issues explicit GO before feature work resumes.\n-\n-## Non-goals (Git Stability Incident)\n-1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n-2. Rewriting the entire repository history.\n-3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n-\n-## Assumptions (Git Stability Incident)\n-1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n-2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n-3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n-\n-## Verification Plan (Git Stability Incident)\n-1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n-2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n-3. Resume feature tasks only after explicit GO is captured in `spec`.\n-\n-## Rollback Plan (Git Stability Incident)\n-1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n-2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n-3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n-\n----\n-\n-\n-\n-## Incident Status (2026-02-17)\n-\n-1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n-2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n-3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n-4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n-5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n-6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n-7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n-8. Feature work may resume.\n-\n-## Goal (Wave 2.1 UAT Remediation)\n-Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n-\n-## Tasks (Wave 2.1 UAT Remediation)\n-- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n-\n-- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n-\n-- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n-\n-## Acceptance Criteria (Wave 2.1 UAT Remediation)\n-1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n-2. Orchestrator run history (not latest-only) is visible and persists across restart.\n-3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n-4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n-\n-## Non-goals (Wave 2.1 UAT Remediation)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Adding in-app browser preview.\n-4. Context adapter/provider integration expansion.\n-\n-## Assumptions (Wave 2.1 UAT Remediation)\n-1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n-2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n-3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n-\n-## Verification Plan (Wave 2.1 UAT Remediation)\n-1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n-2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n-3. Record final remediation GO/NO-GO in `spec` with residual risks.\n-\n-## Rollback Plan (Wave 2.1 UAT Remediation)\n-1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n-2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n-3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n-\n----\n-\n-\n-## Goal (Wave 2.1 Orchestrator Planning Loop)\n-Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n-\n-## Tasks (Wave 2.1 Orchestrator Planning Loop)\n-- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n-\n-- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n-\n-- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n-\n-## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n-1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n-2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n-3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n-4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n-\n-## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Building in-app browser preview.\n-4. Integrating context adapter providers beyond current local flow.\n-\n-## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n-2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n-3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n-\n-## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n-2. Run `pnpm run desktop:typecheck` after each wave.\n-3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n-\n-## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n-2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n-3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n-\n----\n-\n-\n-\n-## Wave 2.1 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Wave 2.1 tasks are complete:\n-  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n-  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n-  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n-- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n-- Wave 2.1 acceptance criteria are satisfied:\n-  1. Prompt-triggered run lifecycle: PASS.\n-  2. Spec draft synthesis/apply path: PASS.\n-  3. Implement/Verify/Debug delegation + timeline: PASS.\n-  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n-- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n-- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n-\n-## UAT Plan (Wave 2.1)\n-\n-Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n-\n-### Preconditions\n-1. App launches in dev mode.\n-2. You are in a workspace with the `Orchestrator` view available.\n-3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n-\n-### Test Cases\n-1. Happy-path run lifecycle\n-- Action: submit a normal orchestrator prompt.\n-- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n-\n-2. Spec draft generation + apply\n-- Action: from a successful run, apply the generated draft to spec.\n-- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n-\n-3. Delegation timeline visibility\n-- Action: inspect delegated tasks for the run.\n-- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n-\n-4. Failure-path behavior\n-- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n-- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n-\n-5. Session persistence sanity\n-- Action: reopen the app/workspace after at least one successful and one failed run.\n-- Expect: orchestrator run history (including timeline/status) is still present.\n-\n-### Result Recording\n-For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n-\n-### Exit Criteria\n-- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n-- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n-\n-## Tasks (Wave 1.6 Blocker Burn-down)\n-\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [/] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [/] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n-\n-## UAT Results (Wave 2.1)\n-\n-### Case 1: Happy-path run lifecycle\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16):\n-  - Run reached terminal success (`Run ... is completed`).\n-  - Lifecycle shows expected progression: `queued -> running -> completed`.\n-  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n-  - Draft generation state present: `Draft: ready for run ...`.\n-\n-### Case 2: Spec draft generation + apply\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16 4:07 PM):\n-  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n-  - Apply action succeeded (`Applied draft from run ...`).\n-  - Spec Markdown/Preview panes show updated draft-derived content.\n-  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n-\n-### Case 3: Delegation timeline visibility\n-- Result: **PASS**\n-- Evidence (same UAT screenshots):\n-  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n-  - Each row shows explicit transition chain with terminal `completed` state.\n-  - Run-level lifecycle and per-task timeline information are both rendered together.\n-\n-### Case 4: Failure-path behavior\n-- Result: **FAIL**\n-- Evidence (user screenshot, 2026-02-16 4:10 PM):\n-  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n-  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n-  - Delegated tasks all completed; no failure message surfaced.\n-- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n-- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n-\n-### Case 5: Session persistence sanity\n-- Result: **PARTIAL / FAIL**\n-- PASS: latest orchestrator run state persists across app restart.\n-- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n-\n-### Additional UAT Observation\n-- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n-- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n-\n-### UAT Status (Wave 2.1)\n-- Current UAT decision: **NO-GO** pending remediation for:\n-  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n-  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n-\n-## Context Adapter Closure Check (2026-02-17)\n-\n-Task `302fcffa-863d-4d90-b017-08369fad3f73` is **NO-GO** for verifier wave. Closure audit found missing commit/push evidence and no remote head for `feature/context-adapter-foundation`; current branch state shows uncommitted context files. Recommended status remains `in_progress` until commit/push/remote-ref and test-output artifacts are attached in the task note.\n+1. Closure task `374e17d5-6ac8-42ff-b943-66026957a892` is still in `in_progress` with no additional task-note updates after initial kickoff; treat as stalled.\n+2. Closure task `76dd55a0-e87d-4fc5-82bc-7878efc81bd5` is complete with NO-GO findings: context task `302fcffa-863d-4d90-b017-08369fad3f73` remains blocked by missing commit/push/remote-ref artifacts.\n+3. Browser sequencing task `14bc6806-c210-44a3-8acc-ebca2014ea78` and external handoff task `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` have not started.\n+4. Proposed recovery wave:\n+   a. Replace stalled run-history closure execution on `374e17d5-6ac8-42ff-b943-66026957a892`.\n+   b. Run `14bc6806-c210-44a3-8acc-ebca2014ea78` to lock browser next-action state from current evidence.\n+   c. Run `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` to produce your external handoff packet.\n+5. Verifier dispatch will follow each recovered task completion.\n+\n+## Recovery Wave Dispatch (2026-02-17)\n+\n+1. Stalled execution on `374e17d5-6ac8-42ff-b943-66026957a892` was replaced with new implementor agent `agent-4e138d04-03c3-4e22-b0c8-b6f34cfd5bf2`.\n+2. Browser sequencing task `14bc6806-c210-44a3-8acc-ebca2014ea78` dispatched to implementor agent `agent-158d1a82-e398-494f-81ca-99267d8f981c`.\n+3. External handoff package task `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` dispatched to implementor agent `agent-735d2a05-9c47-45fc-bae9-bf5f158c7cc1`.\n+4. All three were dispatched in one grouped wave with `wait_mode=after_all`; next step is verifier follow-on immediately when this wave returns.\n+\n+## Run-history Ownership Enforcement (2026-02-17)\n+\n+1. Conflict detected: two active agents on task `374e17d5-6ac8-42ff-b943-66026957a892` (`agent-1b62073a-7ae5-486d-8688-01c2213e7d5c` and `agent-4e138d04-03c3-4e22-b0c8-b6f34cfd5bf2`).\n+2. Coordinator enforced single-owner execution: `agent-4e138d04-03c3-4e22-b0c8-b6f34cfd5bf2` is authoritative owner.\n+3. Prior agent was issued a high-priority stand-down instruction and its future outputs are non-authoritative for closure decisions.\n+## Goal\n+Restore a healthy Git baseline, recover the pre-reset feature work, and resume implementation from a clean, pushable branch.\n+\n+## Tasks\n+- [x] [Recover pre-reset work into current workspace](intent://local/task/7a006ca5-e5df-4dfd-8134-70db25f8203c)\n+\n+- [x] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n+\n+- [/] [Outsource independent PR work and resume primary feature](intent://local/task/d7a5cef2-5289-444a-a5b7-21822d012663)\n+\n+\n+- [x] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n+## Acceptance Criteria\n+1. Pre-reset work is restored into the active workspace branch without data loss.\n+2. Git health checks pass with no garbage warnings or invalid refs.\n+3. Required stale session artifacts are cleaned locally/remotely without deleting active branches.\n+4. At least one feature task is actively resumed with clear delegation.\n+5. Outsourceable PR candidates and handoffs are documented.\n+\n+## Non-goals\n+1. Rewriting published `main` history.\n+2. Deleting non-session branches without explicit approval.\n+3. Bundling all remaining feature work into one large PR.\n+\n+## Assumptions\n+1. We should restore the full pre-reset branch tip (`fe3e028e5b5e7d7d273e011d5ae7e5483640b94c`) (confirm?).\n+2. Remote cleanup may delete only session branches (`codex/*`, `git-stability-incident`, `unblock-wave-1-verification`) (confirm?).\n+3. Highest-priority resume target remains run-history persistence (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) (confirm?).\n+\n+## Verification Plan\n+1. Run recovery and Git-health commands from Task 1 and Task 2.\n+2. Validate push capability from the recovered branch.\n+3. Verify spec includes outsourcing handoffs and delegated resume task.\n+\n+## Rollback Plan\n+1. If the recovery branch is wrong, delete only the recovery branch and refetch from backup path.\n+2. If cleanup removes a needed branch, recreate from backup SHA and restore the remote ref.\n+3. If push fails, use documented fresh-clone fallback without changing recovered branch content.\n+\n+\n+\n+\n+## Recovery Checkpoint (2026-02-17)\n+\n+1. Git branch tracking is now healthy on the active branch: `feature/run-history-persistence...origin/feature/run-history-persistence`.\n+2. Recovery content exists on remote at `origin/feature/run-history-persistence` -> `be71982fc9e214b689eb529d3e9b2cb1f4d9b99c`.\n+3. Local Git health checks remain clean (`garbage: 0`, no invalid-ref errors).\n+4. Stale `origin/codex/*` branches used during incident handling were removed.\n+5. Residual risk: direct large-pack pushes still intermittently fail with remote unpack/inflate errors; fallback publish path is the current mitigation.\n+\n+\n+## Branch Protection Update (2026-02-17)\n+\n+Direct pushes to `main` are blocked by repository rules (`GH013`); integration to `main` must go through pull requests. Effective workflow: continue work on feature branches, open PRs targeting `main`, merge via GitHub, then sync local `main` from `origin/main`. This replaces any direct-push-to-main assumption.\n+\n+## Integration Gate (2026-02-17)\n+\n+1. PR #2 is open: https://github.com/gannonh/kata-cloud/pull/2 (`feature/run-history-persistence` -> `main`).\n+2. This PR merge is the required gate before outsourcing additional implementation work.\n+3. After merge, sync local `main` from `origin/main` and create all new work branches from that updated `main`.\n+4. Do not stack new feature branches on top of recovery branches.\n+\n+## Integration Gate Result (2026-02-17)\n+\n+1. PR #2 (`feature/run-history-persistence` -> `main`) merged at `2026-02-17T03:45:07Z`.\n+2. Merge commit on `main`: `1cadf1894f3a37d520c106af590ef102f8ce8f77`.\n+3. Gate is cleared: Wave 1 outsourcing can proceed.\n+4. All new work must branch from updated `main` and return via short-lived PRs.\n+\n+## Wave 1 Execution Note (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) encountered overlap with in-progress browser edits in shared workspace.\n+2. Coordinator approved isolated execution in a clean temporary worktree from updated `main` on `feature/run-history-persistence-fix`.\n+3. Task agent was re-notified and resumed with strict non-overlap constraints.\n+\n+## Wave 1 Conflict Handling (2026-02-17)\n+\n+1. Parallel file overlap occurred between browser preview and context adapter tasks on `src/shared/state.ts` and `src/shared/state.test.ts`.\n+2. Scope-separation rule applied: context task owns first-pass shared-state edits; browser task is paused for those files.\n+3. Browser task resumes on updated `main` after context task lands to avoid mixed-scope commits and preserve independent PR hygiene.\n+\n+## Wave 1 Status (2026-02-17)\n+\n+1. Browser preview task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) is implemented and currently `review_required`; automated checks passed, manual localhost clickthrough remains for verifier.\n+2. Context adapter task (`302fcffa-863d-4d90-b017-08369fad3f73`) hit branch mismatch and was corrected to continue in isolated `feature/context-adapter-foundation` flow from updated `main`.\n+3. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) remains in progress in isolated branch/worktree flow.\n+4. Wave 1 verifier delegation will start only after tasks 2 and 3 complete.\n+\n+## Wave 1 Correction (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was reopened because prior completion lacked implementation artifacts (no commit hash/test evidence/files-changed summary in task note).\n+2. Task status reset to `in_progress` and re-instruction sent for clean-branch execution with mandatory evidence before verification.\n+\n+## Wave 1 Recovery Action (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was re-delegated to replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` after repeated non-progress responses.\n+2. Browser task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) reset to `waiting` pending clean scope-separation with context shared-state edits.\n+3. Context task (`302fcffa-863d-4d90-b017-08369fad3f73`) instructed to finalize only on isolated `feature/context-adapter-foundation` with explicit artifacts.\n+\n+## Wave 1 Ownership Clarification (2026-02-17)\n+\n+Run-history replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` is designated active owner and instructed to continue without waiting on prior stalled agent assignment.\n+\n+## Wave 1 Cutover Control (2026-02-17)\n+\n+1. Repeated stale/duplicate run-history agent events triggered forced execution cutover.\n+2. Original run-history agent was instructed to stand down; replacement agent remains sole owner.\n+3. Context task switched to execute-only mode with required artifact-based completion.\n+4. Browser task remains `waiting` until context/run-history complete and verifier can evaluate cross-task integration safely.\n+\n+## Wave 1 Execution Control Update (2026-02-17)\n+\n+1. Duplicate run-history execution was re-confirmed; original agent `agent-eadf6ee1-4de3-4edc-af4b-6f70458f1a9d` was instructed again to stand down.\n+2. Replacement run-history agent `agent-e92c73d0-56ef-440e-a009-661b7c399382` remains sole owner with mandatory artifact completion requirements.\n+3. Context agent `agent-8e0a4569-29d6-44b4-ac55-5ad7f2f7baa4` was re-instructed to execute-only on isolated `feature/context-adapter-foundation` scope.\n+4. Browser task remains `waiting` until context + run-history complete and verifier wave starts.\n+\n+## Codex Outsource Queue (2026-02-17)\n+\n+1. Active: `c5f554ea-2059-40d2-9fb2-bf522a590cae` (run-history persistence)  replacement implementor executing.\n+2. Active: `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter)  implementor executing in isolated branch.\n+3. Waiting: `22770f24-a79b-4d14-9add-14ffd1447b2f` (browser preview)  resumes after context/run-history are complete and verifier starts.\n+4. Ready to outsource now: `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)  independent PR candidate from updated `main`.\n+5. Sequence after changes tab: `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR workflow).\n+\n+## Wave 1 Status Refresh (2026-02-17)\n+\n+1. `c5f554ea-2059-40d2-9fb2-bf522a590cae` now has implementation artifacts (commit `4d388ce411b3dc2b6df4591e47e67e944e7715a6`, branch `feature/run-history-persistence-fix`, required tests/typecheck pass) and is moved to `review_required`.\n+2. `302fcffa-863d-4d90-b017-08369fad3f73` is `review_required`; coordinator requested explicit commit/push evidence before verifier handoff.\n+3. `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting` until cross-task shared-state sequencing is verified.\n+4. Stale original run-history agent remains standdown-only; replacement owner output is authoritative.\n+\n+## Wave 1 Verification Start (2026-02-17)\n+\n+1. Verifier wave started for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` via verifier agent `agent-40059ba1-1b38-4d89-967a-90d02f63db38`.\n+2. Context task `302fcffa-863d-4d90-b017-08369fad3f73` is awaiting final commit/push artifact append before verifier dispatch.\n+3. Browser task remains waiting until run-history/context verification results are in.\n+## Outsource Candidates And Handoffs (2026-02-17)\n+1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n+Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n+2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n+Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n+3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n+Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n+4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n+## Goal (Git Stability Incident)\n+Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n+\n+## Tasks (Git Stability Incident)\n+- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+\n+- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n+\n+- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n+\n+- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n+\n+## Acceptance Criteria (Git Stability Incident)\n+1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n+2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n+3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n+4. Independent verifier issues explicit GO before feature work resumes.\n+\n+## Non-goals (Git Stability Incident)\n+1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n+2. Rewriting the entire repository history.\n+3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n+\n+## Assumptions (Git Stability Incident)\n+1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n+2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n+3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n+\n+## Verification Plan (Git Stability Incident)\n+1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n+2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n+3. Resume feature tasks only after explicit GO is captured in `spec`.\n+\n+## Rollback Plan (Git Stability Incident)\n+1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n+2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n+3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n+\n+---\n+\n+\n+\n+## Incident Status (2026-02-17)\n+\n+1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n+2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n+3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n+4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n+5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n+6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n+7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n+8. Feature work may resume.\n+\n+## Goal (Wave 2.1 UAT Remediation)\n+Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n+\n+## Tasks (Wave 2.1 UAT Remediation)\n+- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+\n+- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+\n+- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+\n+## Acceptance Criteria (Wave 2.1 UAT Remediation)\n+1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n+2. Orchestrator run history (not latest-only) is visible and persists across restart.\n+3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n+4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+\n+## Non-goals (Wave 2.1 UAT Remediation)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Adding in-app browser preview.\n+4. Context adapter/provider integration expansion.\n+\n+## Assumptions (Wave 2.1 UAT Remediation)\n+1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n+2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n+3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n+\n+## Verification Plan (Wave 2.1 UAT Remediation)\n+1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n+2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n+3. Record final remediation GO/NO-GO in `spec` with residual risks.\n+\n+## Rollback Plan (Wave 2.1 UAT Remediation)\n+1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n+2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n+3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+\n+## Wave 2.1 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+\n+## UAT Plan (Wave 2.1)\n+\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n+\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [/] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [/] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+\n+### Case 5: Session persistence sanity\n+- Result: **PARTIAL / FAIL**\n+- PASS: latest orchestrator run state persists across app restart.\n+- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n+\n+### Additional UAT Observation\n+- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n+- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n+\n+### UAT Status (Wave 2.1)\n+- Current UAT decision: **NO-GO** pending remediation for:\n+  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n+  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n+\n+## Context Adapter Closure Check (2026-02-17)\n+\n+Task `302fcffa-863d-4d90-b017-08369fad3f73` is **NO-GO** for verifier wave. Closure audit found missing commit/push evidence and no remote head for `feature/context-adapter-foundation`; current branch state shows uncommitted context files. Recommended status remains `in_progress` until commit/push/remote-ref and test-output artifacts are attached in the task note.\n+\n+## Browser Sequencing Decision (2026-02-17)\n+\n+1. Browser task `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting`.\n+2. Required prerequisite state before resume:\n+   - Run-history closure task `374e17d5-6ac8-42ff-b943-66026957a892` is terminally closed with explicit GO/NO-GO.\n+   - Context task `302fcffa-863d-4d90-b017-08369fad3f73` has commit/push/remote-ref/test-output artifacts and is no longer closure-blocked.\n+3. Single next action: execute the run-history/context closure gates first, then resume browser task only after both prerequisites are satisfied."}
{"type":"diff","v":47,"date":"2026-02-17T14:31:48.147Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -5 +5 @@\n-- [ ] [Verify and close run-history task](intent://local/task/374e17d5-6ac8-42ff-b943-66026957a892)\n+- [/] Verify and close run-history task\n@@ -7 +7 @@\n-- [ ] [Verify and close context-adapter task](intent://local/task/76dd55a0-e87d-4fc5-82bc-7878efc81bd5)\n+- [x] Verify and close context-adapter task\n@@ -11 +11 @@\n-- [ ] [Prepare external-outsource handoff package](intent://local/task/1ce25d50-a2ee-49ca-9f11-aae1f2869ad5)\n+- [x] Prepare external-outsource handoff package\n@@ -64 +64 @@\n-## Goal\n-Restore a healthy Git baseline, recover the pre-reset feature work, and resume implementation from a clean, pushable branch.\n@@ -67 +65 @@\n-## Tasks\n-- [x] [Recover pre-reset work into current workspace](intent://local/task/7a006ca5-e5df-4dfd-8134-70db25f8203c)\n+## Commit/Push Recovery Dispatch (2026-02-17)\n@@ -70 +67 @@\n-- [x] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n+1. Processed recovery-wave events: `14bc6806-c210-44a3-8acc-ebca2014ea78` and `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` completed.\n+2. Top task statuses updated to reflect current state (`run-history` in progress, `context-closure` done, `external handoff package` done).\n+3. High-priority implementor dispatch started for `302fcffa-863d-4d90-b017-08369fad3f73` to commit/push current uncommitted context-adapter work and attach full artifact evidence for PR handoff.\n@@ -72 +71 @@\n-- [/] [Outsource independent PR work and resume primary feature](intent://local/task/d7a5cef2-5289-444a-a5b7-21822d012663)\n+## Commit/Push Recovery Result (2026-02-17)\n@@ -74 +73 @@\n-\n-- [x] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n-## Acceptance Criteria\n-1. Pre-reset work is restored into the active workspace branch without data loss.\n-2. Git health checks pass with no garbage warnings or invalid refs.\n-3. Required stale session artifacts are cleaned locally/remotely without deleting active branches.\n-4. At least one feature task is actively resumed with clear delegation.\n-5. Outsourceable PR candidates and handoffs are documented.\n-\n-## Non-goals\n-1. Rewriting published `main` history.\n-2. Deleting non-session branches without explicit approval.\n-3. Bundling all remaining feature work into one large PR.\n-\n-## Assumptions\n-1. We should restore the full pre-reset branch tip (`fe3e028e5b5e7d7d273e011d5ae7e5483640b94c`) (confirm?).\n-2. Remote cleanup may delete only session branches (`codex/*`, `git-stability-incident`, `unblock-wave-1-verification`) (confirm?).\n-3. Highest-priority resume target remains run-history persistence (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) (confirm?).\n-\n-## Verification Plan\n-1. Run recovery and Git-health commands from Task 1 and Task 2.\n-2. Validate push capability from the recovered branch.\n-3. Verify spec includes outsourcing handoffs and delegated resume task.\n-\n-## Rollback Plan\n-1. If the recovery branch is wrong, delete only the recovery branch and refetch from backup path.\n-2. If cleanup removes a needed branch, recreate from backup SHA and restore the remote ref.\n-3. If push fails, use documented fresh-clone fallback without changing recovered branch content.\n-\n-\n-\n-\n-## Recovery Checkpoint (2026-02-17)\n-\n-1. Git branch tracking is now healthy on the active branch: `feature/run-history-persistence...origin/feature/run-history-persistence`.\n-2. Recovery content exists on remote at `origin/feature/run-history-persistence` -> `be71982fc9e214b689eb529d3e9b2cb1f4d9b99c`.\n-3. Local Git health checks remain clean (`garbage: 0`, no invalid-ref errors).\n-4. Stale `origin/codex/*` branches used during incident handling were removed.\n-5. Residual risk: direct large-pack pushes still intermittently fail with remote unpack/inflate errors; fallback publish path is the current mitigation.\n-\n-\n-## Branch Protection Update (2026-02-17)\n-\n-Direct pushes to `main` are blocked by repository rules (`GH013`); integration to `main` must go through pull requests. Effective workflow: continue work on feature branches, open PRs targeting `main`, merge via GitHub, then sync local `main` from `origin/main`. This replaces any direct-push-to-main assumption.\n-\n-## Integration Gate (2026-02-17)\n-\n-1. PR #2 is open: https://github.com/gannonh/kata-cloud/pull/2 (`feature/run-history-persistence` -> `main`).\n-2. This PR merge is the required gate before outsourcing additional implementation work.\n-3. After merge, sync local `main` from `origin/main` and create all new work branches from that updated `main`.\n-4. Do not stack new feature branches on top of recovery branches.\n-\n-## Integration Gate Result (2026-02-17)\n-\n-1. PR #2 (`feature/run-history-persistence` -> `main`) merged at `2026-02-17T03:45:07Z`.\n-2. Merge commit on `main`: `1cadf1894f3a37d520c106af590ef102f8ce8f77`.\n-3. Gate is cleared: Wave 1 outsourcing can proceed.\n-4. All new work must branch from updated `main` and return via short-lived PRs.\n-\n-## Wave 1 Execution Note (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) encountered overlap with in-progress browser edits in shared workspace.\n-2. Coordinator approved isolated execution in a clean temporary worktree from updated `main` on `feature/run-history-persistence-fix`.\n-3. Task agent was re-notified and resumed with strict non-overlap constraints.\n-\n-## Wave 1 Conflict Handling (2026-02-17)\n-\n-1. Parallel file overlap occurred between browser preview and context adapter tasks on `src/shared/state.ts` and `src/shared/state.test.ts`.\n-2. Scope-separation rule applied: context task owns first-pass shared-state edits; browser task is paused for those files.\n-3. Browser task resumes on updated `main` after context task lands to avoid mixed-scope commits and preserve independent PR hygiene.\n-\n-## Wave 1 Status (2026-02-17)\n-\n-1. Browser preview task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) is implemented and currently `review_required`; automated checks passed, manual localhost clickthrough remains for verifier.\n-2. Context adapter task (`302fcffa-863d-4d90-b017-08369fad3f73`) hit branch mismatch and was corrected to continue in isolated `feature/context-adapter-foundation` flow from updated `main`.\n-3. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) remains in progress in isolated branch/worktree flow.\n-4. Wave 1 verifier delegation will start only after tasks 2 and 3 complete.\n-\n-## Wave 1 Correction (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was reopened because prior completion lacked implementation artifacts (no commit hash/test evidence/files-changed summary in task note).\n-2. Task status reset to `in_progress` and re-instruction sent for clean-branch execution with mandatory evidence before verification.\n-\n-## Wave 1 Recovery Action (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was re-delegated to replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` after repeated non-progress responses.\n-2. Browser task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) reset to `waiting` pending clean scope-separation with context shared-state edits.\n-3. Context task (`302fcffa-863d-4d90-b017-08369fad3f73`) instructed to finalize only on isolated `feature/context-adapter-foundation` with explicit artifacts.\n-\n-## Wave 1 Ownership Clarification (2026-02-17)\n-\n-Run-history replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` is designated active owner and instructed to continue without waiting on prior stalled agent assignment.\n-\n-## Wave 1 Cutover Control (2026-02-17)\n-\n-1. Repeated stale/duplicate run-history agent events triggered forced execution cutover.\n-2. Original run-history agent was instructed to stand down; replacement agent remains sole owner.\n-3. Context task switched to execute-only mode with required artifact-based completion.\n-4. Browser task remains `waiting` until context/run-history complete and verifier can evaluate cross-task integration safely.\n-\n-## Wave 1 Execution Control Update (2026-02-17)\n-\n-1. Duplicate run-history execution was re-confirmed; original agent `agent-eadf6ee1-4de3-4edc-af4b-6f70458f1a9d` was instructed again to stand down.\n-2. Replacement run-history agent `agent-e92c73d0-56ef-440e-a009-661b7c399382` remains sole owner with mandatory artifact completion requirements.\n-3. Context agent `agent-8e0a4569-29d6-44b4-ac55-5ad7f2f7baa4` was re-instructed to execute-only on isolated `feature/context-adapter-foundation` scope.\n-4. Browser task remains `waiting` until context + run-history complete and verifier wave starts.\n-\n-## Codex Outsource Queue (2026-02-17)\n-\n-1. Active: `c5f554ea-2059-40d2-9fb2-bf522a590cae` (run-history persistence)  replacement implementor executing.\n-2. Active: `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter)  implementor executing in isolated branch.\n-3. Waiting: `22770f24-a79b-4d14-9add-14ffd1447b2f` (browser preview)  resumes after context/run-history are complete and verifier starts.\n-4. Ready to outsource now: `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)  independent PR candidate from updated `main`.\n-5. Sequence after changes tab: `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR workflow).\n-\n-## Wave 1 Status Refresh (2026-02-17)\n-\n-1. `c5f554ea-2059-40d2-9fb2-bf522a590cae` now has implementation artifacts (commit `4d388ce411b3dc2b6df4591e47e67e944e7715a6`, branch `feature/run-history-persistence-fix`, required tests/typecheck pass) and is moved to `review_required`.\n-2. `302fcffa-863d-4d90-b017-08369fad3f73` is `review_required`; coordinator requested explicit commit/push evidence before verifier handoff.\n-3. `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting` until cross-task shared-state sequencing is verified.\n-4. Stale original run-history agent remains standdown-only; replacement owner output is authoritative.\n-\n-## Wave 1 Verification Start (2026-02-17)\n-\n-1. Verifier wave started for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` via verifier agent `agent-40059ba1-1b38-4d89-967a-90d02f63db38`.\n-2. Context task `302fcffa-863d-4d90-b017-08369fad3f73` is awaiting final commit/push artifact append before verifier dispatch.\n-3. Browser task remains waiting until run-history/context verification results are in.\n-## Outsource Candidates And Handoffs (2026-02-17)\n-1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n-Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n-2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n-Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n-3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n-Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n-4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n-## Goal (Git Stability Incident)\n-Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n-\n-## Tasks (Git Stability Incident)\n-- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n-\n-- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n-\n-- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n-\n-- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n-\n-## Acceptance Criteria (Git Stability Incident)\n-1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n-2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n-3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n-4. Independent verifier issues explicit GO before feature work resumes.\n-\n-## Non-goals (Git Stability Incident)\n-1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n-2. Rewriting the entire repository history.\n-3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n-\n-## Assumptions (Git Stability Incident)\n-1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n-2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n-3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n-\n-## Verification Plan (Git Stability Incident)\n-1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n-2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n-3. Resume feature tasks only after explicit GO is captured in `spec`.\n-\n-## Rollback Plan (Git Stability Incident)\n-1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n-2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n-3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n-\n----\n-\n-\n-\n-## Incident Status (2026-02-17)\n-\n-1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n-2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n-3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n-4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n-5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n-6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n-7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n-8. Feature work may resume.\n-\n-## Goal (Wave 2.1 UAT Remediation)\n-Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n-\n-## Tasks (Wave 2.1 UAT Remediation)\n-- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n-\n-- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n-\n-- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n-\n-## Acceptance Criteria (Wave 2.1 UAT Remediation)\n-1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n-2. Orchestrator run history (not latest-only) is visible and persists across restart.\n-3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n-4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n-\n-## Non-goals (Wave 2.1 UAT Remediation)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Adding in-app browser preview.\n-4. Context adapter/provider integration expansion.\n-\n-## Assumptions (Wave 2.1 UAT Remediation)\n-1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n-2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n-3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n-\n-## Verification Plan (Wave 2.1 UAT Remediation)\n-1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n-2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n-3. Record final remediation GO/NO-GO in `spec` with residual risks.\n-\n-## Rollback Plan (Wave 2.1 UAT Remediation)\n-1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n-2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n-3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n-\n----\n-\n-\n-## Goal (Wave 2.1 Orchestrator Planning Loop)\n-Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n-\n-## Tasks (Wave 2.1 Orchestrator Planning Loop)\n-- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n-\n-- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n-\n-- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n-\n-## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n-1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n-2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n-3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n-4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n-\n-## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Building in-app browser preview.\n-4. Integrating context adapter providers beyond current local flow.\n-\n-## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n-2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n-3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n-\n-## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n-2. Run `pnpm run desktop:typecheck` after each wave.\n-3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n-\n-## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n-2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n-3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n-\n----\n-\n-\n-\n-## Wave 2.1 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Wave 2.1 tasks are complete:\n-  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n-  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n-  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n-- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n-- Wave 2.1 acceptance criteria are satisfied:\n-  1. Prompt-triggered run lifecycle: PASS.\n-  2. Spec draft synthesis/apply path: PASS.\n-  3. Implement/Verify/Debug delegation + timeline: PASS.\n-  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n-- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n-- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n-\n-## UAT Plan (Wave 2.1)\n-\n-Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n-\n-### Preconditions\n-1. App launches in dev mode.\n-2. You are in a workspace with the `Orchestrator` view available.\n-3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n-\n-### Test Cases\n-1. Happy-path run lifecycle\n-- Action: submit a normal orchestrator prompt.\n-- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n-\n-2. Spec draft generation + apply\n-- Action: from a successful run, apply the generated draft to spec.\n-- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n-\n-3. Delegation timeline visibility\n-- Action: inspect delegated tasks for the run.\n-- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n-\n-4. Failure-path behavior\n-- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n-- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n-\n-5. Session persistence sanity\n-- Action: reopen the app/workspace after at least one successful and one failed run.\n-- Expect: orchestrator run history (including timeline/status) is still present.\n-\n-### Result Recording\n-For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n-\n-### Exit Criteria\n-- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n-- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n-\n-## Tasks (Wave 1.6 Blocker Burn-down)\n-\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [/] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [/] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n-\n-## UAT Results (Wave 2.1)\n-\n-### Case 1: Happy-path run lifecycle\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16):\n-  - Run reached terminal success (`Run ... is completed`).\n-  - Lifecycle shows expected progression: `queued -> running -> completed`.\n-  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n-  - Draft generation state present: `Draft: ready for run ...`.\n-\n-### Case 2: Spec draft generation + apply\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16 4:07 PM):\n-  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n-  - Apply action succeeded (`Applied draft from run ...`).\n-  - Spec Markdown/Preview panes show updated draft-derived content.\n-  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n-\n-### Case 3: Delegation timeline visibility\n-- Result: **PASS**\n-- Evidence (same UAT screenshots):\n-  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n-  - Each row shows explicit transition chain with terminal `completed` state.\n-  - Run-level lifecycle and per-task timeline information are both rendered together.\n-\n-### Case 4: Failure-path behavior\n-- Result: **FAIL**\n-- Evidence (user screenshot, 2026-02-16 4:10 PM):\n-  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n-  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n-  - Delegated tasks all completed; no failure message surfaced.\n-- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n-- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n-\n-### Case 5: Session persistence sanity\n-- Result: **PARTIAL / FAIL**\n-- PASS: latest orchestrator run state persists across app restart.\n-- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n-\n-### Additional UAT Observation\n-- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n-- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n-\n-### UAT Status (Wave 2.1)\n-- Current UAT decision: **NO-GO** pending remediation for:\n-  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n-  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n-\n-## Context Adapter Closure Check (2026-02-17)\n-\n-Task `302fcffa-863d-4d90-b017-08369fad3f73` is **NO-GO** for verifier wave. Closure audit found missing commit/push evidence and no remote head for `feature/context-adapter-foundation`; current branch state shows uncommitted context files. Recommended status remains `in_progress` until commit/push/remote-ref and test-output artifacts are attached in the task note.\n-\n-## Browser Sequencing Decision (2026-02-17)\n-\n-1. Browser task `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting`.\n-2. Required prerequisite state before resume:\n-   - Run-history closure task `374e17d5-6ac8-42ff-b943-66026957a892` is terminally closed with explicit GO/NO-GO.\n-   - Context task `302fcffa-863d-4d90-b017-08369fad3f73` has commit/push/remote-ref/test-output artifacts and is no longer closure-blocked.\n-3. Single next action: execute the run-history/context closure gates first, then resume browser task only after both prerequisites are satisfied.\n+1. Context-adapter branch `feature/context-adapter-foundation` is now committed and pushed.\n+2. Commit: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8` (`feat: add context adapter foundation`).\n+3. Remote ref verified: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8\\trefs/heads/feature/context-adapter-foundation`.\n+4. Required validations recorded as passing (`pnpm run test -- context`, `pnpm run desktop:typecheck`).\n+5. Working tree is clean on current branch; task `302fcffa-863d-4d90-b017-08369fad3f73` moved to `review_required` for verifier closeout.\n+## Goal\n+Restore a healthy Git baseline, recover the pre-reset feature work, and resume implementation from a clean, pushable branch.\n+\n+## Tasks\n+- [x] [Recover pre-reset work into current workspace](intent://local/task/7a006ca5-e5df-4dfd-8134-70db25f8203c)\n+\n+- [x] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n+\n+- [/] [Outsource independent PR work and resume primary feature](intent://local/task/d7a5cef2-5289-444a-a5b7-21822d012663)\n+\n+\n+- [x] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n+## Acceptance Criteria\n+1. Pre-reset work is restored into the active workspace branch without data loss.\n+2. Git health checks pass with no garbage warnings or invalid refs.\n+3. Required stale session artifacts are cleaned locally/remotely without deleting active branches.\n+4. At least one feature task is actively resumed with clear delegation.\n+5. Outsourceable PR candidates and handoffs are documented.\n+\n+## Non-goals\n+1. Rewriting published `main` history.\n+2. Deleting non-session branches without explicit approval.\n+3. Bundling all remaining feature work into one large PR.\n+\n+## Assumptions\n+1. We should restore the full pre-reset branch tip (`fe3e028e5b5e7d7d273e011d5ae7e5483640b94c`) (confirm?).\n+2. Remote cleanup may delete only session branches (`codex/*`, `git-stability-incident`, `unblock-wave-1-verification`) (confirm?).\n+3. Highest-priority resume target remains run-history persistence (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) (confirm?).\n+\n+## Verification Plan\n+1. Run recovery and Git-health commands from Task 1 and Task 2.\n+2. Validate push capability from the recovered branch.\n+3. Verify spec includes outsourcing handoffs and delegated resume task.\n+\n+## Rollback Plan\n+1. If the recovery branch is wrong, delete only the recovery branch and refetch from backup path.\n+2. If cleanup removes a needed branch, recreate from backup SHA and restore the remote ref.\n+3. If push fails, use documented fresh-clone fallback without changing recovered branch content.\n+\n+\n+\n+\n+## Recovery Checkpoint (2026-02-17)\n+\n+1. Git branch tracking is now healthy on the active branch: `feature/run-history-persistence...origin/feature/run-history-persistence`.\n+2. Recovery content exists on remote at `origin/feature/run-history-persistence` -> `be71982fc9e214b689eb529d3e9b2cb1f4d9b99c`.\n+3. Local Git health checks remain clean (`garbage: 0`, no invalid-ref errors).\n+4. Stale `origin/codex/*` branches used during incident handling were removed.\n+5. Residual risk: direct large-pack pushes still intermittently fail with remote unpack/inflate errors; fallback publish path is the current mitigation.\n+\n+\n+## Branch Protection Update (2026-02-17)\n+\n+Direct pushes to `main` are blocked by repository rules (`GH013`); integration to `main` must go through pull requests. Effective workflow: continue work on feature branches, open PRs targeting `main`, merge via GitHub, then sync local `main` from `origin/main`. This replaces any direct-push-to-main assumption.\n+\n+## Integration Gate (2026-02-17)\n+\n+1. PR #2 is open: https://github.com/gannonh/kata-cloud/pull/2 (`feature/run-history-persistence` -> `main`).\n+2. This PR merge is the required gate before outsourcing additional implementation work.\n+3. After merge, sync local `main` from `origin/main` and create all new work branches from that updated `main`.\n+4. Do not stack new feature branches on top of recovery branches.\n+\n+## Integration Gate Result (2026-02-17)\n+\n+1. PR #2 (`feature/run-history-persistence` -> `main`) merged at `2026-02-17T03:45:07Z`.\n+2. Merge commit on `main`: `1cadf1894f3a37d520c106af590ef102f8ce8f77`.\n+3. Gate is cleared: Wave 1 outsourcing can proceed.\n+4. All new work must branch from updated `main` and return via short-lived PRs.\n+\n+## Wave 1 Execution Note (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) encountered overlap with in-progress browser edits in shared workspace.\n+2. Coordinator approved isolated execution in a clean temporary worktree from updated `main` on `feature/run-history-persistence-fix`.\n+3. Task agent was re-notified and resumed with strict non-overlap constraints.\n+\n+## Wave 1 Conflict Handling (2026-02-17)\n+\n+1. Parallel file overlap occurred between browser preview and context adapter tasks on `src/shared/state.ts` and `src/shared/state.test.ts`.\n+2. Scope-separation rule applied: context task owns first-pass shared-state edits; browser task is paused for those files.\n+3. Browser task resumes on updated `main` after context task lands to avoid mixed-scope commits and preserve independent PR hygiene.\n+\n+## Wave 1 Status (2026-02-17)\n+\n+1. Browser preview task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) is implemented and currently `review_required`; automated checks passed, manual localhost clickthrough remains for verifier.\n+2. Context adapter task (`302fcffa-863d-4d90-b017-08369fad3f73`) hit branch mismatch and was corrected to continue in isolated `feature/context-adapter-foundation` flow from updated `main`.\n+3. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) remains in progress in isolated branch/worktree flow.\n+4. Wave 1 verifier delegation will start only after tasks 2 and 3 complete.\n+\n+## Wave 1 Correction (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was reopened because prior completion lacked implementation artifacts (no commit hash/test evidence/files-changed summary in task note).\n+2. Task status reset to `in_progress` and re-instruction sent for clean-branch execution with mandatory evidence before verification.\n+\n+## Wave 1 Recovery Action (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was re-delegated to replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` after repeated non-progress responses.\n+2. Browser task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) reset to `waiting` pending clean scope-separation with context shared-state edits.\n+3. Context task (`302fcffa-863d-4d90-b017-08369fad3f73`) instructed to finalize only on isolated `feature/context-adapter-foundation` with explicit artifacts.\n+\n+## Wave 1 Ownership Clarification (2026-02-17)\n+\n+Run-history replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` is designated active owner and instructed to continue without waiting on prior stalled agent assignment.\n+\n+## Wave 1 Cutover Control (2026-02-17)\n+\n+1. Repeated stale/duplicate run-history agent events triggered forced execution cutover.\n+2. Original run-history agent was instructed to stand down; replacement agent remains sole owner.\n+3. Context task switched to execute-only mode with required artifact-based completion.\n+4. Browser task remains `waiting` until context/run-history complete and verifier can evaluate cross-task integration safely.\n+\n+## Wave 1 Execution Control Update (2026-02-17)\n+\n+1. Duplicate run-history execution was re-confirmed; original agent `agent-eadf6ee1-4de3-4edc-af4b-6f70458f1a9d` was instructed again to stand down.\n+2. Replacement run-history agent `agent-e92c73d0-56ef-440e-a009-661b7c399382` remains sole owner with mandatory artifact completion requirements.\n+3. Context agent `agent-8e0a4569-29d6-44b4-ac55-5ad7f2f7baa4` was re-instructed to execute-only on isolated `feature/context-adapter-foundation` scope.\n+4. Browser task remains `waiting` until context + run-history complete and verifier wave starts.\n+\n+## Codex Outsource Queue (2026-02-17)\n+\n+1. Active: `c5f554ea-2059-40d2-9fb2-bf522a590cae` (run-history persistence)  replacement implementor executing.\n+2. Active: `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter)  implementor executing in isolated branch.\n+3. Waiting: `22770f24-a79b-4d14-9add-14ffd1447b2f` (browser preview)  resumes after context/run-history are complete and verifier starts.\n+4. Ready to outsource now: `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)  independent PR candidate from updated `main`.\n+5. Sequence after changes tab: `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR workflow).\n+\n+## Wave 1 Status Refresh (2026-02-17)\n+\n+1. `c5f554ea-2059-40d2-9fb2-bf522a590cae` now has implementation artifacts (commit `4d388ce411b3dc2b6df4591e47e67e944e7715a6`, branch `feature/run-history-persistence-fix`, required tests/typecheck pass) and is moved to `review_required`.\n+2. `302fcffa-863d-4d90-b017-08369fad3f73` is `review_required`; coordinator requested explicit commit/push evidence before verifier handoff.\n+3. `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting` until cross-task shared-state sequencing is verified.\n+4. Stale original run-history agent remains standdown-only; replacement owner output is authoritative.\n+\n+## Wave 1 Verification Start (2026-02-17)\n+\n+1. Verifier wave started for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` via verifier agent `agent-40059ba1-1b38-4d89-967a-90d02f63db38`.\n+2. Context task `302fcffa-863d-4d90-b017-08369fad3f73` is awaiting final commit/push artifact append before verifier dispatch.\n+3. Browser task remains waiting until run-history/context verification results are in.\n+## Outsource Candidates And Handoffs (2026-02-17)\n+1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n+Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n+2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n+Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n+3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n+Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n+4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n+## Goal (Git Stability Incident)\n+Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n+\n+## Tasks (Git Stability Incident)\n+- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+\n+- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n+\n+- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n+\n+- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n+\n+## Acceptance Criteria (Git Stability Incident)\n+1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n+2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n+3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n+4. Independent verifier issues explicit GO before feature work resumes.\n+\n+## Non-goals (Git Stability Incident)\n+1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n+2. Rewriting the entire repository history.\n+3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n+\n+## Assumptions (Git Stability Incident)\n+1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n+2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n+3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n+\n+## Verification Plan (Git Stability Incident)\n+1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n+2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n+3. Resume feature tasks only after explicit GO is captured in `spec`.\n+\n+## Rollback Plan (Git Stability Incident)\n+1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n+2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n+3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n+\n+---\n+\n+\n+\n+## Incident Status (2026-02-17)\n+\n+1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n+2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n+3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n+4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n+5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n+6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n+7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n+8. Feature work may resume.\n+\n+## Goal (Wave 2.1 UAT Remediation)\n+Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n+\n+## Tasks (Wave 2.1 UAT Remediation)\n+- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+\n+- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+\n+- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+\n+## Acceptance Criteria (Wave 2.1 UAT Remediation)\n+1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n+2. Orchestrator run history (not latest-only) is visible and persists across restart.\n+3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n+4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+\n+## Non-goals (Wave 2.1 UAT Remediation)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Adding in-app browser preview.\n+4. Context adapter/provider integration expansion.\n+\n+## Assumptions (Wave 2.1 UAT Remediation)\n+1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n+2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n+3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n+\n+## Verification Plan (Wave 2.1 UAT Remediation)\n+1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n+2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n+3. Record final remediation GO/NO-GO in `spec` with residual risks.\n+\n+## Rollback Plan (Wave 2.1 UAT Remediation)\n+1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n+2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n+3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+\n+## Wave 2.1 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+\n+## UAT Plan (Wave 2.1)\n+\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n+\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [/] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [/] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+\n+### Case 5: Session persistence sanity\n+- Result: **PARTIAL / FAIL**\n+- PASS: latest orchestrator run state persists across app restart.\n+- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n+\n+### Additional UAT Observation\n+- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n+- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n+\n+### UAT Status (Wave 2.1)\n+- Current UAT decision: **NO-GO** pending remediation for:\n+  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n+  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n+\n+## Context Adapter Closure Check (2026-02-17)\n+\n+Task `302fcffa-863d-4d90-b017-08369fad3f73` is **NO-GO** for verifier wave. Closure audit found missing commit/push evidence and no remote head for `feature/context-adapter-foundation`; current branch state shows uncommitted context files. Recommended status remains `in_progress` until commit/push/remote-ref and test-output artifacts are attached in the task note.\n+\n+\n+## Context Artifact Unblocked (2026-02-17)\n+\n+1. Context adapter branch `feature/context-adapter-foundation` is now committed and pushed.\n+2. Commit: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8`.\n+3. Remote ref confirmed: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8 refs/heads/feature/context-adapter-foundation`.\n+4. Verification rerun passed: `pnpm run test -- context` and `pnpm run desktop:typecheck`.\n+5. This clears the previous commit/push/remote-ref blocker for task `302fcffa-863d-4d90-b017-08369fad3f73`; next required step is verifier closeout.\n+## Browser Sequencing Decision (2026-02-17)\n+\n+1. Browser task `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting`.\n+2. Required prerequisite state before resume:\n+   - Run-history closure task `374e17d5-6ac8-42ff-b943-66026957a892` is terminally closed with explicit GO/NO-GO.\n+   - Context task `302fcffa-863d-4d90-b017-08369fad3f73` has commit/push/remote-ref/test-output artifacts and is no longer closure-blocked.\n+3. Single next action: execute the run-history/context closure gates first, then resume browser task only after both prerequisites are satisfied.\n+\n+## Run-history Closure Check (2026-02-17)\n+\n+1. Closure audit for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` is **NO-GO**.\n+2. Current evidence confirms remote branch head exists (`feature/run-history-persistence-fix` -> `4d388ce411b3dc2b6df4591e47e67e944e7715a6`) and task note includes automated test/typecheck claims.\n+3. Blocking gaps remain: missing explicit verifier closeout record, missing manual restart persistence proof, and no independent commit-content inspection captured in this closure pass.\n+4. Required next actions: verifier closeout + manual restart artifact + inspectable commit artifact, then re-run closure check."}
{"type":"diff","v":48,"date":"2026-02-17T17:06:05.488Z","author":{"id":"user","name":"User","type":"user"},"diff":"@@ -1 +1 @@\n-## Goal\n-Close Wave 1 by verifying completed implementation tasks, unblocking the browser follow-up, and preparing a clean handoff package for your external outsourcing step.\n+## Handoff Snapshot (2026-02-17)\n@@ -4 +3 @@\n-## Tasks\n-- [/] Verify and close run-history task\n+This section is the current source of truth for handoff. Historical sections below are retained for audit trail but are superseded by this snapshot.\n@@ -7 +5 @@\n-- [x] Verify and close context-adapter task\n-\n-- [x] [Resolve browser-task sequencing and next action](intent://local/task/14bc6806-c210-44a3-8acc-ebca2014ea78)\n-\n-- [x] Prepare external-outsource handoff package\n-\n-## Acceptance Criteria\n-1. Run-history and context tasks both receive verifier outcomes with explicit GO/NO-GO.\n-2. Browser task state is unambiguous (resumed with prerequisites met or explicitly blocked).\n-3. External handoff instructions are ready for you to use immediately.\n-4. Spec reflects the current source of truth for task states and next actions.\n-\n-## Non-goals\n-1. Implementing new feature code in this coordination pass.\n-2. Changing historical notes outside status/result corrections.\n-3. Performing external outsourcing actions directly.\n-\n-## Assumptions\n-1. External outsourcing execution is handled by you, not by in-system agents.\n-2. Existing implementation evidence in run-history/context notes is substantially complete and needs verification closure.\n-3. Browser task sequencing depends on confirmed closure of context/run-history verification (confirm?).\n-\n-## Verification Plan\n-1. Delegate verifier for run-history task and record result.\n-2. Ensure context task artifact completeness, then delegate verifier and record result.\n-3. Reconcile browser-task status based on verifier outputs.\n-4. Deliver explicit external handoff instructions for changes-tab then PR-workflow tasks.\n-\n-## Rollback Plan\n-1. If verifier returns NO-GO, revert task status from `review_required/complete` to `in_progress`.\n-2. Add remediation items to the relevant task note and spec.\n-3. Re-run verification only after remediation evidence is posted.\n-\n-\n-## Stall Recovery Status (2026-02-17)\n-\n-1. Closure task `374e17d5-6ac8-42ff-b943-66026957a892` is still in `in_progress` with no additional task-note updates after initial kickoff; treat as stalled.\n-2. Closure task `76dd55a0-e87d-4fc5-82bc-7878efc81bd5` is complete with NO-GO findings: context task `302fcffa-863d-4d90-b017-08369fad3f73` remains blocked by missing commit/push/remote-ref artifacts.\n-3. Browser sequencing task `14bc6806-c210-44a3-8acc-ebca2014ea78` and external handoff task `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` have not started.\n-4. Proposed recovery wave:\n-   a. Replace stalled run-history closure execution on `374e17d5-6ac8-42ff-b943-66026957a892`.\n-   b. Run `14bc6806-c210-44a3-8acc-ebca2014ea78` to lock browser next-action state from current evidence.\n-   c. Run `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` to produce your external handoff packet.\n-5. Verifier dispatch will follow each recovered task completion.\n-\n-## Recovery Wave Dispatch (2026-02-17)\n-\n-1. Stalled execution on `374e17d5-6ac8-42ff-b943-66026957a892` was replaced with new implementor agent `agent-4e138d04-03c3-4e22-b0c8-b6f34cfd5bf2`.\n-2. Browser sequencing task `14bc6806-c210-44a3-8acc-ebca2014ea78` dispatched to implementor agent `agent-158d1a82-e398-494f-81ca-99267d8f981c`.\n-3. External handoff package task `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` dispatched to implementor agent `agent-735d2a05-9c47-45fc-bae9-bf5f158c7cc1`.\n-4. All three were dispatched in one grouped wave with `wait_mode=after_all`; next step is verifier follow-on immediately when this wave returns.\n-\n-## Run-history Ownership Enforcement (2026-02-17)\n-\n-1. Conflict detected: two active agents on task `374e17d5-6ac8-42ff-b943-66026957a892` (`agent-1b62073a-7ae5-486d-8688-01c2213e7d5c` and `agent-4e138d04-03c3-4e22-b0c8-b6f34cfd5bf2`).\n-2. Coordinator enforced single-owner execution: `agent-4e138d04-03c3-4e22-b0c8-b6f34cfd5bf2` is authoritative owner.\n-3. Prior agent was issued a high-priority stand-down instruction and its future outputs are non-authoritative for closure decisions.\n-\n-## Commit/Push Recovery Dispatch (2026-02-17)\n-\n-1. Processed recovery-wave events: `14bc6806-c210-44a3-8acc-ebca2014ea78` and `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` completed.\n-2. Top task statuses updated to reflect current state (`run-history` in progress, `context-closure` done, `external handoff package` done).\n-3. High-priority implementor dispatch started for `302fcffa-863d-4d90-b017-08369fad3f73` to commit/push current uncommitted context-adapter work and attach full artifact evidence for PR handoff.\n-\n-## Commit/Push Recovery Result (2026-02-17)\n-\n-1. Context-adapter branch `feature/context-adapter-foundation` is now committed and pushed.\n-2. Commit: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8` (`feat: add context adapter foundation`).\n-3. Remote ref verified: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8\\trefs/heads/feature/context-adapter-foundation`.\n-4. Required validations recorded as passing (`pnpm run test -- context`, `pnpm run desktop:typecheck`).\n-5. Working tree is clean on current branch; task `302fcffa-863d-4d90-b017-08369fad3f73` moved to `review_required` for verifier closeout.\n-## Goal\n-Restore a healthy Git baseline, recover the pre-reset feature work, and resume implementation from a clean, pushable branch.\n-\n-## Tasks\n-- [x] [Recover pre-reset work into current workspace](intent://local/task/7a006ca5-e5df-4dfd-8134-70db25f8203c)\n-\n-- [x] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n-\n-- [/] [Outsource independent PR work and resume primary feature](intent://local/task/d7a5cef2-5289-444a-a5b7-21822d012663)\n-\n-\n-- [x] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n-## Acceptance Criteria\n-1. Pre-reset work is restored into the active workspace branch without data loss.\n-2. Git health checks pass with no garbage warnings or invalid refs.\n-3. Required stale session artifacts are cleaned locally/remotely without deleting active branches.\n-4. At least one feature task is actively resumed with clear delegation.\n-5. Outsourceable PR candidates and handoffs are documented.\n-\n-## Non-goals\n-1. Rewriting published `main` history.\n-2. Deleting non-session branches without explicit approval.\n-3. Bundling all remaining feature work into one large PR.\n-\n-## Assumptions\n-1. We should restore the full pre-reset branch tip (`fe3e028e5b5e7d7d273e011d5ae7e5483640b94c`) (confirm?).\n-2. Remote cleanup may delete only session branches (`codex/*`, `git-stability-incident`, `unblock-wave-1-verification`) (confirm?).\n-3. Highest-priority resume target remains run-history persistence (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) (confirm?).\n-\n-## Verification Plan\n-1. Run recovery and Git-health commands from Task 1 and Task 2.\n-2. Validate push capability from the recovered branch.\n-3. Verify spec includes outsourcing handoffs and delegated resume task.\n-\n-## Rollback Plan\n-1. If the recovery branch is wrong, delete only the recovery branch and refetch from backup path.\n-2. If cleanup removes a needed branch, recreate from backup SHA and restore the remote ref.\n-3. If push fails, use documented fresh-clone fallback without changing recovered branch content.\n-\n-\n-\n-\n-## Recovery Checkpoint (2026-02-17)\n-\n-1. Git branch tracking is now healthy on the active branch: `feature/run-history-persistence...origin/feature/run-history-persistence`.\n-2. Recovery content exists on remote at `origin/feature/run-history-persistence` -> `be71982fc9e214b689eb529d3e9b2cb1f4d9b99c`.\n-3. Local Git health checks remain clean (`garbage: 0`, no invalid-ref errors).\n-4. Stale `origin/codex/*` branches used during incident handling were removed.\n-5. Residual risk: direct large-pack pushes still intermittently fail with remote unpack/inflate errors; fallback publish path is the current mitigation.\n-\n-\n-## Branch Protection Update (2026-02-17)\n-\n-Direct pushes to `main` are blocked by repository rules (`GH013`); integration to `main` must go through pull requests. Effective workflow: continue work on feature branches, open PRs targeting `main`, merge via GitHub, then sync local `main` from `origin/main`. This replaces any direct-push-to-main assumption.\n-\n-## Integration Gate (2026-02-17)\n-\n-1. PR #2 is open: https://github.com/gannonh/kata-cloud/pull/2 (`feature/run-history-persistence` -> `main`).\n-2. This PR merge is the required gate before outsourcing additional implementation work.\n-3. After merge, sync local `main` from `origin/main` and create all new work branches from that updated `main`.\n-4. Do not stack new feature branches on top of recovery branches.\n-\n-## Integration Gate Result (2026-02-17)\n-\n-1. PR #2 (`feature/run-history-persistence` -> `main`) merged at `2026-02-17T03:45:07Z`.\n-2. Merge commit on `main`: `1cadf1894f3a37d520c106af590ef102f8ce8f77`.\n-3. Gate is cleared: Wave 1 outsourcing can proceed.\n-4. All new work must branch from updated `main` and return via short-lived PRs.\n-\n-## Wave 1 Execution Note (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) encountered overlap with in-progress browser edits in shared workspace.\n-2. Coordinator approved isolated execution in a clean temporary worktree from updated `main` on `feature/run-history-persistence-fix`.\n-3. Task agent was re-notified and resumed with strict non-overlap constraints.\n-\n-## Wave 1 Conflict Handling (2026-02-17)\n-\n-1. Parallel file overlap occurred between browser preview and context adapter tasks on `src/shared/state.ts` and `src/shared/state.test.ts`.\n-2. Scope-separation rule applied: context task owns first-pass shared-state edits; browser task is paused for those files.\n-3. Browser task resumes on updated `main` after context task lands to avoid mixed-scope commits and preserve independent PR hygiene.\n-\n-## Wave 1 Status (2026-02-17)\n-\n-1. Browser preview task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) is implemented and currently `review_required`; automated checks passed, manual localhost clickthrough remains for verifier.\n-2. Context adapter task (`302fcffa-863d-4d90-b017-08369fad3f73`) hit branch mismatch and was corrected to continue in isolated `feature/context-adapter-foundation` flow from updated `main`.\n-3. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) remains in progress in isolated branch/worktree flow.\n-4. Wave 1 verifier delegation will start only after tasks 2 and 3 complete.\n-\n-## Wave 1 Correction (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was reopened because prior completion lacked implementation artifacts (no commit hash/test evidence/files-changed summary in task note).\n-2. Task status reset to `in_progress` and re-instruction sent for clean-branch execution with mandatory evidence before verification.\n-\n-## Wave 1 Recovery Action (2026-02-17)\n-\n-1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was re-delegated to replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` after repeated non-progress responses.\n-2. Browser task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) reset to `waiting` pending clean scope-separation with context shared-state edits.\n-3. Context task (`302fcffa-863d-4d90-b017-08369fad3f73`) instructed to finalize only on isolated `feature/context-adapter-foundation` with explicit artifacts.\n-\n-## Wave 1 Ownership Clarification (2026-02-17)\n-\n-Run-history replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` is designated active owner and instructed to continue without waiting on prior stalled agent assignment.\n-\n-## Wave 1 Cutover Control (2026-02-17)\n-\n-1. Repeated stale/duplicate run-history agent events triggered forced execution cutover.\n-2. Original run-history agent was instructed to stand down; replacement agent remains sole owner.\n-3. Context task switched to execute-only mode with required artifact-based completion.\n-4. Browser task remains `waiting` until context/run-history complete and verifier can evaluate cross-task integration safely.\n-\n-## Wave 1 Execution Control Update (2026-02-17)\n-\n-1. Duplicate run-history execution was re-confirmed; original agent `agent-eadf6ee1-4de3-4edc-af4b-6f70458f1a9d` was instructed again to stand down.\n-2. Replacement run-history agent `agent-e92c73d0-56ef-440e-a009-661b7c399382` remains sole owner with mandatory artifact completion requirements.\n-3. Context agent `agent-8e0a4569-29d6-44b4-ac55-5ad7f2f7baa4` was re-instructed to execute-only on isolated `feature/context-adapter-foundation` scope.\n-4. Browser task remains `waiting` until context + run-history complete and verifier wave starts.\n-\n-## Codex Outsource Queue (2026-02-17)\n-\n-1. Active: `c5f554ea-2059-40d2-9fb2-bf522a590cae` (run-history persistence)  replacement implementor executing.\n-2. Active: `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter)  implementor executing in isolated branch.\n-3. Waiting: `22770f24-a79b-4d14-9add-14ffd1447b2f` (browser preview)  resumes after context/run-history are complete and verifier starts.\n-4. Ready to outsource now: `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)  independent PR candidate from updated `main`.\n-5. Sequence after changes tab: `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR workflow).\n-\n-## Wave 1 Status Refresh (2026-02-17)\n-\n-1. `c5f554ea-2059-40d2-9fb2-bf522a590cae` now has implementation artifacts (commit `4d388ce411b3dc2b6df4591e47e67e944e7715a6`, branch `feature/run-history-persistence-fix`, required tests/typecheck pass) and is moved to `review_required`.\n-2. `302fcffa-863d-4d90-b017-08369fad3f73` is `review_required`; coordinator requested explicit commit/push evidence before verifier handoff.\n-3. `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting` until cross-task shared-state sequencing is verified.\n-4. Stale original run-history agent remains standdown-only; replacement owner output is authoritative.\n-\n-## Wave 1 Verification Start (2026-02-17)\n-\n-1. Verifier wave started for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` via verifier agent `agent-40059ba1-1b38-4d89-967a-90d02f63db38`.\n-2. Context task `302fcffa-863d-4d90-b017-08369fad3f73` is awaiting final commit/push artifact append before verifier dispatch.\n-3. Browser task remains waiting until run-history/context verification results are in.\n-## Outsource Candidates And Handoffs (2026-02-17)\n-1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n-Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n-2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n-Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n-3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n-Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n-4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n-## Goal (Git Stability Incident)\n-Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n-\n-## Tasks (Git Stability Incident)\n-- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n-\n-- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n-\n-- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n-\n-- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n-\n-## Acceptance Criteria (Git Stability Incident)\n-1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n-2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n-3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n-4. Independent verifier issues explicit GO before feature work resumes.\n-\n-## Non-goals (Git Stability Incident)\n-1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n-2. Rewriting the entire repository history.\n-3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n-\n-## Assumptions (Git Stability Incident)\n-1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n-2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n-3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n-\n-## Verification Plan (Git Stability Incident)\n-1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n-2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n-3. Resume feature tasks only after explicit GO is captured in `spec`.\n-\n-## Rollback Plan (Git Stability Incident)\n-1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n-2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n-3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n-\n----\n-\n-\n-\n-## Incident Status (2026-02-17)\n-\n-1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n-2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n-3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n-4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n-5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n-6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n-7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n-8. Feature work may resume.\n-\n-## Goal (Wave 2.1 UAT Remediation)\n-Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n-\n-## Tasks (Wave 2.1 UAT Remediation)\n-- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n-\n-- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n-\n-- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n-\n-## Acceptance Criteria (Wave 2.1 UAT Remediation)\n-1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n-2. Orchestrator run history (not latest-only) is visible and persists across restart.\n-3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n-4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n-\n-## Non-goals (Wave 2.1 UAT Remediation)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Adding in-app browser preview.\n-4. Context adapter/provider integration expansion.\n-\n-## Assumptions (Wave 2.1 UAT Remediation)\n-1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n-2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n-3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n-\n-## Verification Plan (Wave 2.1 UAT Remediation)\n-1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n-2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n-3. Record final remediation GO/NO-GO in `spec` with residual risks.\n-\n-## Rollback Plan (Wave 2.1 UAT Remediation)\n-1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n-2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n-3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n-\n----\n-\n-\n-## Goal (Wave 2.1 Orchestrator Planning Loop)\n-Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n-\n-## Tasks (Wave 2.1 Orchestrator Planning Loop)\n-- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n-\n-- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n-\n-- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n-\n-## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n-1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n-2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n-3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n-4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n-\n-## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing real provider authentication/runtime.\n-2. Building Changes-tab diff/PR workflows.\n-3. Building in-app browser preview.\n-4. Integrating context adapter providers beyond current local flow.\n-\n-## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n-1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n-2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n-3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n-\n-## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n-2. Run `pnpm run desktop:typecheck` after each wave.\n-3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n-\n-## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n-1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n-2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n-3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n-\n----\n-\n-\n-\n-## Wave 2.1 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Wave 2.1 tasks are complete:\n-  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n-  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n-  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n-- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n-- Wave 2.1 acceptance criteria are satisfied:\n-  1. Prompt-triggered run lifecycle: PASS.\n-  2. Spec draft synthesis/apply path: PASS.\n-  3. Implement/Verify/Debug delegation + timeline: PASS.\n-  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n-- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n-- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n-\n-## UAT Plan (Wave 2.1)\n-\n-Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n-\n-### Preconditions\n-1. App launches in dev mode.\n-2. You are in a workspace with the `Orchestrator` view available.\n-3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n-\n-### Test Cases\n-1. Happy-path run lifecycle\n-- Action: submit a normal orchestrator prompt.\n-- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n-\n-2. Spec draft generation + apply\n-- Action: from a successful run, apply the generated draft to spec.\n-- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n-\n-3. Delegation timeline visibility\n-- Action: inspect delegated tasks for the run.\n-- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n-\n-4. Failure-path behavior\n-- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n-- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n-\n-5. Session persistence sanity\n-- Action: reopen the app/workspace after at least one successful and one failed run.\n-- Expect: orchestrator run history (including timeline/status) is still present.\n-\n-### Result Recording\n-For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n-\n-### Exit Criteria\n-- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n-- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n-## Goal (Wave 1.6 Blocker Burn-down)\n-Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n-\n-## Tasks (Wave 1.6 Blocker Burn-down)\n-\n-- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n-\n-- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n-\n-- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n-\n-- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n-\n-- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n-\n-## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n-1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n-2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n-3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n-4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n-\n-## Non-goals (Wave 1.6 Blocker Burn-down)\n-1. Changing quality-gate thresholds.\n-2. Reworking CI/Dependabot architecture beyond required alignment updates.\n-3. Shipping unrelated product features.\n-\n-## Assumptions (Wave 1.6 Blocker Burn-down)\n-1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n-2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n-3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n-\n-## Verification Plan (Wave 1.6 Blocker Burn-down)\n-1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n-2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n-3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n-\n-## Rollback Plan (Wave 1.6 Blocker Burn-down)\n-1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n-2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n-3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n-\n----\n-\n-\n-\n-\n-## Wave 1.6 Final Status (2026-02-16)\n-\n-- Decision: **GO**.\n-- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n-- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n-- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n-- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n-## Goal (Wave 1.5 Quality Gates)\n-Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n-\n-## Tasks (Wave 1.5 Quality Gates)\n-- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n-\n-- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n-\n-- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n-\n-- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n-\n-- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n-\n-## Acceptance Criteria (Wave 1.5 Quality Gates)\n-1. Lint checks are standardized and runnable locally and in CI.\n-2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n-3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n-4. Dependabot is configured for npm and GitHub Actions update automation.\n-5. Final verification provides an explicit GO/NO-GO with blocker severity.\n-\n-## Non-goals (Wave 1.5 Quality Gates)\n-1. Refactoring product features unrelated to quality-gate enablement.\n-2. Introducing deployment/release automation beyond CI validation.\n-3. Replacing package manager or test framework.\n-\n-## Assumptions (Wave 1.5 Quality Gates)\n-1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n-2. CI runs on `pull_request` and `push` to `main`.\n-3. Dependabot cadence is weekly for both npm and GitHub Actions.\n-\n-## Verification Plan (Wave 1.5 Quality Gates)\n-1. Run all local quality-gate commands after implementation.\n-2. Validate CI workflow trigger paths for PR and merge events.\n-3. Confirm Dependabot config parses and targets both ecosystems.\n-\n-## Rollback Plan (Wave 1.5 Quality Gates)\n-1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n-2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n-3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n-\n-\n-## Goal\n-Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n-\n-\n-## Tasks (Wave 1 Remediation)\n-1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n-2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n-3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n-\n-## Acceptance Criteria (Wave 1 Remediation)\n-1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n-2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n-3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n-\n-## Verification Plan (Wave 1 Remediation)\n-1. `pnpm run test -- notes`\n-2. `pnpm run test -- task-parser`\n-3. `pnpm install`\n-4. `pnpm run test -- space`\n-5. `pnpm run test -- git`\n-6. `pnpm run dev` plus manual restart persistence check.\n-\n-## Wave 1 Gate Status (2026-02-16)\n-- Decision: **NO-GO** for Wave 2.\n-- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n-- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n-- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n-- `Electron failed to install correctly` is resolved as the active failure signature.\n-- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n-- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n-- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n-- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n-- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n-- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n-- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n-- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n-- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n-- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n-- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n-- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n-- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n-\n-\n-\n-## Tasks (Wave 1.1 Fixes)\n-\n-- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n-\n-- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n-\n-- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n-\n-## Tasks (Wave 1.2 Runtime Remediation)\n-\n-- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n-\n-- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n-\n-## Tasks (Wave 1.3 Git Hygiene)\n-\n-- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n-\n-- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n-\n-## Tasks (Wave 1.4 Runtime Launch Stabilization)\n-\n-- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n-\n-- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n-\n-## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n-1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n-2. Runtime launch path is deterministic and documented with reproducible evidence.\n-3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n-\n-## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n-1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n-2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n-3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n-## Tasks\n-- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n-\n-- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n-\n-- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n-\n-- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n-\n-- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n-\n-\n-- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n-\n-- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n-\n-- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n-\n-- [/] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n-\n-- [/] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n-\n-\n-- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n-## Acceptance Criteria\n-1. A user can install and run the app, create a space, and reopen it later with full state restored.\n-2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n-3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n-4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n-5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n-6. The app provides an in-app browser preview for localhost development targets.\n-7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n-8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n-\n-## Non-goals\n-- Production authentication, billing, licensing, or multi-tenant cloud backend.\n-- Full marketplace for custom specialists.\n-- Full CI/CD orchestration or deployment management from within the app.\n-- Large-scale distributed indexing or enterprise ingestion pipelines.\n-\n-## Assumptions\n-- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n-- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n-- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n-- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n-- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n-\n-## Verification Plan\n-1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n-2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n-3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n-\n-## Rollback Plan\n-1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n-2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n-3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n-\n-## UAT Results (Wave 2.1)\n-\n-### Case 1: Happy-path run lifecycle\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16):\n-  - Run reached terminal success (`Run ... is completed`).\n-  - Lifecycle shows expected progression: `queued -> running -> completed`.\n-  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n-  - Draft generation state present: `Draft: ready for run ...`.\n-\n-### Case 2: Spec draft generation + apply\n-- Result: **PASS**\n-- Evidence (user screenshot, 2026-02-16 4:07 PM):\n-  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n-  - Apply action succeeded (`Applied draft from run ...`).\n-  - Spec Markdown/Preview panes show updated draft-derived content.\n-  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n-\n-### Case 3: Delegation timeline visibility\n-- Result: **PASS**\n-- Evidence (same UAT screenshots):\n-  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n-  - Each row shows explicit transition chain with terminal `completed` state.\n-  - Run-level lifecycle and per-task timeline information are both rendered together.\n-\n-### Case 4: Failure-path behavior\n-- Result: **FAIL**\n-- Evidence (user screenshot, 2026-02-16 4:10 PM):\n-  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n-  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n-  - Delegated tasks all completed; no failure message surfaced.\n-- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n-- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n-\n-### Case 5: Session persistence sanity\n-- Result: **PARTIAL / FAIL**\n-- PASS: latest orchestrator run state persists across app restart.\n-- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n-\n-### Additional UAT Observation\n-- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n-- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n-\n-### UAT Status (Wave 2.1)\n-- Current UAT decision: **NO-GO** pending remediation for:\n-  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n-  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n-\n-## Context Adapter Closure Check (2026-02-17)\n-\n-Task `302fcffa-863d-4d90-b017-08369fad3f73` is **NO-GO** for verifier wave. Closure audit found missing commit/push evidence and no remote head for `feature/context-adapter-foundation`; current branch state shows uncommitted context files. Recommended status remains `in_progress` until commit/push/remote-ref and test-output artifacts are attached in the task note.\n-\n-\n-## Context Artifact Unblocked (2026-02-17)\n-\n-1. Context adapter branch `feature/context-adapter-foundation` is now committed and pushed.\n-2. Commit: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8`.\n-3. Remote ref confirmed: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8 refs/heads/feature/context-adapter-foundation`.\n-4. Verification rerun passed: `pnpm run test -- context` and `pnpm run desktop:typecheck`.\n-5. This clears the previous commit/push/remote-ref blocker for task `302fcffa-863d-4d90-b017-08369fad3f73`; next required step is verifier closeout.\n-## Browser Sequencing Decision (2026-02-17)\n-\n-1. Browser task `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting`.\n-2. Required prerequisite state before resume:\n-   - Run-history closure task `374e17d5-6ac8-42ff-b943-66026957a892` is terminally closed with explicit GO/NO-GO.\n-   - Context task `302fcffa-863d-4d90-b017-08369fad3f73` has commit/push/remote-ref/test-output artifacts and is no longer closure-blocked.\n-3. Single next action: execute the run-history/context closure gates first, then resume browser task only after both prerequisites are satisfied.\n-\n-## Run-history Closure Check (2026-02-17)\n-\n-1. Closure audit for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` is **NO-GO**.\n-2. Current evidence confirms remote branch head exists (`feature/run-history-persistence-fix` -> `4d388ce411b3dc2b6df4591e47e67e944e7715a6`) and task note includes automated test/typecheck claims.\n-3. Blocking gaps remain: missing explicit verifier closeout record, missing manual restart persistence proof, and no independent commit-content inspection captured in this closure pass.\n-4. Required next actions: verifier closeout + manual restart artifact + inspectable commit artifact, then re-run closure check.\n+### Repository Baseline\n+1. Local branch is synced to `main` at `96b3538647818fd24765bfa5705052de7ff57a49`.\n+2. Working tree is clean (`git status -sb` -> `## main...origin/main`).\n+3. Branch strategy moving forward:\n+   - Start each new task branch from updated `origin/main`.\n+   - Keep task scope isolated per PR.\n+   - Avoid stacking new work on historical feature branches.\n+\n+### Completed Since Last Handoff\n+1. [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d) is complete and merged via PR `#11` (merge commit `8269445221475d042b9d3c42b753934c1a9e4223`).\n+2. [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c) is complete and merged via PR `#18` (merge commit `96b3538647818fd24765bfa5705052de7ff57a49`).\n+\n+### Open Tasks\n+1. [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+   - Status: `in_progress`\n+   - Blockers: verifier closeout not recorded, manual restart evidence missing, independent inspectable commit evidence still required in closure context.\n+2. [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+   - Status: `review_required`\n+   - Current evidence: commit/push/test artifacts posted on `feature/context-adapter-foundation` (`ac97a5cf0ccc0191e3d45453a319cbeb268664c8`).\n+   - Next gate: verifier closeout GO/NO-GO.\n+3. [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+   - Status: `waiting`\n+   - Dependency: run-history and context closure must be finalized first.\n+4. [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+   - Status: `not_started`\n+   - Dependency: proceed after browser/context/run-history closure sequence is stable.\n+\n+### Exact Next Steps\n+1. Run verifier closure for context task `302fcffa-863d-4d90-b017-08369fad3f73` and record explicit GO/NO-GO.\n+2. Run verifier closure for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` with:\n+   - manual restart proof (multi-run history persists),\n+   - independent commit inspection evidence in current workspace context.\n+3. If both are GO, resume browser task `22770f24-a79b-4d14-9add-14ffd1447b2f` from fresh `origin/main` baseline and complete/merge.\n+4. After browser task is merged, start provider runtime task `dfb65dc8-1eb9-47f1-b95f-e22c99005ddb` on fresh `origin/main`.\n+\n+### Next Steps After Open Tasks Complete\n+1. Execute full E2E MVP verification: space creation, orchestrator run lifecycle, spec draft/apply, changes-tab diff/staging, PR creation flow, browser preview, provider runtime.\n+2. Produce final release handoff packet with validated commands, residual risks, and recommended post-MVP backlog order.\n+\n+## Goal\n+Close Wave 1 by verifying completed implementation tasks, unblocking the browser follow-up, and preparing a clean handoff package for your external outsourcing step.\n+\n+## Tasks\n+- [/] Verify and close run-history task\n+\n+- [x] Verify and close context-adapter task\n+\n+- [x] [Resolve browser-task sequencing and next action](intent://local/task/14bc6806-c210-44a3-8acc-ebca2014ea78)\n+\n+- [x] Prepare external-outsource handoff package\n+\n+## Acceptance Criteria\n+1. Run-history and context tasks both receive verifier outcomes with explicit GO/NO-GO.\n+2. Browser task state is unambiguous (resumed with prerequisites met or explicitly blocked).\n+3. External handoff instructions are ready for you to use immediately.\n+4. Spec reflects the current source of truth for task states and next actions.\n+\n+## Non-goals\n+1. Implementing new feature code in this coordination pass.\n+2. Changing historical notes outside status/result corrections.\n+3. Performing external outsourcing actions directly.\n+\n+## Assumptions\n+1. External outsourcing execution is handled by you, not by in-system agents.\n+2. Existing implementation evidence in run-history/context notes is substantially complete and needs verification closure.\n+3. Browser task sequencing depends on confirmed closure of context/run-history verification (confirm?).\n+\n+## Verification Plan\n+1. Delegate verifier for run-history task and record result.\n+2. Ensure context task artifact completeness, then delegate verifier and record result.\n+3. Reconcile browser-task status based on verifier outputs.\n+4. Deliver explicit external handoff instructions for changes-tab then PR-workflow tasks.\n+\n+## Rollback Plan\n+1. If verifier returns NO-GO, revert task status from `review_required/complete` to `in_progress`.\n+2. Add remediation items to the relevant task note and spec.\n+3. Re-run verification only after remediation evidence is posted.\n+\n+\n+## Stall Recovery Status (2026-02-17)\n+\n+1. Closure task `374e17d5-6ac8-42ff-b943-66026957a892` is still in `in_progress` with no additional task-note updates after initial kickoff; treat as stalled.\n+2. Closure task `76dd55a0-e87d-4fc5-82bc-7878efc81bd5` is complete with NO-GO findings: context task `302fcffa-863d-4d90-b017-08369fad3f73` remains blocked by missing commit/push/remote-ref artifacts.\n+3. Browser sequencing task `14bc6806-c210-44a3-8acc-ebca2014ea78` and external handoff task `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` have not started.\n+4. Proposed recovery wave:\n+   a. Replace stalled run-history closure execution on `374e17d5-6ac8-42ff-b943-66026957a892`.\n+   b. Run `14bc6806-c210-44a3-8acc-ebca2014ea78` to lock browser next-action state from current evidence.\n+   c. Run `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` to produce your external handoff packet.\n+5. Verifier dispatch will follow each recovered task completion.\n+\n+## Recovery Wave Dispatch (2026-02-17)\n+\n+1. Stalled execution on `374e17d5-6ac8-42ff-b943-66026957a892` was replaced with new implementor agent `agent-4e138d04-03c3-4e22-b0c8-b6f34cfd5bf2`.\n+2. Browser sequencing task `14bc6806-c210-44a3-8acc-ebca2014ea78` dispatched to implementor agent `agent-158d1a82-e398-494f-81ca-99267d8f981c`.\n+3. External handoff package task `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` dispatched to implementor agent `agent-735d2a05-9c47-45fc-bae9-bf5f158c7cc1`.\n+4. All three were dispatched in one grouped wave with `wait_mode=after_all`; next step is verifier follow-on immediately when this wave returns.\n+\n+## Run-history Ownership Enforcement (2026-02-17)\n+\n+1. Conflict detected: two active agents on task `374e17d5-6ac8-42ff-b943-66026957a892` (`agent-1b62073a-7ae5-486d-8688-01c2213e7d5c` and `agent-4e138d04-03c3-4e22-b0c8-b6f34cfd5bf2`).\n+2. Coordinator enforced single-owner execution: `agent-4e138d04-03c3-4e22-b0c8-b6f34cfd5bf2` is authoritative owner.\n+3. Prior agent was issued a high-priority stand-down instruction and its future outputs are non-authoritative for closure decisions.\n+\n+## Commit/Push Recovery Dispatch (2026-02-17)\n+\n+1. Processed recovery-wave events: `14bc6806-c210-44a3-8acc-ebca2014ea78` and `1ce25d50-a2ee-49ca-9f11-aae1f2869ad5` completed.\n+2. Top task statuses updated to reflect current state (`run-history` in progress, `context-closure` done, `external handoff package` done).\n+3. High-priority implementor dispatch started for `302fcffa-863d-4d90-b017-08369fad3f73` to commit/push current uncommitted context-adapter work and attach full artifact evidence for PR handoff.\n+\n+## Commit/Push Recovery Result (2026-02-17)\n+\n+1. Context-adapter branch `feature/context-adapter-foundation` is now committed and pushed.\n+2. Commit: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8` (`feat: add context adapter foundation`).\n+3. Remote ref verified: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8\\trefs/heads/feature/context-adapter-foundation`.\n+4. Required validations recorded as passing (`pnpm run test -- context`, `pnpm run desktop:typecheck`).\n+5. Working tree is clean on current branch; task `302fcffa-863d-4d90-b017-08369fad3f73` moved to `review_required` for verifier closeout.\n+## Goal\n+Restore a healthy Git baseline, recover the pre-reset feature work, and resume implementation from a clean, pushable branch.\n+\n+## Tasks\n+- [x] [Recover pre-reset work into current workspace](intent://local/task/7a006ca5-e5df-4dfd-8134-70db25f8203c)\n+\n+- [x] [Re-establish Git hygiene and branch/worktree cleanup](intent://local/task/51039010-2109-4c7f-9a24-5cf0f968f5eb)\n+\n+- [/] [Outsource independent PR work and resume primary feature](intent://local/task/d7a5cef2-5289-444a-a5b7-21822d012663)\n+\n+\n+- [x] [Fix CI pnpm version pin for PR merge](intent://local/task/fb221374-7086-405f-a384-6fc2ac0c2eef)\n+## Acceptance Criteria\n+1. Pre-reset work is restored into the active workspace branch without data loss.\n+2. Git health checks pass with no garbage warnings or invalid refs.\n+3. Required stale session artifacts are cleaned locally/remotely without deleting active branches.\n+4. At least one feature task is actively resumed with clear delegation.\n+5. Outsourceable PR candidates and handoffs are documented.\n+\n+## Non-goals\n+1. Rewriting published `main` history.\n+2. Deleting non-session branches without explicit approval.\n+3. Bundling all remaining feature work into one large PR.\n+\n+## Assumptions\n+1. We should restore the full pre-reset branch tip (`fe3e028e5b5e7d7d273e011d5ae7e5483640b94c`) (confirm?).\n+2. Remote cleanup may delete only session branches (`codex/*`, `git-stability-incident`, `unblock-wave-1-verification`) (confirm?).\n+3. Highest-priority resume target remains run-history persistence (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) (confirm?).\n+\n+## Verification Plan\n+1. Run recovery and Git-health commands from Task 1 and Task 2.\n+2. Validate push capability from the recovered branch.\n+3. Verify spec includes outsourcing handoffs and delegated resume task.\n+\n+## Rollback Plan\n+1. If the recovery branch is wrong, delete only the recovery branch and refetch from backup path.\n+2. If cleanup removes a needed branch, recreate from backup SHA and restore the remote ref.\n+3. If push fails, use documented fresh-clone fallback without changing recovered branch content.\n+\n+\n+\n+\n+## Recovery Checkpoint (2026-02-17)\n+\n+1. Git branch tracking is now healthy on the active branch: `feature/run-history-persistence...origin/feature/run-history-persistence`.\n+2. Recovery content exists on remote at `origin/feature/run-history-persistence` -> `be71982fc9e214b689eb529d3e9b2cb1f4d9b99c`.\n+3. Local Git health checks remain clean (`garbage: 0`, no invalid-ref errors).\n+4. Stale `origin/codex/*` branches used during incident handling were removed.\n+5. Residual risk: direct large-pack pushes still intermittently fail with remote unpack/inflate errors; fallback publish path is the current mitigation.\n+\n+\n+## Branch Protection Update (2026-02-17)\n+\n+Direct pushes to `main` are blocked by repository rules (`GH013`); integration to `main` must go through pull requests. Effective workflow: continue work on feature branches, open PRs targeting `main`, merge via GitHub, then sync local `main` from `origin/main`. This replaces any direct-push-to-main assumption.\n+\n+## Integration Gate (2026-02-17)\n+\n+1. PR #2 is open: https://github.com/gannonh/kata-cloud/pull/2 (`feature/run-history-persistence` -> `main`).\n+2. This PR merge is the required gate before outsourcing additional implementation work.\n+3. After merge, sync local `main` from `origin/main` and create all new work branches from that updated `main`.\n+4. Do not stack new feature branches on top of recovery branches.\n+\n+## Integration Gate Result (2026-02-17)\n+\n+1. PR #2 (`feature/run-history-persistence` -> `main`) merged at `2026-02-17T03:45:07Z`.\n+2. Merge commit on `main`: `1cadf1894f3a37d520c106af590ef102f8ce8f77`.\n+3. Gate is cleared: Wave 1 outsourcing can proceed.\n+4. All new work must branch from updated `main` and return via short-lived PRs.\n+\n+## Wave 1 Execution Note (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) encountered overlap with in-progress browser edits in shared workspace.\n+2. Coordinator approved isolated execution in a clean temporary worktree from updated `main` on `feature/run-history-persistence-fix`.\n+3. Task agent was re-notified and resumed with strict non-overlap constraints.\n+\n+## Wave 1 Conflict Handling (2026-02-17)\n+\n+1. Parallel file overlap occurred between browser preview and context adapter tasks on `src/shared/state.ts` and `src/shared/state.test.ts`.\n+2. Scope-separation rule applied: context task owns first-pass shared-state edits; browser task is paused for those files.\n+3. Browser task resumes on updated `main` after context task lands to avoid mixed-scope commits and preserve independent PR hygiene.\n+\n+## Wave 1 Status (2026-02-17)\n+\n+1. Browser preview task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) is implemented and currently `review_required`; automated checks passed, manual localhost clickthrough remains for verifier.\n+2. Context adapter task (`302fcffa-863d-4d90-b017-08369fad3f73`) hit branch mismatch and was corrected to continue in isolated `feature/context-adapter-foundation` flow from updated `main`.\n+3. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) remains in progress in isolated branch/worktree flow.\n+4. Wave 1 verifier delegation will start only after tasks 2 and 3 complete.\n+\n+## Wave 1 Correction (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was reopened because prior completion lacked implementation artifacts (no commit hash/test evidence/files-changed summary in task note).\n+2. Task status reset to `in_progress` and re-instruction sent for clean-branch execution with mandatory evidence before verification.\n+\n+## Wave 1 Recovery Action (2026-02-17)\n+\n+1. Run-history task (`c5f554ea-2059-40d2-9fb2-bf522a590cae`) was re-delegated to replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` after repeated non-progress responses.\n+2. Browser task (`22770f24-a79b-4d14-9add-14ffd1447b2f`) reset to `waiting` pending clean scope-separation with context shared-state edits.\n+3. Context task (`302fcffa-863d-4d90-b017-08369fad3f73`) instructed to finalize only on isolated `feature/context-adapter-foundation` with explicit artifacts.\n+\n+## Wave 1 Ownership Clarification (2026-02-17)\n+\n+Run-history replacement implementor `agent-e92c73d0-56ef-440e-a009-661b7c399382` is designated active owner and instructed to continue without waiting on prior stalled agent assignment.\n+\n+## Wave 1 Cutover Control (2026-02-17)\n+\n+1. Repeated stale/duplicate run-history agent events triggered forced execution cutover.\n+2. Original run-history agent was instructed to stand down; replacement agent remains sole owner.\n+3. Context task switched to execute-only mode with required artifact-based completion.\n+4. Browser task remains `waiting` until context/run-history complete and verifier can evaluate cross-task integration safely.\n+\n+## Wave 1 Execution Control Update (2026-02-17)\n+\n+1. Duplicate run-history execution was re-confirmed; original agent `agent-eadf6ee1-4de3-4edc-af4b-6f70458f1a9d` was instructed again to stand down.\n+2. Replacement run-history agent `agent-e92c73d0-56ef-440e-a009-661b7c399382` remains sole owner with mandatory artifact completion requirements.\n+3. Context agent `agent-8e0a4569-29d6-44b4-ac55-5ad7f2f7baa4` was re-instructed to execute-only on isolated `feature/context-adapter-foundation` scope.\n+4. Browser task remains `waiting` until context + run-history complete and verifier wave starts.\n+\n+## Codex Outsource Queue (2026-02-17)\n+\n+1. Active: `c5f554ea-2059-40d2-9fb2-bf522a590cae` (run-history persistence)  replacement implementor executing.\n+2. Active: `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter)  implementor executing in isolated branch.\n+3. Waiting: `22770f24-a79b-4d14-9add-14ffd1447b2f` (browser preview)  resumes after context/run-history are complete and verifier starts.\n+4. Ready to outsource now: `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)  independent PR candidate from updated `main`.\n+5. Sequence after changes tab: `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR workflow).\n+\n+## Wave 1 Status Refresh (2026-02-17)\n+\n+1. `c5f554ea-2059-40d2-9fb2-bf522a590cae` now has implementation artifacts (commit `4d388ce411b3dc2b6df4591e47e67e944e7715a6`, branch `feature/run-history-persistence-fix`, required tests/typecheck pass) and is moved to `review_required`.\n+2. `302fcffa-863d-4d90-b017-08369fad3f73` is `review_required`; coordinator requested explicit commit/push evidence before verifier handoff.\n+3. `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting` until cross-task shared-state sequencing is verified.\n+4. Stale original run-history agent remains standdown-only; replacement owner output is authoritative.\n+\n+## Wave 1 Verification Start (2026-02-17)\n+\n+1. Verifier wave started for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` via verifier agent `agent-40059ba1-1b38-4d89-967a-90d02f63db38`.\n+2. Context task `302fcffa-863d-4d90-b017-08369fad3f73` is awaiting final commit/push artifact append before verifier dispatch.\n+3. Browser task remains waiting until run-history/context verification results are in.\n+## Outsource Candidates And Handoffs (2026-02-17)\n+1. Candidate `22770f24-a79b-4d14-9add-14ffd1447b2f` (in-app browser preview)\n+Handoff: implement browser panel + nav controls; verify with `pnpm test -- browser` and localhost manual checks.\n+2. Candidate `302fcffa-863d-4d90-b017-08369fad3f73` (context adapter foundation)\n+Handoff: deliver adapter interface + filesystem provider wiring; verify with `pnpm test -- context` and orchestrator context smoke test.\n+3. Candidate `e1ea609a-a0d0-4025-92ea-f20564110a9d` (changes tab diff/staging)\n+Handoff: deliver diff inspection + selective staging UX/state; verify with `pnpm test -- changes` and manual stage/unstage flow.\n+4. Dependency guard: task `10a48d6c-9fd1-452f-aa99-3120bf23641c` (GitHub PR creation) should be sequenced after changes-tab completion.\n+## Goal (Git Stability Incident)\n+Restore reliable Git operations for all sessions in this repository before any more feature work continues.\n+\n+## Tasks (Git Stability Incident)\n+- [x] [Stabilize shared git metadata and worktree integrity](intent://local/task/d3423f2c-a203-416c-804e-b10eeb6ea728)\n+\n+- [x] [Add repository guardrails to prevent artifact contamination](intent://local/task/8de93595-feab-415f-9b77-731a6ac57abc)\n+\n+- [x] [Standardize push reliability workflow for agents](intent://local/task/68682ec1-e8c8-4178-a8aa-760ad433e4a5)\n+\n+- [x] [Independent verification and incident closeout](intent://local/task/757390f8-04c5-43e3-ab2d-5afdeae844ab)\n+\n+## Acceptance Criteria (Git Stability Incident)\n+1. Repository metadata integrity checks pass without invalid refs or garbage warnings.\n+2. Agents can publish scoped branches without recurring push/pack failures under the canonical workflow.\n+3. Guardrails prevent reintroduction of transient/cache/binary artifact pollution.\n+4. Independent verifier issues explicit GO before feature work resumes.\n+\n+## Non-goals (Git Stability Incident)\n+1. Completing remaining Wave 2.1 feature remediation while incident status is open.\n+2. Rewriting the entire repository history.\n+3. Introducing broad CI/platform architecture changes unrelated to Git stability.\n+\n+## Assumptions (Git Stability Incident)\n+1. Temporary pause on feature work is accepted until incident closeout (confirm?).\n+2. Cleaning shared local `.git` metadata (including stale worktree admin entries) is permitted (confirm?).\n+3. Fresh-clone fallback remains acceptable when deterministic push triggers are detected.\n+\n+## Verification Plan (Git Stability Incident)\n+1. Execute the first three tasks in one implementation wave with strict scope boundaries.\n+2. Run a dedicated verifier wave for independent validation and GO/NO-GO.\n+3. Resume feature tasks only after explicit GO is captured in `spec`.\n+\n+## Rollback Plan (Git Stability Incident)\n+1. Keep guardrail and workflow changes in isolated commits so they can be reverted independently.\n+2. If a guardrail blocks valid flows, disable only the offending rule and retain metadata repairs.\n+3. If reliability workflow automation is unstable, fall back to manual documented steps while retaining incident controls.\n+\n+---\n+\n+\n+\n+## Incident Status (2026-02-17)\n+\n+1. Incident is closed as **GO** on 2026-02-17 after independent re-verification.\n+2. User executed cleanup command successfully: `rmdir /Users/gannonhall/dev/kata/kata-cloud/.git/worktrees/kata-cloud/refs`.\n+3. Verifier rerun confirms AC1 pass: `git count-objects -vH` reports `garbage: 0` and `size-garbage: 0 bytes` with no garbage warning line.\n+4. `git fsck --full` has no invalid-ref errors (dangling tree notices only); `git worktree list --porcelain` matches expected active worktrees.\n+5. Task `d3423f2c-a203-416c-804e-b10eeb6ea728` (metadata stabilization) is complete.\n+6. Task `757390f8-04c5-43e3-ab2d-5afdeae844ab` (independent closeout verification) is complete with explicit **GO**.\n+7. Tasks `8de93595-feab-415f-9b77-731a6ac57abc` (guardrails) and `68682ec1-e8c8-4178-a8aa-760ad433e4a5` (push workflow) remain complete and accepted.\n+8. Feature work may resume.\n+\n+## Goal (Wave 2.1 UAT Remediation)\n+Address UAT-discovered orchestrator reliability and UX gaps so failure behavior, run-history visibility, and draft-apply behavior are predictable and verifiable.\n+\n+## Tasks (Wave 2.1 UAT Remediation)\n+- [x] [Fix deterministic failure-path trigger and error surfacing](intent://local/task/644a1d68-0637-428b-a714-28e25abb05d9)\n+\n+- [/] [Persist and display orchestrator run history across sessions](intent://local/task/c5f554ea-2059-40d2-9fb2-bf522a590cae)\n+\n+- [x] [Clarify draft-apply behavior in spec panel UX](intent://local/task/b791fa36-ae48-46a5-a7a8-d300929e1c46)\n+\n+## Acceptance Criteria (Wave 2.1 UAT Remediation)\n+1. Failure-trigger prompts produce failed terminal run state with actionable error messaging.\n+2. Orchestrator run history (not latest-only) is visible and persists across restart.\n+3. Draft-generated vs draft-applied behavior is explicit in UI and no longer ambiguous in UAT.\n+4. Targeted validation commands pass for orchestrator/notes/space plus desktop typecheck.\n+\n+## Non-goals (Wave 2.1 UAT Remediation)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Adding in-app browser preview.\n+4. Context adapter/provider integration expansion.\n+\n+## Assumptions (Wave 2.1 UAT Remediation)\n+1. Draft application remains an explicit user action (not auto-apply) for this remediation wave (confirm?).\n+2. Deterministic local failure trigger remains keyword-based for UAT validation (confirm?).\n+3. Run-history retention may be bounded (for example latest N runs) if clearly documented.\n+\n+## Verification Plan (Wave 2.1 UAT Remediation)\n+1. Execute each remediation task with task-level verifier GO/NO-GO before moving to the next.\n+2. Re-run a focused UAT subset (Cases 4 and 5 plus draft-apply clarity check) after task completion.\n+3. Record final remediation GO/NO-GO in `spec` with residual risks.\n+\n+## Rollback Plan (Wave 2.1 UAT Remediation)\n+1. Keep remediation changes scoped by concern (failure-path logic, run-history view, draft UX copy/state) for selective rollback.\n+2. If history rendering introduces instability, temporarily revert to latest-run view while preserving persisted data.\n+3. If failure-trigger logic regresses normal runs, disable deterministic trigger check and restore prior run path pending fix.\n+\n+---\n+\n+\n+## Goal (Wave 2.1 Orchestrator Planning Loop)\n+Deliver a working orchestrator flow where a user prompt can produce a spec draft, create specialist tasks, and surface delegation status in-app.\n+\n+## Tasks (Wave 2.1 Orchestrator Planning Loop)\n+- [x] [Add orchestrator run trigger and state lifecycle](intent://local/task/2e72faa0-bfac-4bf7-928e-c9dea128bc20)\n+\n+- [x] [Implement spec-draft synthesis from orchestrator runs](intent://local/task/5eda575f-6be5-4c03-a27f-ae1ca6b2b797)\n+\n+- [x] [Wire specialist task delegation and execution timeline](intent://local/task/0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61)\n+\n+## Acceptance Criteria (Wave 2.1 Orchestrator Planning Loop)\n+1. A prompt in Orchestrator view can start and complete a tracked run with explicit lifecycle states.\n+2. Completed runs can produce and apply a spec draft through the existing spec note pathway.\n+3. Orchestrator can create/delegate Implement, Verify, and Debug specialist tasks and expose status timeline updates.\n+4. The new flow passes targeted tests and `pnpm run desktop:typecheck`.\n+\n+## Non-goals (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing real provider authentication/runtime.\n+2. Building Changes-tab diff/PR workflows.\n+3. Building in-app browser preview.\n+4. Integrating context adapter providers beyond current local flow.\n+\n+## Assumptions (Wave 2.1 Orchestrator Planning Loop)\n+1. Implementing a deterministic local orchestrator path first is acceptable before real provider runtime work (confirm?).\n+2. Existing task-note/delegation plumbing from prior waves can be reused rather than replaced.\n+3. Current renderer-first orchestration entrypoint remains in `src/main.tsx` until later extraction (confirm?).\n+\n+## Verification Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Run targeted suites after each task (`orchestrator`, `notes`, `space` patterns as scoped).\n+2. Run `pnpm run desktop:typecheck` after each wave.\n+3. Delegate a verifier agent for a Wave 2.1 GO/NO-GO checkpoint after implementation tasks complete.\n+\n+## Rollback Plan (Wave 2.1 Orchestrator Planning Loop)\n+1. Keep orchestrator changes isolated to dedicated modules/state slices so rollback can be scoped.\n+2. Revert delegation wiring independently from spec-draft generation if timeline/delegation regressions appear.\n+3. If run lifecycle destabilizes app state, disable orchestrator trigger path and retain existing stable space/spec flows.\n+\n+---\n+\n+\n+\n+## Wave 2.1 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Wave 2.1 tasks are complete:\n+  - `2e72faa0-bfac-4bf7-928e-c9dea128bc20`\n+  - `5eda575f-6be5-4c03-a27f-ae1ca6b2b797`\n+  - `0b021e2a-b94c-4dbe-a09e-1a2d9d3b8e61`\n+- Parent task `55f46e5e-e243-4efc-971b-fd5cd1504a85` is complete with integrated closeout evidence.\n+- Wave 2.1 acceptance criteria are satisfied:\n+  1. Prompt-triggered run lifecycle: PASS.\n+  2. Spec draft synthesis/apply path: PASS.\n+  3. Implement/Verify/Debug delegation + timeline: PASS.\n+  4. Targeted validation commands passed in verifier evidence (`desktop:typecheck`, `test -- orchestrator`, `test -- notes`, `test -- space`).\n+- Out-of-scope guard held for Wave 2.1 (no provider auth/runtime, PR workflow, browser preview, or context adapter scope).\n+- Residual risk: non-blocking `ReactDOMTestUtils.act` deprecation warning noise in tests.\n+\n+## UAT Plan (Wave 2.1)\n+\n+Scope: validate the delivered Wave 2.1 orchestrator flow end-to-end in the desktop UI.\n+\n+### Preconditions\n+1. App launches in dev mode.\n+2. You are in a workspace with the `Orchestrator` view available.\n+3. Existing spec note content is present (to verify non-destructive draft apply behavior).\n+\n+### Test Cases\n+1. Happy-path run lifecycle\n+- Action: submit a normal orchestrator prompt.\n+- Expect: run record appears with deterministic lifecycle progression (`queued` -> `running` -> terminal success).\n+\n+2. Spec draft generation + apply\n+- Action: from a successful run, apply the generated draft to spec.\n+- Expect: draft is visible and can be applied through the existing spec save pathway; spec content updates.\n+\n+3. Delegation timeline visibility\n+- Action: inspect delegated tasks for the run.\n+- Expect: Implement/Verify/Debug task types appear with per-task status transitions and terminal states.\n+\n+4. Failure-path behavior\n+- Action: submit a prompt designed to trigger the deterministic failure path (existing implementation uses `fail` keyword).\n+- Expect: run reaches failed terminal state with actionable error messaging; existing spec content is not corrupted.\n+\n+5. Session persistence sanity\n+- Action: reopen the app/workspace after at least one successful and one failed run.\n+- Expect: orchestrator run history (including timeline/status) is still present.\n+\n+### Result Recording\n+For each case, record: `PASS` or `FAIL`, observed behavior, and any blocker.\n+\n+### Exit Criteria\n+- UAT GO: all 5 cases pass, or only non-blocking UI wording issues remain.\n+- UAT NO-GO: any functional break in lifecycle, draft apply, delegation timeline, or failure safety.\n+## Goal (Wave 1.6 Blocker Burn-down)\n+Make the quality-gate suite pass locally and in CI by removing current typecheck failures and lifting enforced coverage results to the configured thresholds.\n+\n+## Tasks (Wave 1.6 Blocker Burn-down)\n+\n+- [x] [Resolve JSX namespace compiler failures](intent://local/task/5b77a62f-6498-4828-824d-2125eb190d7b)\n+\n+- [x] [Fix GitCli mock typing mismatches in tests](intent://local/task/2e038cd9-c58e-4aed-a0c4-9ad74f812d01)\n+\n+- [x] [Define enforceable coverage scope and command path](intent://local/task/60b297b2-5822-4b44-8d0e-d19423d31e1e)\n+\n+- [x] [Raise global coverage metrics to passing thresholds](intent://local/task/37ba3a25-ba14-415c-b029-a9c1bc73f2fe)\n+\n+- [x] [Re-run Wave 1.6 gate and issue GO/NO-GO](intent://local/task/1665fe08-0270-4fd0-b48a-f33372a3970b)\n+\n+## Acceptance Criteria (Wave 1.6 Blocker Burn-down)\n+1. `pnpm run desktop:typecheck` exits `0` with no `TS2503` or `TS2739` failures.\n+2. `pnpm run test --coverage` exits `0` with thresholds enforced at `80/70/80/80`.\n+3. CI workflow command path remains aligned to local gates (`lint`, `desktop:typecheck`, `test --coverage`).\n+4. Final verification note records an explicit GO/NO-GO and severity-ranked residual risks.\n+\n+## Non-goals (Wave 1.6 Blocker Burn-down)\n+1. Changing quality-gate thresholds.\n+2. Reworking CI/Dependabot architecture beyond required alignment updates.\n+3. Shipping unrelated product features.\n+\n+## Assumptions (Wave 1.6 Blocker Burn-down)\n+1. Coverage thresholds remain fixed at `statements 80`, `branches 70`, `functions 80`, `lines 80`.\n+2. Refining coverage include/exclude to represent intended production code surface is acceptable if documented and justified.\n+3. Small non-behavioral exports or test seams may be added where necessary to enable deterministic tests.\n+\n+## Verification Plan (Wave 1.6 Blocker Burn-down)\n+1. Execute Wave A tasks (typecheck blockers), then run `pnpm run desktop:typecheck`.\n+2. Execute Wave B tasks (coverage scope + tests), then run `pnpm run test --coverage`.\n+3. Run full quality-gate sweep: `pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`.\n+\n+## Rollback Plan (Wave 1.6 Blocker Burn-down)\n+1. Revert Wave 1.6 typecheck-related commits if renderer typing changes introduce regressions.\n+2. Revert coverage scope/test commits if gate behavior diverges from intended policy.\n+3. Keep remediation commits scoped by task so individual rollback is possible without undoing unrelated quality-gate infrastructure.\n+\n+---\n+\n+\n+\n+\n+## Wave 1.6 Final Status (2026-02-16)\n+\n+- Decision: **GO**.\n+- Final verification task `1665fe08-0270-4fd0-b48a-f33372a3970b` is complete with all required gate commands passing (`pnpm install`, `pnpm run lint`, `pnpm run desktop:typecheck`, `pnpm run test --coverage`).\n+- Coverage thresholds remain enforced at `80/70/80/80` and pass (`80.91/74.25/84.67/80.91`).\n+- Coverage artifact hygiene check is clean (`NO_COVERAGE_ENTRIES`).\n+- Residual risk: non-blocking warning/deprecation noise only (`react-refresh/only-export-components`, `ReactDOMTestUtils.act`).\n+## Goal (Wave 1.5 Quality Gates)\n+Establish enforceable quality gates for linting, coverage, GitHub CI on pull requests/merges, and automated dependency update hygiene with Dependabot.\n+\n+## Tasks (Wave 1.5 Quality Gates)\n+- [x] [Add linting baseline and scripts](intent://local/task/104a4249-6976-4de2-9708-f5ab4283ef58)\n+\n+- [x] [Add coverage targets and enforcement](intent://local/task/b5b5509f-53b0-46b8-93aa-53e65fd88711)\n+\n+- [x] [Add GitHub CI workflow for pull requests and merges](intent://local/task/f8b34c69-c337-46c0-8ba6-61bf84260c82)\n+\n+- [x] [Configure Dependabot for npm and GitHub Actions](intent://local/task/58da8198-b6d5-4ef6-8f3c-715273e001f3)\n+\n+- [x] [Verify quality gates end-to-end and issue GO/NO-GO](intent://local/task/e7be8fb9-0d21-4a8b-9cfd-0ad2686a3f77)\n+\n+## Acceptance Criteria (Wave 1.5 Quality Gates)\n+1. Lint checks are standardized and runnable locally and in CI.\n+2. Coverage thresholds are explicit, enforced, and visible in CI outcomes.\n+3. GitHub CI runs on pull requests and merge-branch pushes with blocking quality gates.\n+4. Dependabot is configured for npm and GitHub Actions update automation.\n+5. Final verification provides an explicit GO/NO-GO with blocker severity.\n+\n+## Non-goals (Wave 1.5 Quality Gates)\n+1. Refactoring product features unrelated to quality-gate enablement.\n+2. Introducing deployment/release automation beyond CI validation.\n+3. Replacing package manager or test framework.\n+\n+## Assumptions (Wave 1.5 Quality Gates)\n+1. Coverage policy baseline is `80%` for statements/functions/lines and `70%` for branches.\n+2. CI runs on `pull_request` and `push` to `main`.\n+3. Dependabot cadence is weekly for both npm and GitHub Actions.\n+\n+## Verification Plan (Wave 1.5 Quality Gates)\n+1. Run all local quality-gate commands after implementation.\n+2. Validate CI workflow trigger paths for PR and merge events.\n+3. Confirm Dependabot config parses and targets both ecosystems.\n+\n+## Rollback Plan (Wave 1.5 Quality Gates)\n+1. Revert quality-gate config files and scripts in one scoped rollback commit if pipeline disruption occurs.\n+2. Temporarily relax threshold values (not disable entire checks) only with explicit follow-up task.\n+3. Keep CI workflow changes isolated so they can be reverted without affecting product code.\n+\n+\n+## Goal\n+Deliver a local-first Kata Cloud MVP desktop app where a user can create a Space, generate and edit a living Spec, run specialist agents on scoped tasks, review resulting code diffs, and create a GitHub pull request without leaving the app.\n+\n+\n+## Tasks (Wave 1 Remediation)\n+1. [Integrate task-block conversion into spec save/autosave](intent://local/task/2c119395-f7be-4595-8e2a-98cb9d976e62)\n+2. [Enforce one-block-one-task for duplicate titles and normalize parser module boundary](intent://local/task/e420a91b-5bab-4df8-8074-b518a04edc46)\n+3. [Re-run Wave 1 gate verification in network-enabled environment](intent://local/task/5c1f7d87-7581-42ed-bcce-83373e83f406)\n+\n+## Acceptance Criteria (Wave 1 Remediation)\n+1. Spec autosave/save converts `@@@task` blocks into stable task links end-to-end.\n+2. Duplicate `@@@task` titles produce distinct task records with no collapsing.\n+3. Wave 1 verification evidence is re-run in a network-enabled environment and includes an explicit GO/NO-GO decision.\n+\n+## Verification Plan (Wave 1 Remediation)\n+1. `pnpm run test -- notes`\n+2. `pnpm run test -- task-parser`\n+3. `pnpm install`\n+4. `pnpm run test -- space`\n+5. `pnpm run test -- git`\n+6. `pnpm run dev` plus manual restart persistence check.\n+\n+## Wave 1 Gate Status (2026-02-16)\n+- Decision: **NO-GO** for Wave 2.\n+- Wave 1.1 fixes are verified: `pnpm run test -- space`, `pnpm run test -- git`, `pnpm run test -- notes`, and `pnpm run test -- task-parser` all pass.\n+- Previous blockers are resolved: no `TS2783` in git service compile path, and no empty `.node.test.ts` suite failures in scoped Vitest runs.\n+- Runtime remediation task `fe99cd34-6c78-45e5-b3b2-a60cebae3faf` is finalized as `review_required` with evidence.\n+- `Electron failed to install correctly` is resolved as the active failure signature.\n+- Remaining blocker signature: `pnpm run dev` aborts Electron launch with `SIGABRT` before full app startup (sandboxed runs also showed local port `5173` contention).\n+- Install path verification passed (`pnpm install` succeeded), but restart persistence smoke remains unverified because app boot is still blocked.\n+- Wave 1.2 verifier rerun task `87853fc8-3e92-428e-95da-239cbb11d698` is complete with explicit **NO-GO**.\n+- Gate rerun evidence: `pnpm install` and scoped tests are green, but `pnpm run dev` still fails with Electron `SIGABRT`, so restart persistence smoke remains blocked.\n+- Additional risk: `pnpm run dev` may exit with code `0` despite logged Electron `SIGABRT`, which can mask startup failure in automation.\n+- Wave 1.4 Task 1 `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948` is complete with deterministic startup orchestration evidence.\n+- Wave 1.4 Task 2 `5287cd3d-7fba-460b-9011-d8a3b3a941d7` (gate verifier rerun) is complete with explicit **NO-GO**.\n+- Wave 1.3 Task 1 (`a0439035-0bda-47ac-a0dd-10c85ec82c04`) is complete; `.pnpm-store` tracked cache entries are cleared.\n+- Post-abort read-only recheck reconfirms Task 1 clean state: both target cache index paths are untracked and `.pnpm-store` status/diff filters are empty.\n+- Wave 1.3 Task 2 (`99ae8f09-0c3b-49d6-b57f-d4007df74c33`) is complete; branch hygiene and scope preservation evidence recorded.\n+- Wave 1.5 quality-gates implementation and verification are complete with explicit **NO-GO**.\n+- Wave 1.5 verifier finding: CI and Dependabot configuration is correct; remaining P0 blockers are baseline `pnpm run desktop:typecheck` and `pnpm run test --coverage` failures (code/test debt, not configuration defects).\n+- Coverage task exception approved: minimal additive `package.json` devDependency (`@vitest/coverage-v8`) is allowed to enable coverage execution.\n+\n+\n+\n+## Tasks (Wave 1.1 Fixes)\n+\n+- [x] [Fix git compile blocker in space git service](intent://local/task/bd898a9d-c7b0-497e-af4b-3860510eddfb)\n+\n+- [x] [Normalize node-only tests in Vitest runs](intent://local/task/b9a5054a-0bfd-4eca-a825-7ba06f88e504)\n+\n+- [x] [Re-run Wave 1 gate after fixes](intent://local/task/42932726-7b8d-47a5-9ccd-fcc4aba54dcd)\n+\n+## Tasks (Wave 1.2 Runtime Remediation)\n+\n+- [x] [Unblock Electron runtime install for dev startup](intent://local/task/fe99cd34-6c78-45e5-b3b2-a60cebae3faf)\n+\n+- [x] [Re-run Wave 1 gate after runtime remediation](intent://local/task/87853fc8-3e92-428e-95da-239cbb11d698)\n+\n+## Tasks (Wave 1.3 Git Hygiene)\n+\n+- [x] [Clean cache artifacts from tracking and harden ignore rules](intent://local/task/a0439035-0bda-47ac-a0dd-10c85ec82c04)\n+\n+- [x] [Reconcile branch hygiene and preserve runtime remediation scope](intent://local/task/99ae8f09-0c3b-49d6-b57f-d4007df74c33)\n+\n+## Tasks (Wave 1.4 Runtime Launch Stabilization)\n+\n+- [x] [Stabilize Electron dev startup orchestration](intent://local/task/d9a13fa0-1e1a-487b-81e7-e0e41fa9c948)\n+\n+- [x] [Re-run Wave 1 gate after startup stabilization](intent://local/task/5287cd3d-7fba-460b-9011-d8a3b3a941d7)\n+\n+## Acceptance Criteria (Wave 1.4 Runtime Launch Stabilization)\n+1. Local dev startup sequence no longer relies on stale fixed-port assumptions between Vite and Electron.\n+2. Runtime launch path is deterministic and documented with reproducible evidence.\n+3. Final Wave gate rerun provides explicit GO/NO-GO after startup-stabilization changes.\n+\n+## Verification Plan (Wave 1.4 Runtime Launch Stabilization)\n+1. Run startup stabilization verification from task `d9a13fa0-1e1a-487b-81e7-e0e41fa9c948`.\n+2. Run full gate verification from task `5287cd3d-7fba-460b-9011-d8a3b3a941d7`.\n+3. Confirm restart persistence smoke is executed or explicitly blocked with rationale.\n+## Tasks\n+- [x] [Bootstrap desktop shell and workspace state](intent://local/task/8d3f4ea7-dd9e-4d22-b07e-d488cfff543f)\n+\n+- [x] [Implement space creation and metadata management](intent://local/task/bcbfcb3d-2dff-4387-9556-35a1073a9857)\n+\n+- [x] [Add git branch and worktree lifecycle for spaces](intent://local/task/c1601911-e9e8-4633-9a6e-3e401de35935)\n+\n+- [x] [Build spec note panel with autosave and comment threads](intent://local/task/43a5ba09-1e2b-43db-b354-4d90a46f1cdf)\n+\n+- [x] [Implement task block parsing and task-note conversion](intent://local/task/91331c4e-10c7-42cd-97be-7c63b6edfc35)\n+\n+\n+- [x] [Ship orchestrator planning loop and specialist task delegation](intent://local/task/55f46e5e-e243-4efc-971b-fd5cd1504a85)\n+\n+- [ ] [Build changes tab with diff inspection and selective staging](intent://local/task/e1ea609a-a0d0-4025-92ea-f20564110a9d)\n+\n+- [ ] [Add GitHub PR creation workflow in Changes tab](intent://local/task/10a48d6c-9fd1-452f-aa99-3120bf23641c)\n+\n+- [/] [Add in-app browser preview for local development](intent://local/task/22770f24-a79b-4d14-9add-14ffd1447b2f)\n+\n+- [/] [Integrate context engine adapter and initial providers](intent://local/task/302fcffa-863d-4d90-b017-08369fad3f73)\n+\n+\n+- [ ] [Implement real model provider runtime and authentication](intent://local/task/dfb65dc8-1eb9-47f1-b95f-e22c99005ddb)\n+## Acceptance Criteria\n+1. A user can install and run the app, create a space, and reopen it later with full state restored.\n+2. Each space can be linked to an isolated git branch/worktree and display branch status in the UI.\n+3. The spec is editable with autosave, persistent comments, and task blocks converted to task records.\n+4. Running the orchestrator from a user prompt creates/updates spec content and delegates specialist tasks.\n+5. The user can review diffs, selectively stage files, generate suggested PR content, and create a GitHub PR directly from the app.\n+6. The app provides an in-app browser preview for localhost development targets.\n+7. Orchestrator and specialists retrieve context through a pluggable context adapter interface.\n+8. Anthropic and OpenAI run with real model integrations supporting both API-key and token-authenticated modes.\n+\n+## Non-goals\n+- Production authentication, billing, licensing, or multi-tenant cloud backend.\n+- Full marketplace for custom specialists.\n+- Full CI/CD orchestration or deployment management from within the app.\n+- Large-scale distributed indexing or enterprise ingestion pipelines.\n+\n+## Assumptions\n+- Initial release target is macOS desktop only for v1; Linux/Windows are deferred.\n+- V1 desktop shell will use Electron + TypeScript with a canonical React/Vite renderer surface, keeping clean boundaries for a possible future Tauri migration.\n+- First milestone remains local-first with no in-app account system; provider auth uses API keys and/or token-authenticated provider sessions.\n+- Existing Kata Agents and Kata Orchestrator codebases may be reused as references, not direct hard dependencies.\n+- Wave 1 accepts additive integration points introduced during parallel execution (including `src/main.tsx`/`src/styles.css` renderer composition and optional `SpaceRecord.gitStatus` coupling in shared state); boundary cleanup is deferred unless verifier findings require a targeted refactor.\n+\n+## Verification Plan\n+1. Run unit/integration test suites for spaces, git, notes/task parsing, orchestrator, provider integrations/auth, changes, browser, GitHub PR workflow, and context adapter.\n+2. Run full app build and smoke test end-to-end user journey: create space -> spec/tasks -> delegate -> inspect changes -> create PR.\n+3. Perform manual regression on app restart/resume to confirm persistence and resumable session behavior.\n+\n+## Rollback Plan\n+1. Keep each feature behind scoped feature flags where feasible (space-git, orchestrator, provider-auth, changes-tab, github-pr, browser, context-adapter).\n+2. If a feature introduces instability, disable the corresponding flag and ship the remaining stable MVP path.\n+3. For migration-sensitive data changes, include reversible schema migrations and backup/restore for local app data.\n+\n+## UAT Results (Wave 2.1)\n+\n+### Case 1: Happy-path run lifecycle\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16):\n+  - Run reached terminal success (`Run ... is completed`).\n+  - Lifecycle shows expected progression: `queued -> running -> completed`.\n+  - Delegated task timelines for implement/verify/debug all reached `completed` with full transition chains.\n+  - Draft generation state present: `Draft: ready for run ...`.\n+\n+### Case 2: Spec draft generation + apply\n+- Result: **PASS**\n+- Evidence (user screenshot, 2026-02-16 4:07 PM):\n+  - `Orchestrator Draft` card present for run `run-5e2f539d-44b2-476d-9fe7-a0d4577f3fe7`.\n+  - Apply action succeeded (`Applied draft from run ...`).\n+  - Spec Markdown/Preview panes show updated draft-derived content.\n+  - Orchestrator status panel includes `Draft applied at ...` timestamp.\n+\n+### Case 3: Delegation timeline visibility\n+- Result: **PASS**\n+- Evidence (same UAT screenshots):\n+  - Delegated task rows for `implement`, `verify`, and `debug` are visible.\n+  - Each row shows explicit transition chain with terminal `completed` state.\n+  - Run-level lifecycle and per-task timeline information are both rendered together.\n+\n+### Case 4: Failure-path behavior\n+- Result: **FAIL**\n+- Evidence (user screenshot, 2026-02-16 4:10 PM):\n+  - Prompt contains `fail` (`\"fail to a short implementation plan for improving note search\"`).\n+  - Run still reached terminal success (`completed`) with lifecycle `queued -> running -> completed`.\n+  - Delegated tasks all completed; no failure message surfaced.\n+- Interpretation: deterministic failure-path trigger did not activate as expected in UAT.\n+- Impact: Wave 2.1 UAT cannot be marked GO yet; requires remediation or clarified failure-trigger contract.\n+\n+### Case 5: Session persistence sanity\n+- Result: **PARTIAL / FAIL**\n+- PASS: latest orchestrator run state persists across app restart.\n+- FAIL: historical run timeline/history is not visible after restart; only the latest state is visible.\n+\n+### Additional UAT Observation\n+- Submitting new prompts with `Run Orchestrator` does not automatically change `Spec Markdown`; content remains from the last applied draft.\n+- Current Wave 2.1 behavior appears to require explicit `Apply Draft to Spec` for spec mutation. If automatic spec refresh per run is desired, that is a follow-up UX/behavior change request.\n+\n+### UAT Status (Wave 2.1)\n+- Current UAT decision: **NO-GO** pending remediation for:\n+  1. Case 4 failure-path trigger did not produce failed terminal state/error messaging.\n+  2. Case 5 run-history/timeline persistence gap (latest-only visibility).\n+\n+## Context Adapter Closure Check (2026-02-17)\n+\n+Task `302fcffa-863d-4d90-b017-08369fad3f73` is **NO-GO** for verifier wave. Closure audit found missing commit/push evidence and no remote head for `feature/context-adapter-foundation`; current branch state shows uncommitted context files. Recommended status remains `in_progress` until commit/push/remote-ref and test-output artifacts are attached in the task note.\n+\n+\n+## Context Artifact Unblocked (2026-02-17)\n+\n+1. Context adapter branch `feature/context-adapter-foundation` is now committed and pushed.\n+2. Commit: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8`.\n+3. Remote ref confirmed: `ac97a5cf0ccc0191e3d45453a319cbeb268664c8 refs/heads/feature/context-adapter-foundation`.\n+4. Verification rerun passed: `pnpm run test -- context` and `pnpm run desktop:typecheck`.\n+5. This clears the previous commit/push/remote-ref blocker for task `302fcffa-863d-4d90-b017-08369fad3f73`; next required step is verifier closeout.\n+## Browser Sequencing Decision (2026-02-17)\n+\n+1. Browser task `22770f24-a79b-4d14-9add-14ffd1447b2f` remains `waiting`.\n+2. Required prerequisite state before resume:\n+   - Run-history closure task `374e17d5-6ac8-42ff-b943-66026957a892` is terminally closed with explicit GO/NO-GO.\n+   - Context task `302fcffa-863d-4d90-b017-08369fad3f73` has commit/push/remote-ref/test-output artifacts and is no longer closure-blocked.\n+3. Single next action: execute the run-history/context closure gates first, then resume browser task only after both prerequisites are satisfied.\n+\n+## Run-history Closure Check (2026-02-17)\n+\n+1. Closure audit for run-history task `c5f554ea-2059-40d2-9fb2-bf522a590cae` is **NO-GO**.\n+2. Current evidence confirms remote branch head exists (`feature/run-history-persistence-fix` -> `4d388ce411b3dc2b6df4591e47e67e944e7715a6`) and task note includes automated test/typecheck claims.\n+3. Blocking gaps remain: missing explicit verifier closeout record, missing manual restart persistence proof, and no independent commit-content inspection captured in this closure pass.\n+4. Required next actions: verifier closeout + manual restart artifact + inspectable commit artifact, then re-run closure check."}
