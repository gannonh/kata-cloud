{"type":"snapshot","v":1,"date":"2026-02-17T03:49:12.722Z","author":{"id":"user","name":"User","type":"user"},"content":"# Fix CI pnpm version pin for PR merge\n\nUnblock PR checks by explicitly pinning pnpm version for GitHub Actions and repository metadata.\n\n## Scope\nIn scope: `package.json` and `.github/workflows/ci-quality-gates.yml` only.\nOut of scope: feature behavior changes and unrelated refactors.\n\n## Inputs\n- CI failure: `pnpm/action-setup@v4` reports no pnpm version specified.\n- [Spec](intent://local/note/spec)\n\n## Definition of Done\n- `package.json` declares `packageManager` with pinned pnpm version.\n- `.github/workflows/ci-quality-gates.yml` sets pnpm version in `pnpm/action-setup@v4` step.\n- Branch contains only this focused CI unblocking change set.\n\n## Verification\n- `pnpm --version`\n- `pnpm install --frozen-lockfile`\n- `pnpm run lint`\n- `pnpm run desktop:typecheck`\n\n## Implementation Update (2026-02-17)\n\n### Acceptance Criteria\n- ✅ `package.json` declares `packageManager` pinned to `pnpm@10.6.2`.\n- ✅ `.github/workflows/ci-quality-gates.yml` configures `pnpm/action-setup@v4` with `version: 10.6.2`.\n- ✅ Change set is limited to the two scoped files.\n\n### Changes\n- `package.json`: added top-level `\"packageManager\": \"pnpm@10.6.2\"`.\n- `.github/workflows/ci-quality-gates.yml`: added `with.version: 10.6.2` under `Setup pnpm` step.\n\n### Verification Run Results\n1. `pnpm --version` -> `10.6.2` (pass).\n2. `CI=1 pnpm install --frozen-lockfile` -> exit `0` (pass).\n3. `pnpm run lint` -> exit `0` with 1 existing warning in `src/main.tsx:150` (`react-refresh/only-export-components`), no errors.\n4. `pnpm run desktop:typecheck` -> exit `0` (pass).\n\n### Residual Issue\n- Existing lint warning remains in `src/main.tsx:150`; this task did not modify that file per scope.\n\n```ws-block:cli\n{\n  \"id\": \"2cead612-43be-4f44-9336-9ccd8af10e42\",\n  \"version\": 1,\n  \"type\": \"cli\",\n  \"createdAt\": \"2026-02-17T03:39:47.802Z\",\n  \"createdBy\": \"agent\",\n  \"command\": \"pnpm --version\",\n  \"description\": \"Verify pnpm version pin\",\n  \"cwd\": \"/Users/gannonhall/intent/workspaces/following-build-2/kata-cloud\",\n  \"display\": {\n    \"showCommandPrefix\": \"$\"\n  }\n}\n```\n\n```ws-block:cli\n{\n  \"id\": \"eb151daf-aa5c-423c-a058-e6a27cfe4abb\",\n  \"version\": 1,\n  \"type\": \"cli\",\n  \"createdAt\": \"2026-02-17T03:39:47.812Z\",\n  \"createdBy\": \"agent\",\n  \"command\": \"CI=1 pnpm install --frozen-lockfile\",\n  \"description\": \"Verify frozen lockfile install\",\n  \"cwd\": \"/Users/gannonhall/intent/workspaces/following-build-2/kata-cloud\",\n  \"display\": {\n    \"showCommandPrefix\": \"$\"\n  }\n}\n```\n\n```ws-block:cli\n{\n  \"id\": \"14ee3249-7405-40de-b0cf-7fed69a13409\",\n  \"version\": 1,\n  \"type\": \"cli\",\n  \"createdAt\": \"2026-02-17T03:39:47.820Z\",\n  \"createdBy\": \"agent\",\n  \"command\": \"pnpm run lint\",\n  \"description\": \"Verify lint gate\",\n  \"cwd\": \"/Users/gannonhall/intent/workspaces/following-build-2/kata-cloud\",\n  \"display\": {\n    \"showCommandPrefix\": \"$\"\n  }\n}\n```\n\n```ws-block:cli\n{\n  \"id\": \"8a88d3bd-71ea-4da0-9c98-17ad45ef5e9f\",\n  \"version\": 1,\n  \"type\": \"cli\",\n  \"createdAt\": \"2026-02-17T03:39:47.829Z\",\n  \"createdBy\": \"agent\",\n  \"command\": \"pnpm run desktop:typecheck\",\n  \"description\": \"Verify desktop typecheck gate\",\n  \"cwd\": \"/Users/gannonhall/intent/workspaces/following-build-2/kata-cloud\",\n  \"display\": {\n    \"showCommandPrefix\": \"$\"\n  }\n}\n```\n\n## Finalization (2026-02-17)\n\nImplemented and pushed on `feature/run-history-persistence`.\n\n- Commit: `9dcc557` — `fix: pin pnpm 10.6.2 for CI setup`\n- Files changed:\n  - `package.json` (`packageManager: pnpm@10.6.2`)\n  - `.github/workflows/ci-quality-gates.yml` (`pnpm/action-setup@v4` now uses `version: 10.6.2`)\n- Push status: successful to `origin/feature/run-history-persistence`\n- PR updated: https://github.com/gannonh/kata-cloud/pull/2\n- Current check state: `quality-gates` re-running (`pending`).","title":"Fix CI pnpm version pin for PR merge"}
