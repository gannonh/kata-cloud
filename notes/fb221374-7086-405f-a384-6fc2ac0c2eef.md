---
id: fb221374-7086-405f-a384-6fc2ac0c2eef
title: Fix CI pnpm version pin for PR merge
parent: spec
created: "2026-02-17T03:37:51.822Z"
task:
  status: complete
  peerOrder: 100
  startedAt: "2026-02-17T03:38:00.208Z"
  assignedAgentIds: [agent-a4968d48-467e-4f0b-80aa-ef20659e37f7]
  completedAt: "2026-02-17T03:44:12.599Z"
---

# Fix CI pnpm version pin for PR merge

Unblock PR checks by explicitly pinning pnpm version for GitHub Actions and repository metadata.

## Scope
In scope: `package.json` and `.github/workflows/ci-quality-gates.yml` only.
Out of scope: feature behavior changes and unrelated refactors.

## Inputs
- CI failure: `pnpm/action-setup@v4` reports no pnpm version specified.
- [Spec](intent://local/note/spec)

## Definition of Done
- `package.json` declares `packageManager` with pinned pnpm version.
- `.github/workflows/ci-quality-gates.yml` sets pnpm version in `pnpm/action-setup@v4` step.
- Branch contains only this focused CI unblocking change set.

## Verification
- `pnpm --version`
- `pnpm install --frozen-lockfile`
- `pnpm run lint`
- `pnpm run desktop:typecheck`

## Implementation Update (2026-02-17)

### Acceptance Criteria
- ✅ `package.json` declares `packageManager` pinned to `pnpm@10.6.2`.
- ✅ `.github/workflows/ci-quality-gates.yml` configures `pnpm/action-setup@v4` with `version: 10.6.2`.
- ✅ Change set is limited to the two scoped files.

### Changes
- `package.json`: added top-level `"packageManager": "pnpm@10.6.2"`.
- `.github/workflows/ci-quality-gates.yml`: added `with.version: 10.6.2` under `Setup pnpm` step.

### Verification Run Results
1. `pnpm --version` -> `10.6.2` (pass).
2. `CI=1 pnpm install --frozen-lockfile` -> exit `0` (pass).
3. `pnpm run lint` -> exit `0` with 1 existing warning in `src/main.tsx:150` (`react-refresh/only-export-components`), no errors.
4. `pnpm run desktop:typecheck` -> exit `0` (pass).

### Residual Issue
- Existing lint warning remains in `src/main.tsx:150`; this task did not modify that file per scope.

```ws-block:cli
{
  "id": "2cead612-43be-4f44-9336-9ccd8af10e42",
  "version": 1,
  "type": "cli",
  "createdAt": "2026-02-17T03:39:47.802Z",
  "createdBy": "agent",
  "command": "pnpm --version",
  "description": "Verify pnpm version pin",
  "cwd": "/Users/gannonhall/intent/workspaces/following-build-2/kata-cloud",
  "display": {
    "showCommandPrefix": "$"
  }
}
```

```ws-block:cli
{
  "id": "eb151daf-aa5c-423c-a058-e6a27cfe4abb",
  "version": 1,
  "type": "cli",
  "createdAt": "2026-02-17T03:39:47.812Z",
  "createdBy": "agent",
  "command": "CI=1 pnpm install --frozen-lockfile",
  "description": "Verify frozen lockfile install",
  "cwd": "/Users/gannonhall/intent/workspaces/following-build-2/kata-cloud",
  "display": {
    "showCommandPrefix": "$"
  }
}
```

```ws-block:cli
{
  "id": "14ee3249-7405-40de-b0cf-7fed69a13409",
  "version": 1,
  "type": "cli",
  "createdAt": "2026-02-17T03:39:47.820Z",
  "createdBy": "agent",
  "command": "pnpm run lint",
  "description": "Verify lint gate",
  "cwd": "/Users/gannonhall/intent/workspaces/following-build-2/kata-cloud",
  "display": {
    "showCommandPrefix": "$"
  }
}
```

```ws-block:cli
{
  "id": "8a88d3bd-71ea-4da0-9c98-17ad45ef5e9f",
  "version": 1,
  "type": "cli",
  "createdAt": "2026-02-17T03:39:47.829Z",
  "createdBy": "agent",
  "command": "pnpm run desktop:typecheck",
  "description": "Verify desktop typecheck gate",
  "cwd": "/Users/gannonhall/intent/workspaces/following-build-2/kata-cloud",
  "display": {
    "showCommandPrefix": "$"
  }
}
```

## Finalization (2026-02-17)

Implemented and pushed on `feature/run-history-persistence`.

- Commit: `9dcc557` — `fix: pin pnpm 10.6.2 for CI setup`
- Files changed:
  - `package.json` (`packageManager: pnpm@10.6.2`)
  - `.github/workflows/ci-quality-gates.yml` (`pnpm/action-setup@v4` now uses `version: 10.6.2`)
- Push status: successful to `origin/feature/run-history-persistence`
- PR updated: https://github.com/gannonh/kata-cloud/pull/2
- Current check state: `quality-gates` re-running (`pending`).